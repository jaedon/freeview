/*******************************************************************************
* File name : 
* Author : 
* description :
*
* Copyright (c) 2009 by Humax Co., Ltd.
* All right reserved
*******************************************************************************/

/*******************************************************************************
* header and definitions
*******************************************************************************/
/* global header files */

/* chip manufacture's  header files */

/* humax header files */
#include "fdi_common.h"
#include "fdi_hdmi.h"
#include "fvk.h"

#include "di_hdmi.h"
#if (HDMI_HDCP20_KEY_BOUND_ENABLE==YES)
#include "di_nvram.h"
#include "nvram_map.h"
#endif
/*******************************************************************************
* Debug level
*******************************************************************************/


/*******************************************************************************
* Definitions, typdef & const data
*******************************************************************************/


/*******************************************************************************
* Global variables and structures
*******************************************************************************/


/*******************************************************************************
* External variables and functions
*******************************************************************************/


/*******************************************************************************
* Static variables and structures
*******************************************************************************/
#if (HDMI_HDCP20_KEY_BOUND_ENABLE==YES)

#define SAGE_FW_FLAGE "/var/lib/humaxtv/sage"

#if defined(PRODUCT_HGS1000S)
static unsigned char s_ucaGoodHdcp22Key[1088] =
{	
	0xAA ,0xC5 ,0x04 ,0x61 ,0x2F ,0x4E ,0xBA ,0x9F ,0xBA ,0x79 ,0x5A ,0x44 ,0x66 ,0x0B ,0x5F ,0x43,
	0x35 ,0xBD ,0xB6 ,0x00 ,0x01 ,0xC4 ,0x53 ,0x3C ,0xA7 ,0x94 ,0x3A ,0x10 ,0x90 ,0x8D ,0x91 ,0x02,
	0x93 ,0x7A ,0x01 ,0x7A ,0x57 ,0x01 ,0x35 ,0x45 ,0xF7 ,0xFA ,0x39 ,0x56 ,0xD7 ,0x46 ,0x45 ,0x45,
	0xB3 ,0x21 ,0x87 ,0xA5 ,0xBE ,0xEA ,0xCD ,0xD3 ,0x08 ,0x5B ,0x17 ,0xF3 ,0xB2 ,0xB3 ,0x8E ,0xAB,
	0xCB ,0xBC ,0x2D ,0x73 ,0x50 ,0x16 ,0x76 ,0xF4 ,0x53 ,0xB9 ,0x9F ,0xCD ,0xB6 ,0xF3 ,0xB6 ,0xC0,
	0x00 ,0x00 ,0x04 ,0x40 ,0x29 ,0xE6 ,0xA4 ,0x5C ,0x97 ,0xDB ,0x4A ,0xD3 ,0x32 ,0x47 ,0xED ,0x69,
	0x02 ,0xB2 ,0x01 ,0x07 ,0x00 ,0x00 ,0x01 ,0x00 ,0x80 ,0x9D ,0xF9 ,0x48 ,0x06 ,0xCB ,0x34 ,0x98,
	0xDE ,0x4B ,0x07 ,0x83 ,0xAE ,0xA8 ,0xB6 ,0x46 ,0xD5 ,0xF5 ,0xB8 ,0xD6 ,0xB8 ,0xB9 ,0x22 ,0x1F,
	0x88 ,0xED ,0x3D ,0x1E ,0x30 ,0x44 ,0x8E ,0x92 ,0x03 ,0x12 ,0xFD ,0x07 ,0xCF ,0xB2 ,0xD0 ,0x43,
	0x04 ,0x27 ,0xED ,0x63 ,0xF4 ,0x5A ,0x8B ,0x2B ,0xCD ,0x9F ,0x50 ,0x6F ,0x5C ,0xE2 ,0xBD ,0xFB,
	0x50 ,0x7E ,0x7C ,0xE0 ,0xF6 ,0x7B ,0xC9 ,0x16 ,0x26 ,0x94 ,0x6F ,0xC7 ,0xCC ,0xBE ,0x61 ,0x45,
	0xD6 ,0xB6 ,0x40 ,0x08 ,0x35 ,0x0C ,0xBC ,0xF4 ,0xB0 ,0x43 ,0xE0 ,0xCF ,0x37 ,0x00 ,0xF5 ,0x29,
	0x00 ,0x00 ,0x00 ,0x01 ,0x8C ,0x34 ,0x72 ,0x57 ,0x15 ,0xAC ,0xD1 ,0xC0 ,0xAC ,0x84 ,0x16 ,0xB5,
	0x00 ,0x01 ,0x00 ,0x09 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00,
	0x00 ,0x01 ,0x00 ,0x09 ,0x08 ,0xDB ,0x19 ,0x54 ,0x65 ,0x0C ,0xFB ,0x37 ,0x55 ,0x92 ,0x93 ,0x37,
	0x12 ,0x55 ,0x01 ,0x34 ,0x9A ,0xE3 ,0x17 ,0xD7 ,0xD7 ,0x9B ,0x87 ,0x09 ,0x7B ,0x4C ,0xF8 ,0x59,
	0x85 ,0x17 ,0xA8 ,0xAD ,0x76 ,0x2D ,0xDD ,0xE6 ,0xBB ,0xA3 ,0x17 ,0x5E ,0x7F ,0x95 ,0xE0 ,0xAD,
	0x00 ,0x00 ,0x00 ,0x04 ,0x93 ,0xC2 ,0x9B ,0x65 ,0x84 ,0x42 ,0x6D ,0xD5 ,0x91 ,0x1D ,0xA1 ,0x2B,
	0x00 ,0x00 ,0x00 ,0xC0 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00,
	0x78 ,0x60 ,0x57 ,0x2C ,0xBC ,0xAF ,0x7D ,0xF2 ,0x95 ,0xB4 ,0x3E ,0x38 ,0xDB ,0x3D ,0xE3 ,0xD7,
	0x72 ,0xCB ,0xE5 ,0xE3 ,0x93 ,0xC9 ,0xF2 ,0x50 ,0xD1 ,0xEF ,0x41 ,0x31 ,0x3C ,0xA9 ,0xB8 ,0x99,
	0x51 ,0x5E ,0x24 ,0x08 ,0xE7 ,0xBC ,0x34 ,0xE9 ,0xC9 ,0x5B ,0x05 ,0x28 ,0x65 ,0x68 ,0x74 ,0x74,
	0xE3 ,0xAB ,0xC8 ,0xAD ,0x2F ,0x60 ,0x97 ,0x82 ,0xFF ,0x4E ,0x21 ,0x9A ,0x8D ,0x0D ,0xB6 ,0x98,
	0x78 ,0x47 ,0xB5 ,0xCF ,0x07 ,0xB5 ,0xA2 ,0xD2 ,0x58 ,0x82 ,0x96 ,0xB2 ,0x45 ,0x87 ,0x2A ,0x1A,
	0x75 ,0xA3 ,0x5E ,0xEB ,0x98 ,0xA2 ,0x3E ,0x23 ,0x5A ,0xBB ,0xA7 ,0xF1 ,0x35 ,0x0A ,0x87 ,0xD2,
	0x64 ,0x36 ,0x96 ,0x4C ,0x89 ,0x1D ,0xAF ,0x5B ,0xEE ,0x81 ,0xB0 ,0x6E ,0x81 ,0xB7 ,0xE0 ,0x2E,
	0x2D ,0x53 ,0x51 ,0xA3 ,0x31 ,0x47 ,0x7C ,0x52 ,0x94 ,0x1E ,0x16 ,0xAA ,0x65 ,0x33 ,0xFB ,0x98,
	0xE3 ,0x7C ,0x77 ,0x49 ,0x4A ,0x65 ,0x9D ,0x58 ,0x8D ,0xAE ,0x24 ,0x2E ,0x76 ,0xD9 ,0x39 ,0xE5,
	0x94 ,0x39 ,0xF9 ,0xED ,0x3F ,0x14 ,0x90 ,0xC5 ,0x85 ,0xEC ,0x1A ,0xA0 ,0xAE ,0x00 ,0x6F ,0x70,
	0xC4 ,0xCB ,0x7F ,0x87 ,0x6D ,0xA3 ,0xA6 ,0x87 ,0x24 ,0x6A ,0x6C ,0xAD ,0x1D ,0x73 ,0x6E ,0x6A,
	0xBC ,0x1A ,0x58 ,0xEE ,0x5C ,0x62 ,0x05 ,0x29 ,0x7F ,0x30 ,0xBA ,0x31 ,0xF2 ,0xF3 ,0xC5 ,0x24,
	0x83 ,0x0C ,0x5B ,0xDD ,0x71 ,0x03 ,0xF2 ,0x87 ,0x27 ,0x9F ,0x10 ,0xED ,0xDA ,0xC9 ,0x98 ,0x09,
	0x00 ,0x00 ,0x00 ,0x20 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00,
	0x91 ,0xB2 ,0xFC ,0xC7 ,0x59 ,0x25 ,0x67 ,0x2A ,0x6E ,0x29 ,0xF1 ,0x43 ,0x6B ,0x2B ,0x73 ,0x60,
	0x5C ,0xB9 ,0xE1 ,0x20 ,0xC2 ,0xAB ,0xC3 ,0x3F ,0x18 ,0x66 ,0x31 ,0xE4 ,0x00 ,0xE2 ,0x03 ,0x88,
	0x6F ,0x0E ,0xF3 ,0x50 ,0xC8 ,0x5C ,0x6A ,0x23 ,0xA6 ,0x31 ,0x42 ,0xE1 ,0x91 ,0x70 ,0xE7 ,0x98,
	0x00 ,0x00 ,0x01 ,0x80 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00,
	0x12 ,0x37 ,0x2D ,0xFF ,0x43 ,0xC7 ,0x85 ,0x09 ,0x17 ,0x7D ,0xE1 ,0xA7 ,0x11 ,0x85 ,0x22 ,0xE3,
	0x42 ,0x51 ,0x4B ,0xBF ,0xB9 ,0x22 ,0x73 ,0x8D ,0xA4 ,0xC9 ,0x2E ,0x6D ,0xEE ,0x24 ,0x15 ,0xD2,
	0x54 ,0x7D ,0x58 ,0xA7 ,0x46 ,0xE3 ,0x06 ,0x32 ,0x7D ,0x7C ,0x37 ,0x5D ,0x6A ,0xAA ,0x68 ,0x9E,
	0x15 ,0xD5 ,0x6D ,0x2A ,0x63 ,0xB9 ,0x1B ,0x43 ,0xAD ,0xC9 ,0xD6 ,0x82 ,0x54 ,0xB1 ,0xAD ,0x7D,
	0x31 ,0x80 ,0x93 ,0xD0 ,0x8F ,0x45 ,0x41 ,0x4B ,0x04 ,0x28 ,0xE2 ,0xF8 ,0xB7 ,0xF4 ,0xDE ,0x68,
	0x63 ,0x9A ,0x51 ,0xDC ,0x7D ,0xCE ,0x0A ,0xB9 ,0x1C ,0x34 ,0xAB ,0xEE ,0x30 ,0x6F ,0x7B ,0xB0,
	0x0D ,0xDB ,0xB5 ,0x28 ,0xCB ,0xD0 ,0x8C ,0x67 ,0xD5 ,0x90 ,0x84 ,0xCE ,0x4B ,0x8E ,0xB6 ,0xBC,
	0x58 ,0x12 ,0xE1 ,0x0B ,0xBB ,0x8E ,0xB2 ,0x58 ,0xAF ,0xDD ,0x39 ,0x06 ,0x15 ,0x83 ,0x36 ,0xCF,
	0x81 ,0xE2 ,0x19 ,0x1C ,0x9C ,0xBB ,0xB8 ,0xE1 ,0x89 ,0xC1 ,0x40 ,0x09 ,0xA9 ,0x29 ,0x39 ,0x50,
	0x93 ,0xBF ,0x7E ,0x96 ,0x60 ,0xF2 ,0x72 ,0x28 ,0x4F ,0x19 ,0x7B ,0x09 ,0xC8 ,0x3B ,0xBF ,0x71,
	0x97 ,0x50 ,0x5E ,0xED ,0x7C ,0x1E ,0x64 ,0xBA ,0x4F ,0xC6 ,0xB2 ,0xB8 ,0x2E ,0x2C ,0x7C ,0x3F,
	0x67 ,0xAE ,0xA7 ,0xE3 ,0xC5 ,0x24 ,0x7D ,0x9B ,0x01 ,0x29 ,0x61 ,0xE1 ,0x9C ,0x6A ,0xCF ,0xAE,
	0xC5 ,0xD3 ,0xC8 ,0x3C ,0x56 ,0x0E ,0xB4 ,0xE7 ,0x6F ,0x9E ,0x56 ,0x84 ,0xFA ,0x49 ,0x8A ,0x27,
	0x5D ,0x1F ,0x13 ,0x2B ,0xAD ,0x81 ,0x04 ,0x2D ,0xD6 ,0x7E ,0x7D ,0x33 ,0x37 ,0xD3 ,0x09 ,0x80,
	0xE8 ,0x1A ,0x8B ,0x83 ,0x65 ,0x89 ,0xA9 ,0x8F ,0x44 ,0x75 ,0xE3 ,0xB0 ,0x95 ,0x2B ,0xA5 ,0x9F,
	0xE1 ,0x0E ,0xCC ,0xBD ,0xED ,0x4C ,0x30 ,0xBB ,0xAF ,0x52 ,0xB3 ,0x77 ,0x9B ,0xD1 ,0x1A ,0xE1,
	0xB3 ,0xE8 ,0x5F ,0x3F ,0x2E ,0xB8 ,0x6C ,0x20 ,0x3A ,0x5B ,0xB3 ,0x98 ,0xEB ,0x13 ,0x82 ,0x1F,
	0x73 ,0xAB ,0xB2 ,0x67 ,0xF7 ,0x0D ,0x7F ,0xFD ,0x21 ,0x58 ,0x3C ,0xE2 ,0x99 ,0x4C ,0x05 ,0x2C,
	0xA8 ,0x24 ,0x08 ,0x62 ,0x67 ,0xF9 ,0xC0 ,0xA7 ,0x97 ,0x86 ,0xE4 ,0xAE ,0x51 ,0xD7 ,0x29 ,0xCF,
	0x9C ,0x86 ,0x13 ,0x9D ,0x8C ,0x0E ,0x1A ,0xF5 ,0x77 ,0xF7 ,0xA9 ,0xFD ,0x13 ,0xF9 ,0x14 ,0xCE,
	0x4A ,0xF9 ,0x57 ,0x8B ,0x55 ,0x68 ,0xDA ,0x69 ,0x5D ,0xA6 ,0x8C ,0xDC ,0x7D ,0x5C ,0x3F ,0x23,
	0x5F ,0x5C ,0xD8 ,0x7B ,0x75 ,0x50 ,0xCA ,0x73 ,0x68 ,0x84 ,0xB2 ,0xCC ,0xBD ,0x9D ,0xBC ,0xBD,
	0x4D ,0x53 ,0x77 ,0xCB ,0xDF ,0x43 ,0xBD ,0x62 ,0x47 ,0x8E ,0x2D ,0x9C ,0x71 ,0x91 ,0x20 ,0x3D,
	0x39 ,0xCA ,0x42 ,0x72 ,0xA5 ,0xDD ,0xB6 ,0x62 ,0x7D ,0xE7 ,0xDB ,0x78 ,0x5B ,0xD2 ,0x95 ,0xC7,
	0xE0 ,0xE9 ,0xCC ,0x0E ,0xFA ,0x00 ,0xDC ,0x62 ,0x3C ,0x78 ,0x28 ,0xA7 ,0x84 ,0x5A ,0x18 ,0x01,
	0x00 ,0x00 ,0x00 ,0x01 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00,
	0xFB ,0xD9 ,0xCD ,0xEE ,0x05 ,0xC1 ,0x7E ,0x8A ,0xC5 ,0x3F ,0xBE ,0xD7 ,0xA3 ,0xD4 ,0x04 ,0x6C,
	0x00 ,0x00 ,0x00 ,0x20 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00,
	0xB1 ,0x32 ,0x77 ,0xF0 ,0xB7 ,0xCB ,0xC3 ,0xE0 ,0x26 ,0xE5 ,0x3D ,0xE6 ,0x18 ,0xFF ,0xB2 ,0x95,
	0xD1 ,0xAF ,0x6F ,0x36 ,0x6C ,0x5A ,0x7A ,0x57 ,0xB3 ,0xAA ,0x9B ,0xB8 ,0x91 ,0x7B ,0xB0 ,0x43,
	0xAA ,0xFE ,0x55 ,0x57 ,0xC3 ,0x9A ,0x2B ,0x42 ,0xAC ,0xE1 ,0x8E ,0x0E ,0x28 ,0x25 ,0x89 ,0x6A 
};
#elif defined(PRODUCT_UHD2500)
static unsigned char s_ucaGoodHdcp22Key[1088] =
{
	0xAA ,0xC5 ,0x04 ,0x32 ,0xA0 ,0x92 ,0x09 ,0xA0 ,0x0D ,0xD5 ,0xBA ,0x02 ,0xF8 ,0xAD ,0x4C ,0x1A,
	0x35 ,0xBD ,0xB6 ,0x00 ,0x01 ,0x59 ,0xE9 ,0x30 ,0xA3 ,0xF9 ,0x93 ,0x00 ,0xA6 ,0xD5 ,0xC1 ,0xF2, 
	0x53 ,0x2C ,0xFF ,0xD2 ,0x1E ,0xA7 ,0xAD ,0x69 ,0x18 ,0x4C ,0xAF ,0xE5 ,0xD4 ,0x9B ,0xF1 ,0xE8, 
	0xFE ,0xAD ,0x10 ,0x54 ,0x4F ,0x82 ,0x34 ,0x0F ,0xF4 ,0x58 ,0xB9 ,0x50 ,0x82 ,0x31 ,0x36 ,0xE8, 
	0x1E ,0x16 ,0xF1 ,0x94 ,0x75 ,0x96 ,0x86 ,0xE7 ,0xB8 ,0xF4 ,0xCE ,0x5C ,0xDD ,0x36 ,0xCE ,0x1B, 
	0x00 ,0x00 ,0x04 ,0x40 ,0xD8 ,0x05 ,0xBD ,0xF1 ,0x2C ,0x71 ,0x32 ,0x42 ,0x76 ,0x25 ,0x66 ,0x98, 
	0x02 ,0xB2 ,0x01 ,0x3E ,0x00 ,0x00 ,0x01 ,0x00 ,0xD6 ,0x29 ,0xB8 ,0x4A ,0xB2 ,0x5E ,0xCE ,0x54, 
	0x67 ,0xAD ,0x62 ,0x0D ,0xE1 ,0x9D ,0x41 ,0x51 ,0x42 ,0x9A ,0x69 ,0x0B ,0x22 ,0xAB ,0x1A ,0x77, 
	0x88 ,0x19 ,0xBA ,0x9B ,0xC6 ,0x97 ,0x6A ,0xB2 ,0xF2 ,0x44 ,0x01 ,0x09 ,0xD9 ,0x8C ,0x45 ,0xB7, 
	0xE8 ,0xF6 ,0x3F ,0xF0 ,0xCC ,0x70 ,0x24 ,0x7B ,0x8C ,0x43 ,0xC8 ,0x78 ,0x1C ,0x71 ,0x45 ,0xD2, 
	0x5C ,0x5A ,0x8A ,0xC0 ,0xB2 ,0x5B ,0x2A ,0x24 ,0x5A ,0x3A ,0x09 ,0xFD ,0x70 ,0x4F ,0xF9 ,0x55, 
	0xA6 ,0x72 ,0xB9 ,0xD4 ,0xD8 ,0xC9 ,0x12 ,0x70 ,0xDC ,0x86 ,0x4F ,0xB9 ,0x5E ,0x9A ,0x8D ,0xD1, 
	0x00 ,0x00 ,0x00 ,0x01 ,0xDA ,0xE2 ,0xE9 ,0x3D ,0x92 ,0xC3 ,0xE7 ,0x92 ,0x9C ,0xB3 ,0xEF ,0xDF, 
	0x00 ,0x01 ,0x00 ,0x09 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00, 
	0x00 ,0x01 ,0x00 ,0x09 ,0xCF ,0x93 ,0xAD ,0xDC ,0xE6 ,0xBF ,0xA5 ,0xB7 ,0x15 ,0x45 ,0xE2 ,0xFC, 
	0x54 ,0xC9 ,0xE5 ,0xEA ,0x2C ,0x59 ,0x74 ,0xCA ,0x99 ,0x5E ,0x6D ,0xA3 ,0xF5 ,0x00 ,0x6D ,0x08,
	0xD6 ,0x6F ,0x6B ,0x86 ,0x1E ,0x3B ,0xB2 ,0x5E ,0x64 ,0x05 ,0xB3 ,0x5A ,0x63 ,0xD1 ,0x3D ,0xE0, 
	0x00 ,0x00 ,0x00 ,0x04 ,0xE0 ,0x27 ,0x02 ,0x83 ,0xFD ,0x09 ,0xA1 ,0x11 ,0x40 ,0x0F ,0xA7 ,0x61, 
	0x00 ,0x00 ,0x00 ,0xC0 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00, 
	0xE9 ,0xE8 ,0x58 ,0x60 ,0x9F ,0x2A ,0xDA ,0x98 ,0x1F ,0x00 ,0x4E ,0xDB ,0x67 ,0xDC ,0x52 ,0x5D, 
	0x0E ,0x81 ,0x4B ,0x44 ,0x3E ,0x10 ,0x24 ,0x65 ,0xD2 ,0x97 ,0xDC ,0x94 ,0xCD ,0x0F ,0x03 ,0xDF, 
	0x9E ,0xC0 ,0x91 ,0x44 ,0xE2 ,0x88 ,0x14 ,0xA4 ,0x5A ,0x6E ,0xCA ,0xD1 ,0x1E ,0xD8 ,0x66 ,0x79, 
	0x3A ,0xA3 ,0xA7 ,0x65 ,0xCB ,0x44 ,0xA5 ,0xA2 ,0x61 ,0x00 ,0xBE ,0x08 ,0xC4 ,0x98 ,0xD6 ,0xB7, 
	0xB8 ,0x68 ,0x71 ,0x9A ,0xF4 ,0x7A ,0xCD ,0x98 ,0xBA ,0x07 ,0xFE ,0xC1 ,0x0A ,0x64 ,0x6C ,0xD2, 
	0xC4 ,0xF4 ,0x17 ,0xBF ,0xB6 ,0x6C ,0x2A ,0x76 ,0x16 ,0x02 ,0x4C ,0x22 ,0x6D ,0xC7 ,0x49 ,0xA8, 
	0x8A ,0x0D ,0x3F ,0xEB ,0x76 ,0x6B ,0x96 ,0xB9 ,0xBD ,0x6D ,0x85 ,0xC7 ,0x5B ,0x82 ,0x27 ,0x62, 
	0xE6 ,0x8A ,0x84 ,0xE5 ,0x69 ,0x7E ,0x3D ,0x8B ,0xE9 ,0x76 ,0x91 ,0x4E ,0xA2 ,0x57 ,0x6F ,0x3A, 
	0xC5 ,0x98 ,0x69 ,0x4F ,0x4A ,0x80 ,0xD7 ,0x38 ,0x24 ,0xB4 ,0xA5 ,0x59 ,0x83 ,0xC9 ,0xF5 ,0x7F, 
	0x56 ,0xC0 ,0xA9 ,0x38 ,0x24 ,0xB0 ,0x49 ,0xF9 ,0x67 ,0xB0 ,0xBB ,0x85 ,0x30 ,0x23 ,0xCD ,0x12, 
	0x82 ,0x9D ,0xF3 ,0x1B ,0x82 ,0xA3 ,0xAA ,0x85 ,0x5E ,0x02 ,0x36 ,0xAF ,0x00 ,0x3D ,0xB0 ,0x91, 
	0x40 ,0xBF ,0x2E ,0xC4 ,0x58 ,0x29 ,0xC8 ,0xEA ,0xCE ,0xE9 ,0x49 ,0x0C ,0xAA ,0x3F ,0x6F ,0x8E, 
	0x2A ,0x4B ,0xEE ,0x95 ,0x12 ,0x43 ,0x75 ,0x37 ,0x1D ,0x4C ,0xB6 ,0x0C ,0x71 ,0xBF ,0x8E ,0x70, 
	0x00 ,0x00 ,0x00 ,0x20 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00, 
	0xCE ,0xDE ,0x28 ,0xA6 ,0x9E ,0xAF ,0x60 ,0x23 ,0x90 ,0x9F ,0x5E ,0x56 ,0x46 ,0x45 ,0x8D ,0xE2, 
	0x9D ,0x07 ,0xEF ,0x6D ,0x17 ,0x67 ,0x3E ,0xEB ,0xE2 ,0x45 ,0xBC ,0x49 ,0x64 ,0x3C ,0x50 ,0xBF, 
	0x86 ,0xD7 ,0x5F ,0x63 ,0x6A ,0x01 ,0x65 ,0x60 ,0x98 ,0x14 ,0x2E ,0x97 ,0xD8 ,0xD8 ,0xDA ,0x5A, 
	0x00 ,0x00 ,0x01 ,0x80 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00, 
	0xE0 ,0x6F ,0x45 ,0xE6 ,0x77 ,0x91 ,0x4F ,0xEB ,0x2F ,0xDC ,0xC0 ,0x0C ,0x6E ,0xBB ,0xD5 ,0x1A, 
	0xB7 ,0x07 ,0xFC ,0x08 ,0xC8 ,0xFC ,0xBD ,0x11 ,0xBB ,0x01 ,0x75 ,0x29 ,0xDD ,0xC9 ,0x84 ,0x78, 
	0x85 ,0x7E ,0x21 ,0x84 ,0xBE ,0x5E ,0xB1 ,0xB3 ,0x30 ,0x9A ,0xB3 ,0x0A ,0xF8 ,0x11 ,0x0F ,0x2E, 
	0x16 ,0xA7 ,0x19 ,0x2B ,0x3F ,0xC8 ,0x09 ,0x94 ,0xEF ,0x21 ,0xA9 ,0xF7 ,0x37 ,0x85 ,0x40 ,0x1C, 
	0x07 ,0x4E ,0x28 ,0x38 ,0x57 ,0x33 ,0xCE ,0xA8 ,0xE4 ,0xB7 ,0x5D ,0x51 ,0x74 ,0xF7 ,0xD0 ,0x21, 
	0xBD ,0x69 ,0xB1 ,0xD8 ,0x10 ,0xBE ,0x8F ,0x3E ,0x89 ,0x54 ,0xFA ,0xA5 ,0x07 ,0x64 ,0x23 ,0x7C, 
	0x8B ,0x5F ,0x00 ,0x17 ,0x68 ,0x7B ,0x80 ,0x97 ,0xBA ,0x5B ,0x86 ,0xFE ,0x72 ,0x50 ,0x25 ,0x4B, 
	0x3D ,0x97 ,0xD2 ,0x89 ,0x87 ,0xC0 ,0xC7 ,0xDC ,0x35 ,0xA5 ,0xA7 ,0x46 ,0x5F ,0x4D ,0x27 ,0xC1, 
	0x2B ,0x85 ,0x4E ,0x3A ,0xE1 ,0xEC ,0xEC ,0xC5 ,0x16 ,0x79 ,0x4F ,0x61 ,0xDD ,0x20 ,0x68 ,0x5A, 
	0x82 ,0xAE ,0x43 ,0x7E ,0x1F ,0x01 ,0x7A ,0xE5 ,0x73 ,0x7D ,0xA1 ,0x6E ,0xEE ,0xDF ,0x4C ,0x05, 
	0x5A ,0x09 ,0x0B ,0x6E ,0x67 ,0xDE ,0x03 ,0x5E ,0x8E ,0x33 ,0x97 ,0x09 ,0xE8 ,0x77 ,0x58 ,0x84, 
	0xBE ,0x84 ,0x13 ,0xC5 ,0x56 ,0xDA ,0x19 ,0xF8 ,0xC8 ,0xDD ,0xD2 ,0x2D ,0xDF ,0xF3 ,0xE5 ,0x1F, 
	0x97 ,0x7C ,0x0D ,0x66 ,0x67 ,0x63 ,0x55 ,0xE8 ,0xFE ,0x20 ,0x6D ,0x36 ,0x5E ,0xCD ,0x9F ,0x23, 
	0xDA ,0xD3 ,0xA5 ,0x77 ,0xC9 ,0xC3 ,0xB1 ,0x73 ,0xFF ,0x5C ,0x52 ,0x30 ,0xD2 ,0x2E ,0x36 ,0x6A, 
	0x33 ,0xE5 ,0xDB ,0xF0 ,0xEA ,0xFB ,0x99 ,0xD8 ,0x25 ,0xC0 ,0x6A ,0x75 ,0xE1 ,0x2D ,0xCD ,0xE7, 
	0xB9 ,0x3C ,0xCF ,0xE9 ,0x81 ,0x0D ,0x44 ,0xC9 ,0x00 ,0xF1 ,0x2D ,0x69 ,0xAF ,0x8A ,0x41 ,0xE6, 
	0x53 ,0xB8 ,0xFB ,0x05 ,0xF7 ,0x82 ,0x64 ,0x65 ,0x6E ,0x80 ,0xB3 ,0xCB ,0x90 ,0xBF ,0x9F ,0xDD, 
	0xD3 ,0xD9 ,0xA8 ,0xD0 ,0x31 ,0x98 ,0x82 ,0x03 ,0x6A ,0x5B ,0x7A ,0x85 ,0x7B ,0x50 ,0x0D ,0xCA, 
	0x1C ,0xCC ,0x19 ,0x4C ,0x67 ,0xCF ,0x09 ,0xF9 ,0xCF ,0x57 ,0xE5 ,0x99 ,0xC9 ,0x27 ,0x02 ,0x2A, 
	0x18 ,0x66 ,0x0C ,0xC4 ,0x59 ,0x77 ,0xB5 ,0x83 ,0xED ,0xFE ,0xF0 ,0x95 ,0x67 ,0x50 ,0x8D ,0xA3, 
	0x58 ,0xB2 ,0x27 ,0xC8 ,0x25 ,0x37 ,0x35 ,0x6B ,0x13 ,0x18 ,0x48 ,0x5F ,0xEC ,0x50 ,0xC9 ,0x6A, 
	0x7E ,0xDE ,0x0F ,0xA0 ,0x84 ,0xF5 ,0x14 ,0xDA ,0x5E ,0x05 ,0x97 ,0x42 ,0x27 ,0xDF ,0x4B ,0x75, 
	0x03 ,0x97 ,0x85 ,0x18 ,0xCD ,0x64 ,0xE6 ,0x02 ,0xA4 ,0xC4 ,0x52 ,0x29 ,0xEC ,0x75 ,0x11 ,0xCF, 
	0x92 ,0xC3 ,0xA6 ,0x3D ,0x59 ,0x20 ,0xE0 ,0x3E ,0x3C ,0x90 ,0x3C ,0x3A ,0x45 ,0x39 ,0xEE ,0x6A, 
	0xD9 ,0xB4 ,0x78 ,0x83 ,0xC4 ,0xAD ,0x4C ,0x05 ,0x73 ,0xA5 ,0xD5 ,0xE1 ,0xAE ,0xE0 ,0xCE ,0x60, 
	0x00 ,0x00 ,0x00 ,0x01 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00, 
	0xFB ,0x76 ,0x6A ,0x6E ,0x89 ,0x59 ,0xE1 ,0x4C ,0x4C ,0xF0 ,0x4B ,0x51 ,0x6A ,0xB3 ,0xDC ,0xAA, 
	0x00 ,0x00 ,0x00 ,0x20 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00, 
	0x01 ,0x92 ,0x40 ,0xB3 ,0x0C ,0x14 ,0x8D ,0x42 ,0x8F ,0xEF ,0x20 ,0xD8 ,0x07 ,0xC6 ,0xBF ,0x5A, 
	0x22 ,0xE6 ,0x06 ,0xCB ,0xA8 ,0x71 ,0x8B ,0x33 ,0x6A ,0x51 ,0x11 ,0xFD ,0x8B ,0x19 ,0xAA ,0x39, 
	0x08 ,0xA5 ,0xD6 ,0xB5 ,0x91 ,0x68 ,0xE2 ,0x54 ,0x85 ,0xCB ,0x97 ,0x4D ,0x42 ,0xF3 ,0xF1 ,0xB4
};
#endif /*PRODUCT_UHD2500*/
#endif /*HDMI_HDCP20_KEY_BOUND_ENABLE*/
/*******************************************************************************
* Static function prototypes
*******************************************************************************/

/*******************************************************************************
* function : FDI_HDMI_Open
* description :
* input :
* output :
* return : 
* 기타 참고자료 및 파일
*******************************************************************************/
FDI_ERR_CODE FDI_HDMI_Open(void)
{
#if (HDMI_HDCP20_KEY_BOUND_ENABLE==YES)
	int rc = 0;
	HUINT8 *Output = NULL;
	FILE *fd = NULL;
	
	fd = fopen(SAGE_FW_FLAGE, "r");
	if(fd == NULL)
	{

		Output = FVK_MEM_Alloc(sizeof(s_ucaGoodHdcp22Key));
		if(Output == NULL)
		{
			FDI_PRINT(FDI_PRT_ERROR, ("[FDI_HDMI_Open] : DD_MEM_Alloc Error\n"));
		}

		rc = DI_HDMI_HDCP22KeyProvisioning(s_ucaGoodHdcp22Key, sizeof(s_ucaGoodHdcp22Key), Output);
		if(rc == DI_ERR_OK)
		{
			rc = DI_NVRAM_Write(DI_NVRAM_FS_PARTITION_RO, HDCP22_KEY, 0, Output, sizeof(s_ucaGoodHdcp22Key));
			if(rc == DI_ERR_OK)
			{
				fd = fopen(SAGE_FW_FLAGE, "wb");
				if(fd != NULL)
				{
					fclose(fd);
				}
#if (HDMI_HDCP20_KEY_BOUND_ATFER_REBOOT_ENABLE==YES)
				DI_POWER_SetMainChipReset();
#endif
			}
		}
		if(Output != NULL)
		{
			FVK_MEM_Free(Output);
		}
	}
	else
	{
		fclose(fd);
	}
#endif
#if defined(CONFIG_HDMI_REFACTORING)
	DI_HDMI_SetPowerState(TRUE);
#else
	DI_HDMI_EnableOutput(TRUE);
#endif	
	
	return FDI_NO_ERR;
}

/*******************************************************************************
* function : FDI_HDMI_IsConnected
* description :
* input :
* output :
* return : 
* 기타 참고자료 및 파일
*******************************************************************************/
FDI_ERR_CODE FDI_HDMI_IsConnected(BOOL *bConnected)
{
	HDMI_RECEIVER_INFO stHdmiInfo;

	DI_HDMI_GetState(IS_CONNECTED, &stHdmiInfo);
	if(stHdmiInfo.bIsConnected)
	{
		*bConnected = TRUE;
	}
	else
	{
		*bConnected = FALSE;
	}
	return FDI_NO_ERR;
}

/*******************************************************************************
* function : FDI_HDMI_EnableHdcp
* description :
* input :
* output :
* return : 
* 기타 참고자료 및 파일
*******************************************************************************/
FDI_ERR_CODE FDI_HDMI_EnableHdcp(BOOL bEnable)
{
	if( DI_HDMI_EnableHDCP(bEnable) != DI_ERR_OK )
	{
		FDI_PRINT(FDI_PRT_ERROR, ("[FDI_HDMI_EnableHdcp] : DI_HDMI_EnableHDCP Error\n"));
		return FDI_ERR;
	}
	return FDI_NO_ERR;
}

/*******************************************************************************
* function : FDI_HDMI_EnableOutput
* description :
* input :
* output :
* return : 
* 기타 참고자료 및 파일
*******************************************************************************/
FDI_ERR_CODE FDI_HDMI_EnableOutput(BOOL bEnable)
{
#if defined(CONFIG_HDMI_REFACTORING)

#else
	if( DI_HDMI_EnableOutput(bEnable) != DI_ERR_OK )
	{
		FDI_PRINT(FDI_PRT_ERROR, ("[FDI_HDMI_EnableOutput] : DI_HDMI_EnableOutput Error\n"));
		return FDI_ERR;
	}
#endif	
	return FDI_NO_ERR;
}

/*******************************************************************************
* function : FDI_HDMI_SendCecMsg
* description :
* input :
* output :
* return : 
* 기타 참고자료 및 파일
*******************************************************************************/
FDI_ERR_CODE FDI_HDMI_SendCecMsg(FDI_HDMI_CEC_MSG_t* pstCecMsg)
{
#if defined(CONFIG_HDMI_CEC)
	DI_HDMI_CEC_MSG_t stDiCec;

	stDiCec.ucDestAddr = pstCecMsg->ucDestAddr;
	stDiCec.ucInitAddr = pstCecMsg->ucInitAddr;
	FVK_MEM_Copy(stDiCec.ucMessage, pstCecMsg->ucMessage, 16);
	stDiCec.ucMegLength = pstCecMsg->ucMegLength;

	if( DI_HDMI_SendCecMsg(&stDiCec) != DI_ERR_OK )
	{
		FDI_PRINT(FDI_PRT_ERROR, ("[FDI_HDMI_SendCecMsg] : DI_HDMI_SendCecMsg Error\n"));
		return FDI_ERR;
	}

	return FDI_NO_ERR;
#else
	return FDI_ERR;
#endif
}

/*******************************************************************************
* function : FAI_HDMI_Output
* description :
* input :
* output :
* return : 
* 기타 참고자료 및 파일
*******************************************************************************/
FDI_ERR_CODE FDI_HDMI_RegisterCallback(FDI_HDMI_EVENT_e eEvent, FDI_HDMI_CALLBACK callback)
{
	DI_HDMI_EVENT	event;	


	switch( eEvent )
	{
		case FDI_HDMI_EVENT_CONNECT :
			event = DH_EVENT_HOTPLUG_CONNECT;
			break;
		case FDI_HDMI_EVENT_DISCONNECT :
			event = DH_EVENT_HOTPLUG_DISCONNECT;
			break;
		case FDI_HDMI_EVENT_HDCP_SUCCESS :
			event = DH_EVENT_HDCP_SUCCESS;
			break;
		case FDI_HDMI_EVENT_HDCP_FAIL :
			event = DH_EVENT_HDCP_FAIL;
			break;
		default :
			FDI_PRINT(FDI_PRT_ERROR, ("[FDI_HDMI_RegisterCallback] : Invalid Event(%d)\n", eEvent));
			return FDI_ERR;
	}

	if( DI_HDMI_RegisterEventNotify(event, callback) != DI_ERR_OK )
	{
		FDI_PRINT(FDI_PRT_ERROR, ("[FDI_HDMI_RegisterCallback] : DI_HDMI_RegisterEventNotify Error\n"));
		return FDI_ERR;
	}
	return FDI_NO_ERR;	
}

/*******************************************************************************
* function : FDI_HDMI_Hdcp22Validation
* description :
* input :
* output :
* return : 
* 기타 참고자료 및 파일
*******************************************************************************/
FDI_ERR_CODE FDI_HDMI_Hdcp22Validation()
{	
#if defined(CONFIG_HDCP_22_PROVISIONING)
	int rc = 0; 		
	int NvramKeySize;
	HUINT8* pHdcpKey;

	rc = DI_NVRAM_GetSize(DI_NVRAM_FS_PARTITION_RO, HDCP22_KEY, &NvramKeySize);
	if(rc)
	{
		FDI_PRINT(FDI_PRT_ERROR, ("DI_NVRAM_GetSize(HDCP22_KEY) error(0x%x)!!\n", rc));
		FDI_PRINT(FDI_PRT_ERROR, ("The HDCP22 key don't exists in nvram\n"));
		return FDI_ERR;
	}
	else
	{
		pHdcpKey = FVK_MEM_Alloc(NvramKeySize);
		if(pHdcpKey != NULL)
		{
			memset(pHdcpKey,0xff,NvramKeySize);
			rc = DI_NVRAM_Read(DI_NVRAM_FS_PARTITION_RO, HDCP22_KEY, 0, pHdcpKey, NvramKeySize);
			if(rc)
			{
				FDI_PRINT(FDI_PRT_ERROR, ("DI_NVRAM_Read(HDCP22_KEY) error(0x%x)!!\n", rc));
				FDI_PRINT(FDI_PRT_ERROR, ("The HDCP22 key don't exists in nvram\n"));
				
				FVK_MEM_Free(pHdcpKey);
				return FDI_ERR;
				
			}	
		}

		rc = DI_HDMI_HDCP22KeyValidation(pHdcpKey, NvramKeySize);
		FVK_MEM_Free(pHdcpKey);
		if(rc)
		{
			FDI_PRINT(FDI_PRT_ERROR, ("DI_HDMI_HDCP22KeyValidation() ERROR\n"));
			return FDI_ERR;
		}
		else
		{
			FDI_PRINT(FDI_PRT_ERROR, ("DI_HDMI_HDCP22KeyValidation() OKOKOK\n"));
			return FDI_NO_ERR;	
		}
		
	}
#endif	
	return FDI_ERR;
}

/* end of file */

