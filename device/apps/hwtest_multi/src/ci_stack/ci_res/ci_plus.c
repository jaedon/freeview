/***************************************************************
* $Workfile:   ci_plus.c  $
* $Modtime:
* Auther : hmkim
*
* Desc : CI+ Protocol Porting Layer
*
* Copyright (c) 2008 by Humax Co., Ltd.
* All right reserved
****************************************************************/


/***************************************************************
* #ifdef statements and include
***************************************************************/

#include "ci_plus.h"
#include "ci_cc_cipher.h"
#include "ci_cc_x509.h"

#if !defined(WIN32)
#include <unistd.h>			// for sync()
#else
#define	sync
#endif

#include <db_common.h>		// for DB_JFFS2_PATH define
#include <di_factory.h>		// for DI_FAC_SetCiLicenseDownload() and DI_FAC_RegisterDownloadNotify()
#include <pal_key.h>		// for CI_MES_LicenseDownCbFunc()

#include <timeconv.h>		// for CI_GetCurrentUtcTime()
#include <cb_list.h>		// for CI_SetCckToDesc(), CI_ApplyUriToExternalOutput() and callbacks
#include <isosvc.h>			// for CI_GetCountryCode() and CI_GetLanguageCode()


/***************************************************************
* local definition
***************************************************************/

#define CI_HOST_LICENSE_CONST_FILE	DB_JFFS2_PATH "ci_plus_licenseconst.bin" // host license constants 저장 : < 주의 > 이 내용은 생산 S/W 에도 적용되므로 절대 임의로 수정하지 말 것 !!
#define CI_AUTH_CTXS_1ST_FILE		DB_JFFS2_PATH "ci_plus_authctxs_1st.bin" // authentication contexts 저장 : 1 slot 모델에선 이것만 사용된다.
#define CI_AUTH_CTXS_2ND_FILE		DB_JFFS2_PATH "ci_plus_authctxs_2nd.bin" // authentication contexts 저장 : 2 slot 모델에선 이것도 사용된다.


/***************************************************************
* static / extern variables and structures
***************************************************************/

static unsigned char K[CI_CC_CIPHER_KEY_LEN]		= {0x62,0x79,0x20,0x68,0x6D,0x6B,0x69,0x6D,0x2C,0x20,0x68,0x75,0x6D,0x61,0x78,0x2E}; /* const */
static unsigned char IV[CI_CC_CIPHER_BLOCK_SIZE]	= {0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f};

static CI_PLUS_MODE s_enPlusMode = CI_PLUS_FREE_MODE;
static CI_HOST_MODE s_enHostMode = CI_HOST_MODE_NORMAL;

// CI+ data download task callback status variables
static HBOOL s_bIsLicenseDownCbRegSuccess = FALSE;
static HBOOL s_bIsLicenseDownTaskEnd = FALSE;

extern CI_AUTH_CTXs s_stCiAuthCtxs[CI_MAX_NUM_OF_CAM];


/***************************************************************
* global variables
***************************************************************/

CALLBACK_HANDLE		g_hCbNotifyCcReport = NULL;		// for ci_cc_main.c
CALLBACK_HANDLE		g_hCbNotifySetKey = NULL;			// for CI_SetCckToDesc()
CALLBACK_HANDLE		g_hCbNotifyUriControl = NULL;	// for CI_ApplyUriToExternalOutput()
CALLBACK_HANDLE		g_hCbNotifyHostTune = NULL;		// for ci_hci.c
CALLBACK_HANDLE		g_hCbNotifyPidReplace = NULL;	// for ci_hci.c
CALLBACK_HANDLE		g_hCbNotifyCamUpgrade = NULL;	// for ci_cu.c


/***************************************************************
* static function bodies
***************************************************************/



/***************************************************************
* extern function prototypes
***************************************************************/

extern int CiAmmi_RegisterCallback(CI_AMMI_CALLBACK_T pfnCallback);
extern int CiAmmi_FileRequest(unsigned short usSsNo, unsigned char ucReqType /* CI_AMMI_REQUEST_TYPE */, unsigned char *pucBytes, unsigned long ulBytesLen);
extern int CiAmmi_AppAbortRequest(unsigned short usSsNo, unsigned char ucAbortReqCode /* CI_AMMI_ABORT_REQUEST_CODE */);

extern int CiCc_GetHostId(unsigned char *pucHostId);
extern int CiCc_GetBindedCamId(CI_SLOT_ID usSlotId, unsigned char *pucBindedCamId);
extern int CiCc_GetBindedCamBrandId(CI_SLOT_ID usSlotId, unsigned short *pusBindedCamBrandId);
extern int CiCc_GetNegotiatedCckCipher(CI_SLOT_ID usSlotId, CI_CC_KEY_CIPHER *penNegotiatedCckCipher);
extern void CiCc_ReqSetCckToDesc(CI_SLOT_ID usSlotId);
extern void CiCc_SetUriDefault(CI_SLOT_ID usSlotId, HBOOL bOn);
extern int CiCc_IsOpened(CI_SLOT_ID usSlotId);
extern int PHYS_IsCiPlusCam(unsigned short slot);

extern int CiHlc_NotifyHostCountryInfoChanged(CI_SLOT_ID usSlotId);
extern int CiHlc_NotifyHostLanguageInfoChanged(CI_SLOT_ID usSlotId);


/***************************************************************
* public function bodies
***************************************************************/

// get the proper data rate on the PCMCIA bus : return CI_PCMCIA_DATA_RATE_72_MBPS for 72 Mbps (host mandatory), CI_PCMCIA_DATA_RATE_96_MBPS for 96 Mbps (host optional)
unsigned char CI_GetDataRate (void)
{
	return CI_PCMCIA_DATA_RATE_72_MBPS; // 현 상태로 추가 코딩은 필요 없을 듯...
}

// register callback function to ci_ammi.c, which should be called by CI+ MHEG init flow. it returns -1 if there is any error
int CI_RegisterAppMmiCallback (CI_AMMI_CALLBACK_T pfnCallback)
{
	return CiAmmi_RegisterCallback(pfnCallback);
}

// request file or data to ci_ammi.c, which is called by CI+ MHEG engine. it returns -1 if there is any error
// - usSessionId    : CI_AMMI_MSG_REQ_START 메시지로 받은 usSessionId
// - ucReqType      : CI_AMMI_REQUEST_TYPE
// - pucBytes       : ucReqType 값에 따라 파일명 내지는 데이터명
// - ulBytesLen     : pucBytes 의 길이
int CI_RequestFileorData (unsigned short usSessionId, unsigned char ucReqType, unsigned char *pucBytes, unsigned long ulBytesLen)
{
	return CiAmmi_FileRequest(usSessionId, ucReqType, pucBytes, ulBytesLen);
}

// request app abort to ci_ammi.c, which is called by CI+ MHEG engine. it returns -1 if there is any error
// - usSessionId    : CI_AMMI_MSG_REQ_START 또는 CI_AMMI_MSG_FILE_ACK 메시지로 받은 usSessionId
// - ucAbortReqCode : CI_AMMI_ABORT_REQUEST_CODE
int CI_RequestAppAbort (unsigned short usSessionId, unsigned char ucAbortReqCode)
{
	return CiAmmi_AppAbortRequest(usSessionId, ucAbortReqCode);
}

// load CI+ host license constants data from non-volatile memory and return -1 if there is any error (데이터 무결성 및 보안을 위해 데이터들은 SHA-256 으로 hashing 되고 AES-128-CBC 로 암호화된다)
int CI_LoadHostLicenseConstants (CI_HOST_LICENSE_CONST *pstCiHostLicenseConst)
{
	unsigned short usOrgLen = sizeof(CI_HOST_LICENSE_CONST), usAlignedLen = GetAlignedLen(usOrgLen);
	unsigned char *C = NULL, *P = NULL;
	unsigned char D[32];

	FILE *fpBinaryFile = NULL;
	int nDataSize = 0;

	if (pstCiHostLicenseConst == NULL)
	{
		PrintErr(("[CI+]---> CI_LoadHostLicenseConstants()---> Error : Invalid params !!!\n"));
		return -1;
	}

	C = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);
	P = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);

	fpBinaryFile = fopen(CI_HOST_LICENSE_CONST_FILE, "rb");
	if (fpBinaryFile == NULL)
	{
		PrintErr(("[CI+]---> CI_LoadHostLicenseConstants()---> Error : Can't open file !!!\n"));
		CA_MEM_Free(C);
		CA_MEM_Free(P);
		return -1;
	}

	nDataSize = fread(C, 1, usAlignedLen, fpBinaryFile);
	fclose(fpBinaryFile);

	if (nDataSize != usAlignedLen)
	{
		PrintErr(("[CI+]---> CI_LoadHostLicenseConstants()---> Error : Can't read data !!!\n"));
		CA_MEM_Free(C);
		CA_MEM_Free(P);
		return -1;
	}

	D_AES_CBC(K, C, P, usAlignedLen, IV);
	VK_memcpy(pstCiHostLicenseConst, P, usOrgLen);

	CA_MEM_Free(C);
	CA_MEM_Free(P);

	SHA_256((unsigned char *)pstCiHostLicenseConst, usOrgLen-32, D);

	if (VK_memcmp(pstCiHostLicenseConst->ucDigest, D, 32) != 0)
	{
		PrintErr(("[CI+]---> CI_LoadHostLicenseConstants()---> Error : Invalid digest !!!\n"));
		return -1;
	}

	return ERR_OK;
}

#ifdef CI_PLUS_PRODUCTION_Credentials
// save CI+ host license constants data to non-volatile memory and return -1 if there is any error (데이터 무결성 및 보안을 위해 데이터들은 SHA-256 으로 hashing 되고 AES-128-CBC 로 암호화된다)
int CI_SaveHostLicenseConstantsForTestKitOnly (void)
{
	CI_HOST_LICENSE_CONST stCiHostLicenseConst;

	unsigned short usOrgLen = sizeof(CI_HOST_LICENSE_CONST), usAlignedLen = GetAlignedLen(usOrgLen);
	unsigned char *P = NULL, *C = NULL;

	FILE *fpBinaryFile = NULL;
	int nDataSize = 0;

	unsigned char	RootCert[CI_MAX_CERT_LEN] = // from ciplus_root.cert -> cer
	{
		0x30, 0x82, 0x03, 0xF2, 0x30, 0x82, 0x02, 0xDA, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x0F, 0x00,
		0xC2, 0x5B, 0x00, 0x00, 0x00, 0x2C, 0xF2, 0x1B, 0xD8, 0x8B, 0x83, 0x19, 0x8E, 0x78, 0x30, 0x0D,
		0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x00, 0x30, 0x81, 0x91,
		0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x4B, 0x31, 0x0F, 0x30,
		0x0D, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64, 0x6F, 0x6E, 0x31, 0x0F,
		0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64, 0x6F, 0x6E, 0x31,
		0x14, 0x30, 0x12, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0B, 0x43, 0x49, 0x20, 0x50, 0x6C, 0x75,
		0x73, 0x20, 0x4C, 0x4C, 0x50, 0x31, 0x0F, 0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x06,
		0x45, 0x75, 0x72, 0x6F, 0x70, 0x65, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13,
		0x0A, 0x50, 0x72, 0x6F, 0x64, 0x75, 0x63, 0x74, 0x69, 0x6F, 0x6E, 0x31, 0x24, 0x30, 0x22, 0x06,
		0x03, 0x55, 0x04, 0x03, 0x13, 0x1B, 0x43, 0x49, 0x20, 0x50, 0x6C, 0x75, 0x73, 0x20, 0x52, 0x6F,
		0x6F, 0x74, 0x20, 0x43, 0x41, 0x20, 0x63, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74,
		0x65, 0x30, 0x1E, 0x17, 0x0D, 0x30, 0x38, 0x31, 0x31, 0x32, 0x36, 0x31, 0x33, 0x31, 0x39, 0x34,
		0x35, 0x5A, 0x17, 0x0D, 0x39, 0x39, 0x31, 0x32, 0x33, 0x31, 0x32, 0x33, 0x35, 0x39, 0x35, 0x39,
		0x5A, 0x30, 0x81, 0x91, 0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55,
		0x4B, 0x31, 0x0F, 0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64,
		0x6F, 0x6E, 0x31, 0x0F, 0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x06, 0x4C, 0x6F, 0x6E,
		0x64, 0x6F, 0x6E, 0x31, 0x14, 0x30, 0x12, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0B, 0x43, 0x49,
		0x20, 0x50, 0x6C, 0x75, 0x73, 0x20, 0x4C, 0x4C, 0x50, 0x31, 0x0F, 0x30, 0x0D, 0x06, 0x03, 0x55,
		0x04, 0x0B, 0x13, 0x06, 0x45, 0x75, 0x72, 0x6F, 0x70, 0x65, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
		0x55, 0x04, 0x0B, 0x13, 0x0A, 0x50, 0x72, 0x6F, 0x64, 0x75, 0x63, 0x74, 0x69, 0x6F, 0x6E, 0x31,
		0x24, 0x30, 0x22, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x1B, 0x43, 0x49, 0x20, 0x50, 0x6C, 0x75,
		0x73, 0x20, 0x52, 0x6F, 0x6F, 0x74, 0x20, 0x43, 0x41, 0x20, 0x63, 0x65, 0x72, 0x74, 0x69, 0x66,
		0x69, 0x63, 0x61, 0x74, 0x65, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48,
		0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0F, 0x00, 0x30, 0x82, 0x01,
		0x0A, 0x02, 0x82, 0x01, 0x01, 0x00, 0xA8, 0xD0, 0x5F, 0x2B, 0x39, 0x9D, 0x93, 0xF3, 0x2A, 0xC8,
		0x6E, 0xE8, 0x26, 0x3A, 0xB0, 0x16, 0x48, 0xFF, 0x6F, 0xBB, 0x70, 0x2E, 0xFF, 0xEF, 0x12, 0xBC,
		0xF9, 0xD3, 0x29, 0x6A, 0x34, 0xF8, 0xD2, 0xA2, 0x4B, 0x57, 0x39, 0x90, 0x71, 0xEC, 0x33, 0x55,
		0x77, 0x4A, 0x49, 0x7C, 0x95, 0x9A, 0x70, 0xE6, 0x6F, 0xB4, 0x58, 0xE5, 0xB8, 0x11, 0xBD, 0xEF,
		0xC2, 0x1E, 0xD1, 0xCE, 0x45, 0x59, 0x5F, 0x8F, 0x2F, 0x51, 0x98, 0x42, 0xBB, 0xFE, 0x16, 0x90,
		0x62, 0xA3, 0xBF, 0x92, 0x06, 0xC1, 0xA3, 0x99, 0x95, 0x12, 0x14, 0x28, 0x6C, 0xFB, 0xCE, 0xFC,
		0x7A, 0x7D, 0xD8, 0xD6, 0x99, 0xEB, 0x24, 0x14, 0x6D, 0x61, 0x7C, 0x4E, 0x33, 0x01, 0x4D, 0x4B,
		0x56, 0x97, 0x33, 0xF5, 0xA5, 0x02, 0xCD, 0x01, 0x49, 0xA5, 0x11, 0xDD, 0x5F, 0xC5, 0x72, 0xFD,
		0x86, 0xF2, 0x75, 0x14, 0x78, 0x1B, 0xCE, 0x44, 0x1C, 0x9A, 0xEB, 0x1C, 0x0C, 0x5A, 0xAC, 0xCC,
		0x93, 0xEE, 0x01, 0xF8, 0xEB, 0x8B, 0x0F, 0xC9, 0xA6, 0xBB, 0x77, 0x33, 0xBA, 0x13, 0x1A, 0xC7,
		0xFC, 0x49, 0x09, 0x62, 0xBA, 0x7C, 0xDA, 0x29, 0x23, 0xAF, 0x33, 0xF3, 0x6C, 0xFE, 0x50, 0x9C,
		0xDB, 0x78, 0x16, 0x27, 0x86, 0xF9, 0x5F, 0x51, 0x2F, 0x96, 0xAA, 0x8F, 0xB3, 0xAB, 0x2D, 0x60,
		0x14, 0xF9, 0x12, 0x69, 0x92, 0xFB, 0x70, 0xEB, 0x5E, 0x94, 0x02, 0x3B, 0x67, 0x42, 0x4B, 0x26,
		0xFC, 0xA9, 0xF3, 0xA5, 0x5C, 0x66, 0x5B, 0xE6, 0x6B, 0x56, 0x85, 0x47, 0x62, 0xBA, 0xE5, 0x7B,
		0x2B, 0x41, 0x99, 0xA9, 0x43, 0x22, 0x86, 0xBA, 0xA5, 0x29, 0xA2, 0x9A, 0xCE, 0x31, 0x4B, 0xBA,
		0xF3, 0x1E, 0xD1, 0x40, 0x2E, 0xFA, 0xBE, 0xBD, 0x36, 0x4C, 0x2C, 0x97, 0xF0, 0x85, 0x1C, 0x35,
		0x09, 0x3F, 0x90, 0x86, 0x1D, 0x79, 0x02, 0x03, 0x01, 0x00, 0x01, 0xA3, 0x45, 0x30, 0x43, 0x30,
		0x12, 0x06, 0x03, 0x55, 0x1D, 0x13, 0x01, 0x01, 0xFF, 0x04, 0x08, 0x30, 0x06, 0x01, 0x01, 0xFF,
		0x02, 0x01, 0x01, 0x30, 0x0E, 0x06, 0x03, 0x55, 0x1D, 0x0F, 0x01, 0x01, 0xFF, 0x04, 0x04, 0x03,
		0x02, 0x01, 0x06, 0x30, 0x1D, 0x06, 0x03, 0x55, 0x1D, 0x0E, 0x04, 0x16, 0x04, 0x14, 0x27, 0xC8,
		0x75, 0xCE, 0xBD, 0x7D, 0x44, 0x74, 0xB1, 0x7B, 0x6B, 0x9D, 0x49, 0xA1, 0xC2, 0x79, 0x80, 0xD8,
		0x2E, 0x3F, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30,
		0x00, 0x03, 0x82, 0x01, 0x01, 0x00, 0x11, 0x81, 0x62, 0x7C, 0x8A, 0x3F, 0x9A, 0x8C, 0xB3, 0x43,
		0x06, 0x7E, 0xD8, 0x02, 0x62, 0x06, 0xAC, 0x2F, 0x3A, 0xE9, 0x66, 0xD7, 0x9A, 0x4D, 0xD8, 0xEC,
		0xA2, 0x40, 0x17, 0x91, 0xB3, 0xE0, 0x3E, 0xEC, 0xE1, 0xEF, 0xF6, 0x98, 0xA7, 0xBC, 0x88, 0x84,
		0xDA, 0x84, 0x7F, 0x17, 0xC8, 0xF6, 0xA7, 0xC8, 0x3B, 0x89, 0xCF, 0x86, 0x3B, 0xBA, 0xB6, 0x5E,
		0x3A, 0xB6, 0x84, 0x89, 0x23, 0xD7, 0x04, 0xFA, 0x1A, 0x60, 0x3E, 0x26, 0x73, 0x02, 0xD7, 0x2E,
		0xD1, 0x4A, 0x82, 0xC8, 0xB8, 0x44, 0x19, 0xBA, 0x51, 0x37, 0x54, 0x26, 0xF7, 0x3E, 0x91, 0xBD,
		0x54, 0x31, 0x4E, 0x7F, 0xC1, 0xC2, 0x0F, 0x2F, 0xD6, 0x01, 0x3B, 0xFA, 0xEE, 0x97, 0x13, 0xBC,
		0x0F, 0x29, 0x5C, 0x2A, 0x87, 0x92, 0xFB, 0x6E, 0xBA, 0x5D, 0x2A, 0xE9, 0x42, 0xAC, 0x8C, 0xF4,
		0x6D, 0x28, 0xF0, 0xBA, 0x64, 0x3C, 0x20, 0xB5, 0xCC, 0xF1, 0xED, 0xBC, 0xC5, 0xEF, 0x30, 0x9D,
		0x03, 0xE2, 0x7C, 0xC8, 0xCE, 0x47, 0x34, 0x4D, 0xE6, 0x8C, 0x69, 0x5D, 0x2C, 0x12, 0xB6, 0xB6,
		0x65, 0xEC, 0xDF, 0xAE, 0x5C, 0x0A, 0x9A, 0x37, 0xEE, 0xB1, 0x35, 0x03, 0xC1, 0xAB, 0xB1, 0x9F,
		0x21, 0x2D, 0x37, 0xA8, 0x13, 0x88, 0xF8, 0x42, 0x2F, 0x25, 0x40, 0x32, 0xE8, 0xF6, 0x60, 0x9B,
		0x20, 0x89, 0x42, 0x5F, 0xB9, 0x70, 0x8B, 0x6C, 0x07, 0xDE, 0x54, 0x2B, 0x6E, 0xFC, 0xE4, 0xAD,
		0xFE, 0x33, 0x3A, 0x25, 0xBF, 0x09, 0xEB, 0x64, 0xFE, 0x71, 0xD4, 0x7C, 0xDA, 0x64, 0x0D, 0xE2,
		0xA9, 0x3C, 0x72, 0xAB, 0x8E, 0x6B, 0xFF, 0xFD, 0xC6, 0xE9, 0x60, 0x91, 0x94, 0x16, 0x46, 0x15,
		0xE7, 0xE4, 0x27, 0x06, 0x1E, 0x11, 0x2E, 0xA9, 0x19, 0xDA, 0xE1, 0x75, 0xD0, 0x04, 0xFD, 0x06,
		0xB3, 0x41, 0x7B, 0xCA, 0xE9, 0x7F
	};
	unsigned char	Host_BrandCert[CI_MAX_CERT_LEN] = // from ciplus_humax_ca.cert -> cer
	{
		0x30, 0x82, 0x04, 0x14, 0x30, 0x82, 0x02, 0xFC, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x0F, 0x00,
		0x82, 0x16, 0x00, 0x00, 0x00, 0x2C, 0xF7, 0xD5, 0x1A, 0x3D, 0x9A, 0x82, 0x8F, 0xF4, 0x30, 0x0D,
		0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x00, 0x30, 0x81, 0x91,
		0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x4B, 0x31, 0x0F, 0x30,
		0x0D, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64, 0x6F, 0x6E, 0x31, 0x0F,
		0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64, 0x6F, 0x6E, 0x31,
		0x14, 0x30, 0x12, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0B, 0x43, 0x49, 0x20, 0x50, 0x6C, 0x75,
		0x73, 0x20, 0x4C, 0x4C, 0x50, 0x31, 0x0F, 0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x06,
		0x45, 0x75, 0x72, 0x6F, 0x70, 0x65, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13,
		0x0A, 0x50, 0x72, 0x6F, 0x64, 0x75, 0x63, 0x74, 0x69, 0x6F, 0x6E, 0x31, 0x24, 0x30, 0x22, 0x06,
		0x03, 0x55, 0x04, 0x03, 0x13, 0x1B, 0x43, 0x49, 0x20, 0x50, 0x6C, 0x75, 0x73, 0x20, 0x52, 0x6F,
		0x6F, 0x74, 0x20, 0x43, 0x41, 0x20, 0x63, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74,
		0x65, 0x30, 0x1E, 0x17, 0x0D, 0x30, 0x39, 0x30, 0x34, 0x30, 0x32, 0x31, 0x33, 0x31, 0x34, 0x34,
		0x33, 0x5A, 0x17, 0x0D, 0x39, 0x39, 0x31, 0x32, 0x33, 0x31, 0x32, 0x33, 0x35, 0x39, 0x35, 0x39,
		0x5A, 0x30, 0x81, 0x92, 0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x4B,
		0x52, 0x31, 0x14, 0x30, 0x12, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0B, 0x47, 0x79, 0x65, 0x6F,
		0x6E, 0x67, 0x67, 0x69, 0x2D, 0x64, 0x6F, 0x31, 0x14, 0x30, 0x12, 0x06, 0x03, 0x55, 0x04, 0x07,
		0x13, 0x0B, 0x53, 0x65, 0x6F, 0x6E, 0x67, 0x6E, 0x61, 0x6D, 0x2D, 0x73, 0x69, 0x31, 0x18, 0x30,
		0x16, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0F, 0x48, 0x75, 0x6D, 0x61, 0x78, 0x20, 0x43, 0x6F,
		0x2E, 0x2C, 0x20, 0x4C, 0x74, 0x64, 0x2E, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x0B,
		0x13, 0x0A, 0x50, 0x72, 0x6F, 0x64, 0x75, 0x63, 0x74, 0x69, 0x6F, 0x6E, 0x31, 0x28, 0x30, 0x26,
		0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x1F, 0x43, 0x49, 0x20, 0x50, 0x6C, 0x75, 0x73, 0x20, 0x52,
		0x4F, 0x54, 0x20, 0x66, 0x6F, 0x72, 0x20, 0x48, 0x75, 0x6D, 0x61, 0x78, 0x20, 0x43, 0x6F, 0x2E,
		0x2C, 0x20, 0x4C, 0x74, 0x64, 0x2E, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86,
		0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0F, 0x00, 0x30, 0x82,
		0x01, 0x0A, 0x02, 0x82, 0x01, 0x01, 0x00, 0xC7, 0xF3, 0xD1, 0xBE, 0x34, 0x2A, 0xC8, 0x73, 0xAA,
		0x16, 0x00, 0xEA, 0xD7, 0xED, 0x5A, 0x75, 0x57, 0xB6, 0x68, 0x9A, 0x94, 0x31, 0x3A, 0x2C, 0xDF,
		0xB1, 0x75, 0x8E, 0xF1, 0x1F, 0x42, 0xA5, 0xEC, 0x22, 0x39, 0x97, 0xE0, 0xAB, 0x0B, 0x1F, 0x7F,
		0x4A, 0x78, 0xE7, 0x14, 0xC3, 0x2B, 0x63, 0x4E, 0x76, 0x57, 0xC1, 0x3E, 0x70, 0xAD, 0xF2, 0xA8,
		0xEA, 0xE2, 0xDE, 0xEB, 0xC6, 0xAC, 0x45, 0x8A, 0x64, 0x4A, 0x56, 0x0B, 0x3A, 0xA6, 0x6B, 0x72,
		0x9D, 0xC7, 0xB9, 0xBF, 0xCD, 0xC1, 0x8C, 0x36, 0x4E, 0x4D, 0xCE, 0x06, 0xBE, 0x39, 0xDB, 0x21,
		0x76, 0x11, 0xAE, 0x26, 0x40, 0xC1, 0xBE, 0x39, 0x38, 0xA3, 0x51, 0x8B, 0xD8, 0xA7, 0xCC, 0x3B,
		0xD5, 0x17, 0x61, 0x29, 0xE6, 0x06, 0x88, 0x48, 0x14, 0x5F, 0xA2, 0x8F, 0xC7, 0xCE, 0xD9, 0xAD,
		0x8A, 0xED, 0x20, 0xA7, 0x55, 0xE4, 0x13, 0xE3, 0x26, 0xC0, 0x52, 0x95, 0xAA, 0xBC, 0x12, 0x62,
		0x3F, 0x95, 0x86, 0x1F, 0x3E, 0x7B, 0x3D, 0xFF, 0xDB, 0xEF, 0x8E, 0x6A, 0x2A, 0x8B, 0xCF, 0x05,
		0xC0, 0x2A, 0x14, 0x77, 0xD8, 0x36, 0x71, 0x5D, 0x27, 0x88, 0x83, 0xDA, 0xB2, 0xE9, 0x70, 0xFA,
		0x4C, 0x44, 0xB9, 0xD2, 0x39, 0x27, 0x08, 0x76, 0xC1, 0xB4, 0xAB, 0xEC, 0x7C, 0xB8, 0x47, 0x99,
		0xC3, 0xB8, 0xC2, 0x9A, 0x8E, 0x4A, 0xDE, 0x1C, 0x74, 0xC3, 0x9F, 0xE7, 0x98, 0x12, 0xD7, 0x96,
		0xFB, 0x0A, 0x69, 0xDF, 0x51, 0x7B, 0x19, 0x36, 0xF2, 0x88, 0xE2, 0x81, 0x95, 0x70, 0xF3, 0x4D,
		0x43, 0x43, 0x23, 0x47, 0xD9, 0xB2, 0xD0, 0xB0, 0x19, 0xE7, 0xC5, 0x67, 0x60, 0xA1, 0xF8, 0x9C,
		0x51, 0x04, 0x43, 0x13, 0x3C, 0xF0, 0xE9, 0xE7, 0xC4, 0x40, 0xAA, 0x20, 0x29, 0x86, 0xF7, 0x44,
		0x8C, 0x11, 0x3F, 0xCB, 0xDC, 0xA5, 0x9D, 0x02, 0x03, 0x01, 0x00, 0x01, 0xA3, 0x66, 0x30, 0x64,
		0x30, 0x1F, 0x06, 0x03, 0x55, 0x1D, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0x27, 0xC8, 0x75,
		0xCE, 0xBD, 0x7D, 0x44, 0x74, 0xB1, 0x7B, 0x6B, 0x9D, 0x49, 0xA1, 0xC2, 0x79, 0x80, 0xD8, 0x2E,
		0x3F, 0x30, 0x12, 0x06, 0x03, 0x55, 0x1D, 0x13, 0x01, 0x01, 0xFF, 0x04, 0x08, 0x30, 0x06, 0x01,
		0x01, 0xFF, 0x02, 0x01, 0x00, 0x30, 0x0E, 0x06, 0x03, 0x55, 0x1D, 0x0F, 0x01, 0x01, 0xFF, 0x04,
		0x04, 0x03, 0x02, 0x02, 0x04, 0x30, 0x1D, 0x06, 0x03, 0x55, 0x1D, 0x0E, 0x04, 0x16, 0x04, 0x14,
		0x32, 0xAF, 0x5D, 0x95, 0xCD, 0xA6, 0x57, 0xC3, 0x25, 0x89, 0xEB, 0x49, 0x22, 0x4C, 0x17, 0x78,
		0xF0, 0xFE, 0xB0, 0x2D, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01,
		0x0A, 0x30, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00, 0xA2, 0x97, 0x60, 0x74, 0x24, 0x74, 0xDB, 0x5A,
		0x8F, 0xFD, 0x24, 0x5E, 0x27, 0xA0, 0xCC, 0x18, 0x7A, 0x1A, 0x90, 0x25, 0x5D, 0xDE, 0xF7, 0xDD,
		0xD4, 0x2C, 0x1C, 0xF3, 0x03, 0x2D, 0x45, 0x87, 0xAE, 0x40, 0xA9, 0xCA, 0x6C, 0xB8, 0x23, 0x9D,
		0xF2, 0xDD, 0xFF, 0x04, 0xB4, 0xB1, 0x3D, 0x42, 0x44, 0x22, 0x5F, 0xAD, 0xFC, 0x46, 0x47, 0xC1,
		0x0A, 0x79, 0xEA, 0x6B, 0x24, 0xE3, 0x3E, 0x4E, 0xF9, 0xDA, 0xC2, 0x05, 0x17, 0xCA, 0xDF, 0x4F,
		0x04, 0xCA, 0x2E, 0x03, 0x3A, 0x39, 0x99, 0x27, 0x3C, 0x9C, 0x70, 0x61, 0xB8, 0xCA, 0x0F, 0xB8,
		0x61, 0xE7, 0xF2, 0x65, 0x32, 0xF8, 0xEB, 0x77, 0x21, 0xA8, 0x58, 0xDF, 0x97, 0x15, 0x85, 0xB5,
		0xE9, 0xE5, 0x5D, 0xCD, 0x2B, 0x34, 0x6D, 0xE2, 0x2E, 0xEB, 0xFC, 0x82, 0xB0, 0x17, 0x38, 0xB8,
		0x4E, 0xE6, 0xBE, 0x0D, 0x01, 0xF4, 0xC2, 0xAB, 0x34, 0x33, 0xE0, 0x7B, 0xCB, 0x10, 0xB0, 0xCB,
		0xD1, 0x5B, 0x6C, 0x48, 0x62, 0x0F, 0xE5, 0x09, 0x66, 0x59, 0x1E, 0x2C, 0x9B, 0x59, 0x9B, 0xDA,
		0xC5, 0xE5, 0x86, 0x76, 0x4C, 0xE6, 0x7E, 0xD5, 0xFA, 0xBD, 0x4F, 0x48, 0x67, 0x46, 0x0F, 0xC8,
		0x3F, 0xB0, 0x50, 0xEC, 0x1A, 0xE1, 0xFD, 0x87, 0x2A, 0x2F, 0x08, 0x08, 0x96, 0x38, 0x79, 0xBC,
		0xA0, 0x17, 0xC5, 0xC5, 0xF9, 0x04, 0x73, 0x99, 0x81, 0x0C, 0x6A, 0xE2, 0x3C, 0xA7, 0xC3, 0xC0,
		0xD2, 0x9C, 0x1A, 0x3E, 0x27, 0xA0, 0x21, 0xC5, 0x21, 0x9F, 0xE8, 0xE4, 0x14, 0x74, 0xA8, 0x17,
		0x73, 0x79, 0xDA, 0x13, 0x4F, 0x11, 0x21, 0x81, 0xAF, 0x2C, 0xE4, 0xCE, 0xC9, 0xAA, 0x6F, 0x2B,
		0x79, 0xAE, 0x6B, 0xFF, 0x4C, 0xEB, 0xEB, 0xF0, 0x1A, 0x57, 0x3E, 0x92, 0x22, 0x2E, 0x15, 0x94,
		0xCD, 0xFD, 0x07, 0x74, 0xD8, 0x60, 0x4D, 0xA4
	};
	unsigned char	Host_DevCert[CI_MAX_CERT_LEN] = // from 0A0BF75306A286DD-cert.der
	{
		0x30, 0x82, 0x04, 0x1E, 0x30, 0x82, 0x03, 0x06, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x0F, 0x00,
		0xC6, 0x0D, 0x00, 0x00, 0x00, 0x2C, 0x9E, 0x8B, 0x4F, 0xC0, 0xF4, 0x6A, 0x73, 0x36, 0x30, 0x0D,
		0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x00, 0x30, 0x81, 0x92,
		0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x4B, 0x52, 0x31, 0x14, 0x30,
		0x12, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0B, 0x47, 0x79, 0x65, 0x6F, 0x6E, 0x67, 0x67, 0x69,
		0x2D, 0x64, 0x6F, 0x31, 0x14, 0x30, 0x12, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x0B, 0x53, 0x65,
		0x6F, 0x6E, 0x67, 0x6E, 0x61, 0x6D, 0x2D, 0x73, 0x69, 0x31, 0x18, 0x30, 0x16, 0x06, 0x03, 0x55,
		0x04, 0x0A, 0x13, 0x0F, 0x48, 0x75, 0x6D, 0x61, 0x78, 0x20, 0x43, 0x6F, 0x2E, 0x2C, 0x20, 0x4C,
		0x74, 0x64, 0x2E, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x0A, 0x50, 0x72,
		0x6F, 0x64, 0x75, 0x63, 0x74, 0x69, 0x6F, 0x6E, 0x31, 0x28, 0x30, 0x26, 0x06, 0x03, 0x55, 0x04,
		0x03, 0x13, 0x1F, 0x43, 0x49, 0x20, 0x50, 0x6C, 0x75, 0x73, 0x20, 0x52, 0x4F, 0x54, 0x20, 0x66,
		0x6F, 0x72, 0x20, 0x48, 0x75, 0x6D, 0x61, 0x78, 0x20, 0x43, 0x6F, 0x2E, 0x2C, 0x20, 0x4C, 0x74,
		0x64, 0x2E, 0x30, 0x1E, 0x17, 0x0D, 0x30, 0x39, 0x30, 0x34, 0x30, 0x39, 0x30, 0x38, 0x33, 0x39,
		0x30, 0x38, 0x5A, 0x17, 0x0D, 0x35, 0x39, 0x30, 0x34, 0x30, 0x39, 0x30, 0x38, 0x33, 0x39, 0x30,
		0x38, 0x5A, 0x30, 0x81, 0xA7, 0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
		0x4B, 0x52, 0x31, 0x14, 0x30, 0x12, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0B, 0x47, 0x79, 0x65,
		0x6F, 0x6E, 0x67, 0x67, 0x69, 0x2D, 0x64, 0x6F, 0x31, 0x14, 0x30, 0x12, 0x06, 0x03, 0x55, 0x04,
		0x07, 0x13, 0x0B, 0x53, 0x65, 0x6F, 0x6E, 0x67, 0x6E, 0x61, 0x6D, 0x2D, 0x73, 0x69, 0x31, 0x18,
		0x30, 0x16, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0F, 0x48, 0x75, 0x6D, 0x61, 0x78, 0x20, 0x43,
		0x6F, 0x2E, 0x2C, 0x20, 0x4C, 0x74, 0x64, 0x2E, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04,
		0x0B, 0x13, 0x0A, 0x50, 0x72, 0x6F, 0x64, 0x75, 0x63, 0x74, 0x69, 0x6F, 0x6E, 0x31, 0x22, 0x30,
		0x20, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x19, 0x49, 0x44, 0x54, 0x56, 0x2D, 0x53, 0x54, 0x2D,
		0x44, 0x4F, 0x55, 0x47, 0x4C, 0x41, 0x53, 0x2D, 0x57, 0x49, 0x54, 0x48, 0x2D, 0x37, 0x31, 0x30,
		0x33, 0x31, 0x19, 0x30, 0x17, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x10, 0x30, 0x41, 0x30, 0x42,
		0x46, 0x37, 0x35, 0x33, 0x30, 0x36, 0x41, 0x32, 0x38, 0x36, 0x44, 0x44, 0x30, 0x82, 0x01, 0x22,
		0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03,
		0x82, 0x01, 0x0F, 0x00, 0x30, 0x82, 0x01, 0x0A, 0x02, 0x82, 0x01, 0x01, 0x00, 0xC7, 0x4E, 0xC7,
		0x57, 0x1F, 0xCD, 0x40, 0x53, 0xF3, 0xAB, 0x10, 0xCA, 0xC9, 0x21, 0x03, 0x33, 0xCB, 0x5F, 0xF1,
		0xAD, 0x05, 0xE2, 0x9A, 0x5F, 0xFA, 0x27, 0xAC, 0xFE, 0xF0, 0xF5, 0x07, 0xB7, 0x0F, 0xA0, 0xAA,
		0xC4, 0x9D, 0x39, 0x7A, 0x1B, 0xA0, 0x6A, 0x59, 0x98, 0x15, 0xC1, 0x99, 0xE1, 0x05, 0xE1, 0x7E,
		0xCC, 0xA1, 0x93, 0xD5, 0x02, 0xEB, 0xCB, 0x96, 0x22, 0x13, 0x6C, 0xE9, 0x82, 0x75, 0xDB, 0x99,
		0x60, 0xD7, 0x36, 0xBB, 0xCB, 0x40, 0x7E, 0xBD, 0x13, 0xFA, 0x85, 0x0A, 0x88, 0xC5, 0xEE, 0xE0,
		0x3D, 0x87, 0x7F, 0xFD, 0xA7, 0x3B, 0x50, 0x84, 0xDC, 0x5D, 0x08, 0x97, 0xD4, 0x2D, 0xA7, 0xE4,
		0x26, 0x15, 0x4F, 0x60, 0xC5, 0x17, 0xA1, 0x97, 0xA1, 0x0B, 0xAA, 0x78, 0xA8, 0x47, 0xD7, 0xC1,
		0xAA, 0x36, 0x1C, 0x4D, 0xB9, 0x3C, 0xDA, 0x6B, 0x7D, 0x98, 0x54, 0xEF, 0x76, 0x25, 0x80, 0x8D,
		0x4E, 0xB2, 0xB4, 0xD5, 0xD5, 0xF4, 0x50, 0x3B, 0xCD, 0xFA, 0x5B, 0x44, 0x91, 0xA5, 0xF8, 0x88,
		0x61, 0xA8, 0x1B, 0x96, 0xF5, 0xB4, 0x56, 0x3E, 0x41, 0x9B, 0x52, 0xC7, 0xDC, 0x0A, 0x60, 0xB3,
		0xBF, 0xFB, 0xF7, 0xE7, 0xB1, 0x1B, 0xF2, 0x4A, 0x5E, 0x7E, 0xDF, 0x5C, 0xE7, 0xD7, 0xC1, 0x4A,
		0x2C, 0x25, 0xB1, 0x87, 0xC0, 0x9A, 0x59, 0x37, 0x4F, 0x43, 0xB1, 0xB6, 0x45, 0xD2, 0x70, 0x05,
		0x49, 0x01, 0x4B, 0x3D, 0xFA, 0xCC, 0x6F, 0x40, 0xC7, 0x57, 0x0E, 0x0F, 0x55, 0x25, 0x48, 0xE8,
		0x66, 0x12, 0xC8, 0x3A, 0xE0, 0x79, 0x5A, 0x8C, 0xA0, 0x41, 0x81, 0xA5, 0xFB, 0xAE, 0x25, 0xE6,
		0xC3, 0x07, 0x2A, 0x30, 0x06, 0x05, 0x2F, 0xFE, 0xBA, 0x76, 0x40, 0xDC, 0x67, 0xFA, 0xA6, 0x55,
		0x6B, 0xF7, 0xDC, 0x76, 0x4B, 0xCB, 0xCA, 0x61, 0xA5, 0x7A, 0x85, 0xB9, 0x5F, 0x02, 0x03, 0x01,
		0x00, 0x01, 0xA3, 0x5A, 0x30, 0x58, 0x30, 0x1F, 0x06, 0x03, 0x55, 0x1D, 0x23, 0x04, 0x18, 0x30,
		0x16, 0x80, 0x14, 0x32, 0xAF, 0x5D, 0x95, 0xCD, 0xA6, 0x57, 0xC3, 0x25, 0x89, 0xEB, 0x49, 0x22,
		0x4C, 0x17, 0x78, 0xF0, 0xFE, 0xB0, 0x2D, 0x30, 0x0C, 0x06, 0x03, 0x55, 0x1D, 0x13, 0x01, 0x01,
		0xFF, 0x04, 0x02, 0x30, 0x00, 0x30, 0x0E, 0x06, 0x03, 0x55, 0x1D, 0x0F, 0x01, 0x01, 0xFF, 0x04,
		0x04, 0x03, 0x02, 0x07, 0x80, 0x30, 0x17, 0x06, 0x08, 0x2B, 0x06, 0x01, 0x05, 0x05, 0x07, 0x01,
		0x19, 0x01, 0x01, 0xFF, 0x04, 0x08, 0x30, 0x06, 0x02, 0x01, 0x01, 0x02, 0x01, 0x00, 0x30, 0x0D,
		0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x00, 0x03, 0x82, 0x01,
		0x01, 0x00, 0x92, 0xF3, 0x1B, 0x5E, 0x45, 0xE4, 0xEA, 0x60, 0x41, 0x14, 0x68, 0x5C, 0x77, 0x18,
		0xFA, 0xD8, 0xD1, 0x06, 0x58, 0x4E, 0xA8, 0x83, 0x47, 0x4D, 0xA9, 0x7A, 0xF2, 0x2C, 0x88, 0x77,
		0x4E, 0x4B, 0xF1, 0x0C, 0x85, 0x26, 0xDA, 0xDE, 0x92, 0xEE, 0x5C, 0xD5, 0x9C, 0xC3, 0xF3, 0x05,
		0xCA, 0x61, 0x36, 0xBE, 0x4A, 0xC4, 0x6D, 0x3B, 0x31, 0x6D, 0x26, 0xC8, 0x18, 0xFE, 0x74, 0xF3,
		0x4F, 0xFC, 0x80, 0x61, 0xA7, 0xD6, 0xB5, 0xE6, 0x69, 0xB9, 0xCF, 0x4B, 0xD9, 0xB9, 0x4D, 0xB7,
		0xED, 0xD8, 0xAD, 0xD0, 0xDE, 0x07, 0xCB, 0x0C, 0x07, 0x2B, 0xBD, 0x22, 0x8A, 0x81, 0x28, 0x84,
		0xF9, 0x3B, 0x6F, 0x8B, 0xC2, 0x90, 0x54, 0xCF, 0x72, 0x20, 0xFB, 0x77, 0xA4, 0xC8, 0x85, 0xF6,
		0x91, 0xBC, 0x89, 0x40, 0x52, 0x37, 0x04, 0x9A, 0xC1, 0xF2, 0xFD, 0x0A, 0xB6, 0x64, 0x1C, 0xFB,
		0x94, 0xC9, 0x7E, 0xA7, 0x65, 0x5C, 0xF3, 0x92, 0x38, 0x80, 0xF6, 0x17, 0x74, 0xED, 0xDC, 0xA4,
		0x4C, 0x55, 0xCD, 0x31, 0xDF, 0x68, 0x25, 0x8B, 0x92, 0x5E, 0x21, 0x13, 0x04, 0x80, 0xEE, 0xF7,
		0x40, 0xD7, 0xDC, 0xFE, 0x67, 0x89, 0x1C, 0x6C, 0x6D, 0x8E, 0x24, 0x87, 0xB9, 0x14, 0xB8, 0x4E,
		0xE5, 0x1E, 0xE7, 0xF6, 0xBA, 0x5A, 0xFE, 0xFB, 0x52, 0x7C, 0x60, 0x8D, 0x92, 0x6F, 0x70, 0x86,
		0xEF, 0xDC, 0xE8, 0xE4, 0xEA, 0x32, 0x8F, 0x30, 0x36, 0x5A, 0xE9, 0xFA, 0xFE, 0x05, 0xCB, 0x6B,
		0x28, 0xA4, 0xA0, 0x87, 0x94, 0xDF, 0x8A, 0x2C, 0x53, 0xCD, 0x9D, 0x26, 0x9B, 0xD7, 0x7F, 0xA0,
		0x79, 0xCC, 0xEF, 0x11, 0x6C, 0x0C, 0xBD, 0xB0, 0xB9, 0x96, 0x54, 0xAC, 0x55, 0x5E, 0xA0, 0x35,
		0xB8, 0x93, 0xBC, 0xD9, 0xFD, 0x65, 0x12, 0x3A, 0x3E, 0xC7, 0x1F, 0xDF, 0xAC, 0xFA, 0x9D, 0x26,
		0x7F, 0x5D
	};
	unsigned char	DH_p[CI_DH_P_LEN] = // from Credentials 문서
	{
		0xD6, 0x27, 0x14, 0x7A, 0x7C, 0x0C, 0x26, 0x63, 0x9D, 0x82, 0xEB, 0x1F, 0x4A, 0x18, 0xFF, 0x6C,
		0x34, 0xAD, 0xEA, 0xA6, 0xC0, 0x23, 0xE6, 0x65, 0xFC, 0x8E, 0x32, 0xC3, 0x33, 0xF4, 0x91, 0xA7,
		0xCC, 0x88, 0x58, 0xD7, 0xF3, 0xB3, 0x17, 0x5E, 0xB0, 0xA8, 0xEB, 0x5C, 0xD4, 0xD8, 0x3A, 0xAE,
		0x8E, 0x75, 0xA1, 0x50, 0x5F, 0x5D, 0x67, 0xC5, 0x40, 0xF4, 0xB3, 0x68, 0x35, 0xD1, 0x3A, 0x4C,
		0x93, 0x7F, 0xCA, 0xCE, 0xDD, 0x83, 0x29, 0x01, 0xC8, 0x4B, 0x76, 0x81, 0x56, 0x34, 0x83, 0x31,
		0x92, 0x72, 0x65, 0x7B, 0xAC, 0xD9, 0xDA, 0xA9, 0xD1, 0xD3, 0xE5, 0x77, 0x58, 0x6F, 0x5B, 0x44,
		0x3E, 0xAF, 0x7F, 0x6D, 0xF5, 0xCF, 0x0A, 0x80, 0x0D, 0xA5, 0x56, 0x4F, 0x4B, 0x85, 0x41, 0x0F,
		0x13, 0x41, 0x06, 0x1F, 0xF3, 0xD9, 0x65, 0x36, 0xAE, 0x47, 0x41, 0x1F, 0x1F, 0xE0, 0xDE, 0x69,
		0xE5, 0x86, 0x2A, 0xA1, 0xF2, 0x48, 0x02, 0x92, 0x68, 0xA6, 0x37, 0x9F, 0x76, 0x4F, 0x7D, 0x94,
		0x5D, 0x10, 0xE5, 0xAB, 0x5D, 0xB2, 0xF3, 0x12, 0x8C, 0x79, 0x03, 0x92, 0xA6, 0x7F, 0x8A, 0x78,
		0xB0, 0xBA, 0xC5, 0xB5, 0x31, 0xC5, 0xC8, 0x22, 0x6E, 0x29, 0x02, 0x40, 0xAB, 0xE7, 0x5C, 0x23,
		0x33, 0x7F, 0xCB, 0x86, 0xC7, 0xB4, 0xFD, 0xAA, 0x44, 0xCD, 0x9C, 0x9F, 0xBA, 0xAC, 0x3A, 0xCF,
		0x7E, 0x31, 0x5F, 0xA8, 0x47, 0xCE, 0xCA, 0x1C, 0xB4, 0x77, 0xA0, 0xEC, 0x9A, 0x46, 0xD4, 0x79,
		0x7B, 0x64, 0xBB, 0x6C, 0x91, 0xB2, 0x38, 0x01, 0x65, 0x11, 0x45, 0x9F, 0x62, 0x08, 0x6F, 0x31,
		0xCF, 0xC4, 0xBA, 0xDC, 0xD0, 0x03, 0x91, 0xF1, 0x18, 0x1F, 0xCB, 0x4D, 0xFC, 0x73, 0x5A, 0xA2,
		0x15, 0xB8, 0x3C, 0x8D, 0x80, 0x92, 0x1C, 0xA1, 0x03, 0xD0, 0x83, 0x2F, 0x5F, 0xE3, 0x07, 0x69
	};
	unsigned char	DH_g[CI_DH_G_LEN] = // from Credentials 문서
	{
		0x95, 0x7D, 0xD1, 0x49, 0x68, 0xC1, 0xA5, 0xF1, 0x48, 0xE6, 0x50, 0x4F, 0xA1, 0x10, 0x72, 0xC4,
		0xEF, 0x12, 0xEC, 0x2D, 0x94, 0xBE, 0xC7, 0x20, 0x2C, 0x94, 0xF9, 0x68, 0x67, 0x0E, 0x22, 0x17,
		0xB5, 0x5C, 0x0B, 0xCA, 0xAC, 0x9F, 0x25, 0x9C, 0xD2, 0xA6, 0x1A, 0x20, 0x10, 0x16, 0x6A, 0x42,
		0x27, 0x83, 0x47, 0x42, 0xA0, 0x07, 0x52, 0x09, 0x33, 0x97, 0x4E, 0x30, 0x57, 0xD8, 0xB7, 0x1E,
		0x46, 0xA6, 0xBA, 0x4E, 0x40, 0x6A, 0xE9, 0x1A, 0x5A, 0xA0, 0x74, 0x56, 0x92, 0x55, 0xC2, 0xBD,
		0x44, 0xCD, 0xB3, 0x33, 0xF7, 0x35, 0x46, 0x25, 0xDF, 0x84, 0x19, 0xF3, 0xE2, 0x7A, 0xAC, 0x4E,
		0xEE, 0x1A, 0x86, 0x3B, 0xB3, 0x87, 0xA6, 0x66, 0xC1, 0x70, 0x21, 0x41, 0xD3, 0x58, 0x36, 0xB5,
		0x3B, 0x6E, 0xA1, 0x55, 0x60, 0x9A, 0x59, 0xD3, 0x85, 0xD8, 0xDC, 0x6A, 0xFF, 0x41, 0xB6, 0xBF,
		0x42, 0xDE, 0x64, 0x00, 0xD0, 0xEE, 0x3A, 0xA1, 0x8A, 0xED, 0x12, 0xF9, 0xBA, 0x54, 0x5C, 0xDB,
		0x06, 0x24, 0x49, 0xE8, 0x47, 0xCF, 0x5B, 0xE4, 0xBB, 0xC0, 0xAA, 0x8A, 0x8C, 0xBE, 0x73, 0xD9,
		0x02, 0xEA, 0xEE, 0x8D, 0x87, 0x5B, 0xBF, 0x78, 0x04, 0x41, 0x9E, 0xA8, 0x5C, 0x3C, 0x49, 0xDE,
		0x88, 0x6D, 0x62, 0x21, 0x7F, 0xF0, 0x5E, 0x2D, 0x1D, 0xFC, 0x47, 0x0D, 0x1B, 0xAA, 0x4E, 0x0D,
		0x78, 0x20, 0xFE, 0x57, 0x0F, 0xCA, 0xDF, 0xEB, 0x3C, 0x84, 0xA7, 0xE1, 0x61, 0xB2, 0x95, 0x98,
		0x07, 0x73, 0x8E, 0x51, 0xC6, 0x87, 0xE4, 0xCF, 0xF1, 0x5F, 0x86, 0x99, 0xEC, 0x8D, 0x44, 0x92,
		0x2C, 0x99, 0xF6, 0xC0, 0xF4, 0x39, 0xE8, 0x05, 0xBF, 0xC1, 0x56, 0xDE, 0xFE, 0x93, 0x75, 0x06,
		0x69, 0x87, 0x83, 0x06, 0x51, 0x80, 0xA5, 0x6E, 0xA6, 0x19, 0x7D, 0x3B, 0xEF, 0xFB, 0xE0, 0x4A
	};
	unsigned char	DH_q[CI_DH_Q_LEN] = // from Credentials 문서
	{
		0xE2, 0x9C, 0x11, 0x9B, 0x5E, 0x32, 0xDE, 0x82, 0x7C, 0x7B, 0xD1, 0x59, 0x42, 0xA0, 0x6B, 0xB2,
		0x2A, 0xE2, 0x8D, 0x29, 0x02, 0xC6, 0xD3, 0xDB, 0x48, 0x9F, 0xD1, 0xBF, 0xC5, 0xCF, 0x1E, 0xE3
	};
	unsigned char	HDQ_d[CI_HDQ_D_LEN] = // from 0A0BF75306A286DD-key.der
	{
		0x2C, 0x44, 0x57, 0x0A, 0x06, 0xCA, 0x33, 0xAB, 0x71, 0xC7, 0x60, 0xE7, 0x69, 0x5C, 0xA7, 0xB5,
		0x6D, 0x4A, 0x56, 0x07, 0x33, 0xF3, 0x6C, 0x8E, 0x3C, 0xA5, 0x6B, 0x4B, 0x04, 0x81, 0xA7, 0xC1,
		0x04, 0xFB, 0x8E, 0x72, 0x34, 0xE9, 0x7B, 0x31, 0x7F, 0xA3, 0x9F, 0x5A, 0xA4, 0x1A, 0x67, 0xEF,
		0x0E, 0xBB, 0x52, 0xCA, 0x68, 0x68, 0xC9, 0x3A, 0xE8, 0xDC, 0x42, 0xF0, 0x36, 0x98, 0x4E, 0x14,
		0xE7, 0xD0, 0x6A, 0x74, 0x93, 0xD8, 0x58, 0x45, 0x80, 0x81, 0xA5, 0xC5, 0x36, 0x33, 0x2E, 0x6F,
		0xCA, 0x66, 0x8F, 0xEF, 0x9A, 0x94, 0xD6, 0xE5, 0xB9, 0xCA, 0xDC, 0x77, 0x85, 0x42, 0x4F, 0x56,
		0x94, 0xFD, 0x61, 0x33, 0x04, 0x30, 0xA9, 0x31, 0x9D, 0x5A, 0x0A, 0xAF, 0x7E, 0x43, 0xD2, 0xA0,
		0xAD, 0xB4, 0x42, 0x13, 0x68, 0x09, 0x49, 0x4A, 0x07, 0x36, 0x0C, 0x01, 0xCD, 0x3F, 0xB0, 0x1F,
		0x8C, 0xF7, 0x68, 0x9D, 0xD7, 0xD9, 0x5A, 0x9F, 0x03, 0x66, 0x85, 0xE1, 0x18, 0xF4, 0x61, 0xB9,
		0xE6, 0xFF, 0x91, 0xD2, 0x67, 0x78, 0x05, 0xA3, 0x6A, 0x51, 0x7D, 0x82, 0xBE, 0xD7, 0x3F, 0xDB,
		0x39, 0x62, 0x54, 0xBD, 0x62, 0xB2, 0x0C, 0x24, 0x49, 0xBF, 0xC8, 0x66, 0xCE, 0x22, 0xC0, 0xFA,
		0xA3, 0xFE, 0x71, 0x11, 0xA9, 0x2B, 0xCF, 0xC1, 0x58, 0xFF, 0xAB, 0x12, 0xC7, 0x35, 0x4C, 0x3B,
		0x6E, 0x8D, 0xA5, 0xB3, 0x04, 0x19, 0x46, 0xC0, 0xB6, 0xF8, 0x5A, 0x3A, 0xA8, 0xCB, 0x30, 0x92,
		0xAC, 0x17, 0x3A, 0x94, 0xAB, 0x9C, 0xA4, 0xF5, 0x41, 0xD1, 0x8E, 0x76, 0x8A, 0x0E, 0xBA, 0xA8,
		0xB4, 0xFB, 0x59, 0xCA, 0x52, 0x4D, 0x70, 0xC0, 0x83, 0xA4, 0x8D, 0xF5, 0x4E, 0xE1, 0x72, 0x73,
		0x9D, 0x99, 0x2B, 0x98, 0xCA, 0x5B, 0x95, 0xF1, 0x07, 0x2C, 0xB4, 0x56, 0x69, 0x59, 0x98, 0xA1
	};
	unsigned char	HDQ_p[CI_HDQ_P_LEN] = // from 0A0BF75306A286DD-key.der
	{
		0xF4, 0x3A, 0x03, 0x74, 0x89, 0x84, 0xDB, 0x5D, 0x1F, 0x17, 0xB5, 0x07, 0x29, 0x80, 0x3E, 0x16,
		0xFB, 0x42, 0xBC, 0xCC, 0x95, 0x7C, 0x8C, 0x72, 0x02, 0xBF, 0xE5, 0xE4, 0x21, 0xFA, 0x60, 0xF2,
		0x64, 0x7B, 0x6F, 0xEB, 0x1F, 0xD6, 0xD1, 0xDB, 0x7D, 0xB7, 0xF5, 0x3A, 0x8C, 0xAD, 0x94, 0xF4,
		0x20, 0xB8, 0xC4, 0x17, 0x2B, 0xF3, 0xC9, 0x68, 0x67, 0x3A, 0x50, 0x81, 0x9F, 0x9D, 0xA0, 0x88,
		0x5D, 0x30, 0x41, 0xD7, 0x90, 0xB4, 0xD5, 0x77, 0x42, 0x35, 0x67, 0xF5, 0xE7, 0xB5, 0xDC, 0x61,
		0x7A, 0x72, 0x0C, 0x21, 0xE6, 0x7D, 0x64, 0xB3, 0x69, 0xB8, 0x19, 0x7D, 0x3F, 0xFC, 0xC8, 0x3C,
		0xC2, 0x3C, 0x59, 0x5B, 0xE9, 0x68, 0x2A, 0x11, 0x25, 0x53, 0x4F, 0x30, 0x70, 0xE7, 0x0B, 0xBA,
		0x87, 0xF4, 0x45, 0xD0, 0xAF, 0x33, 0x69, 0x82, 0xB7, 0xE9, 0x28, 0x54, 0x93, 0xBA, 0x40, 0xDD
	};
	unsigned char	HDQ_q[CI_HDQ_Q_LEN] = // from 0A0BF75306A286DD-key.der
	{
		0xD0, 0xEA, 0x6C, 0x7E, 0xA0, 0xEF, 0x7E, 0xCA, 0xC1, 0x00, 0xED, 0xA2, 0x2F, 0x3C, 0xE7, 0x6A,
		0x43, 0x45, 0x6E, 0xF7, 0xE3, 0xEF, 0xEC, 0x46, 0x35, 0x9D, 0xCE, 0x20, 0x0D, 0x9B, 0x1D, 0xA2,
		0xC8, 0xE6, 0xEA, 0x7E, 0x45, 0x2B, 0x96, 0x76, 0x31, 0x0B, 0x83, 0x3E, 0x6C, 0x4A, 0xFB, 0x48,
		0x41, 0xE2, 0x18, 0x31, 0xEB, 0x81, 0x3A, 0x23, 0x6C, 0xB7, 0xFA, 0xCF, 0x4A, 0x07, 0xC8, 0x9F,
		0xEE, 0xCB, 0x0C, 0xCE, 0x32, 0xD0, 0xE3, 0x72, 0xE8, 0x43, 0x88, 0xB5, 0x3D, 0xFF, 0x52, 0xFF,
		0x8B, 0x6E, 0x22, 0x55, 0xEE, 0xC8, 0xC0, 0x55, 0x9A, 0x86, 0x3C, 0x1F, 0x44, 0xAE, 0x13, 0xFE,
		0xA9, 0xFE, 0x89, 0xB7, 0x19, 0xF6, 0x97, 0x31, 0x5E, 0x1E, 0xA5, 0x18, 0x40, 0x77, 0x44, 0x98,
		0x0F, 0xA1, 0x5E, 0x02, 0xDF, 0x9F, 0x68, 0x28, 0x73, 0x86, 0x21, 0x69, 0xB4, 0x7E, 0xC1, 0x6B
	};
	unsigned char	HDQ_dP[CI_HDQ_DP_LEN] = // from 0A0BF75306A286DD-key.der
	{
		0xBE, 0x10, 0xA3, 0xFD, 0xBE, 0xC4, 0x39, 0x5F, 0xB8, 0x41, 0xDF, 0xED, 0x69, 0xFB, 0xD6, 0xD6,
		0x55, 0xC6, 0x73, 0x5E, 0x17, 0xFC, 0x2C, 0xE4, 0xD1, 0x84, 0xFC, 0x69, 0x55, 0x94, 0x20, 0x7C,
		0xA3, 0x7C, 0x78, 0xF6, 0x17, 0xFA, 0x3B, 0xA9, 0xC0, 0xA6, 0x38, 0x5F, 0xCF, 0x79, 0x8B, 0x51,
		0x8E, 0x61, 0x9C, 0xA1, 0x97, 0xE0, 0x0A, 0xDF, 0x88, 0x6E, 0x96, 0x96, 0xBA, 0x5C, 0x96, 0xC1,
		0x69, 0x1C, 0x94, 0x31, 0x29, 0xF9, 0xC1, 0xA3, 0x25, 0x50, 0xA0, 0xCE, 0x7B, 0xFC, 0x49, 0x3D,
		0x47, 0x68, 0x98, 0x4E, 0x8D, 0xAD, 0x0A, 0x80, 0xA2, 0x06, 0xD7, 0x37, 0x65, 0x63, 0xD9, 0x85,
		0x87, 0x78, 0x25, 0xE6, 0xE4, 0xB7, 0xDE, 0xFD, 0x26, 0xFA, 0x35, 0xC7, 0xB2, 0x25, 0xED, 0x37,
		0xC6, 0x74, 0x71, 0x1C, 0xDE, 0x2C, 0x79, 0xB1, 0x74, 0x65, 0x2C, 0xB0, 0xDD, 0xA2, 0xF6, 0xB5
	};
	unsigned char	HDQ_dQ[CI_HDQ_DQ_LEN] = // from 0A0BF75306A286DD-key.der
	{
		0x0E, 0x08, 0x50, 0xF5, 0x48, 0x76, 0x0D, 0xBC, 0x2C, 0xAE, 0x95, 0x47, 0x99, 0x88, 0xAB, 0xBA,
		0x95, 0x7E, 0x2A, 0x6F, 0xF8, 0x1D, 0x7B, 0x6F, 0x53, 0xD6, 0x9F, 0xAB, 0xC3, 0x7E, 0x31, 0xC5,
		0x67, 0x5D, 0x2B, 0x4F, 0x03, 0xF2, 0x63, 0x8E, 0xD8, 0xC8, 0x7F, 0x2E, 0x48, 0x33, 0xD9, 0x21,
		0x07, 0x5B, 0xDA, 0x68, 0x2F, 0xFB, 0x64, 0x1E, 0x51, 0x05, 0x22, 0x91, 0x9D, 0xD5, 0x5C, 0x02,
		0x72, 0x15, 0xAD, 0x6C, 0x84, 0x39, 0x47, 0xAD, 0xC6, 0x30, 0x13, 0x14, 0xA9, 0x6F, 0x66, 0xF1,
		0xC7, 0x39, 0xC4, 0x90, 0xA5, 0x13, 0x52, 0xE7, 0xED, 0x13, 0x2B, 0x22, 0xA6, 0x88, 0x52, 0xCB,
		0x7E, 0x3B, 0x9C, 0xA0, 0x71, 0xDC, 0x00, 0x57, 0xCE, 0x8C, 0x9C, 0x66, 0x3E, 0x9E, 0x44, 0x3B,
		0x3A, 0x81, 0x8A, 0x41, 0x03, 0x28, 0x3F, 0xE4, 0xC7, 0xAD, 0xB0, 0xBC, 0xDA, 0xE4, 0xD0, 0xB5
	};
	unsigned char	HDQ_qInv[CI_HDQ_QINV_LEN] = // from 0A0BF75306A286DD-key.der
	{
		0x2F, 0x3F, 0x6C, 0x9C, 0x76, 0xCB, 0x2D, 0x9C, 0x3C, 0xE5, 0x1A, 0x3B, 0x80, 0x27, 0x62, 0xED,
		0x45, 0x18, 0x55, 0x52, 0x0D, 0x4A, 0xE5, 0xCC, 0x1A, 0x78, 0xC8, 0x9E, 0x3F, 0x14, 0x27, 0xEB,
		0xD3, 0x2F, 0x67, 0xB8, 0x57, 0x45, 0xFA, 0xC1, 0xD2, 0x3D, 0x6B, 0xAD, 0x5C, 0x9B, 0x7F, 0xAE,
		0x27, 0x1E, 0xD0, 0x58, 0x06, 0xFF, 0xAA, 0xD6, 0xBB, 0xC8, 0x0E, 0x11, 0xD9, 0x4B, 0x9F, 0x25,
		0x5E, 0x1B, 0x01, 0x70, 0x55, 0x80, 0x18, 0x1D, 0x55, 0x76, 0x33, 0x4E, 0x25, 0x2B, 0x86, 0x03,
		0x44, 0xD9, 0xEE, 0xDF, 0x73, 0x6E, 0xE3, 0x2D, 0xC9, 0x87, 0xE9, 0x2E, 0x65, 0x67, 0xE9, 0x7E,
		0x81, 0x1B, 0x30, 0xD9, 0x42, 0x92, 0xCE, 0xC4, 0xDC, 0xED, 0xD1, 0x64, 0xB4, 0x41, 0x21, 0xF4,
		0xBC, 0x0D, 0x66, 0x7F, 0xC0, 0xC2, 0xD6, 0x31, 0x5F, 0xEA, 0xEE, 0x03, 0xAA, 0xF8, 0x0A, 0x55
	};
	unsigned char	PRNG_seed[16]	= {0xe7, 0xf1, 0xdd, 0x16, 0x56, 0x85, 0xa5, 0x70, 0xc6, 0x73, 0xec, 0x8c, 0x3c, 0xd1, 0xc5, 0xb2}; // from Credentials 문서
	unsigned char	SLK[16]			= {0xea, 0x74, 0xf4, 0x71, 0x99, 0xd7, 0x6f, 0x35, 0x89, 0xf0, 0xd1, 0xdf, 0x0f, 0xee, 0xe3, 0x00}; // from Credentials 문서
	unsigned char	SIV[16]			= {0xf7, 0x70, 0xb0, 0x36, 0x03, 0x61, 0xf7, 0x96, 0x65, 0x74, 0x8a, 0x26, 0xea, 0x4e, 0x85, 0x41}; // from Credentials 문서
	unsigned char	CLK[16]			= {0x3e, 0x20, 0x15, 0x84, 0x2c, 0x37, 0xce, 0xe3, 0xd6, 0x14, 0x57, 0x3e, 0x3a, 0xab, 0x91, 0xb6}; // from Credentials 문서

	VK_memset(&stCiHostLicenseConst, 0x00, sizeof(CI_HOST_LICENSE_CONST));

	stCiHostLicenseConst.RootCertLen = CI_ROOT_CERT_LEN;
	VK_memcpy(stCiHostLicenseConst.RootCert, RootCert, stCiHostLicenseConst.RootCertLen);

	stCiHostLicenseConst.Host_BrandCertLen = CI_HOST_BRAND_CERT_LEN;
	VK_memcpy(stCiHostLicenseConst.Host_BrandCert, Host_BrandCert, stCiHostLicenseConst.Host_BrandCertLen);

	stCiHostLicenseConst.Host_DevCertLen = CI_HOST_DEV_CERT_LEN;
	VK_memcpy(stCiHostLicenseConst.Host_DevCert, Host_DevCert, stCiHostLicenseConst.Host_DevCertLen);

	VK_memcpy(stCiHostLicenseConst.DH_p, DH_p, CI_DH_P_LEN);
	VK_memcpy(stCiHostLicenseConst.DH_g, DH_g, CI_DH_G_LEN);
	VK_memcpy(stCiHostLicenseConst.DH_q, DH_q, CI_DH_Q_LEN);

	VK_memcpy(stCiHostLicenseConst.HDQ_d, HDQ_d, CI_HDQ_D_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_p, HDQ_p, CI_HDQ_P_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_q, HDQ_q, CI_HDQ_Q_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_dP, HDQ_dP, CI_HDQ_DP_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_dQ, HDQ_dQ, CI_HDQ_DQ_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_qInv, HDQ_qInv, CI_HDQ_QINV_LEN);

	VK_memcpy(stCiHostLicenseConst.PRNG_seed, PRNG_seed, 16);
	VK_memcpy(stCiHostLicenseConst.SLK, SLK, 16);
	VK_memcpy(stCiHostLicenseConst.SIV, SIV, 16);
	VK_memcpy(stCiHostLicenseConst.CLK, CLK, 16);

	// Host_ID, Host_CckCipher, HDQ_n (from 디바이스 인증서)
	{
		Certificate_t * pstDevCertData = NULL;
		int nScramblerCapabilities, len;

		pstDevCertData = X509_ParseRawCert(Host_DevCert, CI_HOST_DEV_CERT_LEN);
		if (pstDevCertData == NULL)
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Invalid DevCert !!!\n"));
			return -1;
		}

		// get Host_ID
		if (FALSE == GetDeviceID(pstDevCertData, stCiHostLicenseConst.Host_ID))
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetDeviceID() !!!\n"));
			return -1;
		}

		// get Host_CckCipher
		if (FALSE == GetScramblerCapabilities(pstDevCertData, &nScramblerCapabilities))
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetScramblerCapabilities() !!!\n"));
			return -1;
		}
		if (nScramblerCapabilities == 0 || nScramblerCapabilities == 1)
		{
			stCiHostLicenseConst.Host_CckCipher = nScramblerCapabilities;
		}
		else // unknown value (reserved for future use) -> CI+ 스펙 1.2 기준에서 정의되지 않은 값일 경우엔 일단 CI_CC_KEY_CIPHER_DES_56_ECB 로 설정하도록 하자...
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetScramblerCapabilities()---> unknown value %d !!!\n", nScramblerCapabilities));
			stCiHostLicenseConst.Host_CckCipher = CI_CC_KEY_CIPHER_DES_56_ECB;
		}

		// get HDQ_n
		if (FALSE == GetRSAPublicKey_N(pstDevCertData, stCiHostLicenseConst.HDQ_n, &len))
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetRSAPublicKey_N() !!!\n"));
			return -1;
		}
		if (len != CI_HDQ_N_LEN)
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetRSAPublicKey_N()---> invalid len %d !!!\n", len));
			return -1;
		}
	}

	// HDQ_n (from 키 인증서), HDQ_d, HDQ_p, HDQ_q, HDQ_dP, HDQ_dQ, HDQ_qInv
	{
		// PC 프로그램의 경우, 해당 호스트 디바이스 인증서와 매칭되는 키 인증서로부터 유도.
		// 특히, HDQ_n 의 경우엔 위의 디바이스 인증서로 유도한 값과 키 인증서로부터 유도한 값이 서로 같은지 확인해야 한다.
	}

	// DHH, DHPH
	{
		bignum bn_DH_g, bn_DHH, bn_DH_p, bn_DHPH;
		int i;

		// generate a random nonce : DHH[256] -> DHH[0..15], DHH[16..31], ... , DHH[240..255] -> PRNG(&DHH[]) 16번 처리 -> concatenated to 256 bytes -> OK?
		for (i = 0; i < 256; i += CI_CC_CIPHER_BLOCK_SIZE)
			PRNG(PRNG_seed, &stCiHostLicenseConst.DHH[i]);

		// compute DHPH
		bn_init(&bn_DH_g, DH_g, CI_DH_G_LEN);
		bn_init(&bn_DHH, stCiHostLicenseConst.DHH, 256);
		bn_init(&bn_DH_p, DH_p, CI_DH_P_LEN);
		bn_mod_exp(&bn_DH_g, &bn_DHH, &bn_DH_p, &bn_DHPH);
		if (bn_DHPH.len != 256)
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Invalid DHPH len (%d) !!!\n", bn_DHPH.len));
			return -1;
		}

		// The host checks that the computed key DHPH is of valid length and value : if 1 < DHPH < DH_p and DHPH ^ DH_q mod DH_p = 1
		{
			bignum bn_DH_q, out;
			if (bn_cmp(&bn_one, &bn_DHPH) >= 0)
			{
				PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : DHPH not bigger than 1 !!!\n"));
				return -1;
			}
			if (bn_cmp(&bn_DHPH, &bn_DH_p) >= 0)
			{
				PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : DHPH not less than DH_p !!!\n"));
				return -1;
			}
			bn_init(&bn_DH_q, DH_q, CI_DH_Q_LEN);
			bn_mod_exp(&bn_DHPH, &bn_DH_q, &bn_DH_p, &out);
			if (bn_cmp(&out, &bn_one) != 0)
			{
				PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : DHPH ^ DH_q mod DH_p not 1 !!!\n"));
				return -1;
			}
		}

		VK_memcpy(stCiHostLicenseConst.DHPH, bn_DHPH.num, bn_DHPH.len);
	}

	stCiHostLicenseConst.ucSavedFlag = 2;

	SHA_256((unsigned char *)&stCiHostLicenseConst, usOrgLen-32, stCiHostLicenseConst.ucDigest);

	P = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);
	C = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);

	VK_memcpy(P, &stCiHostLicenseConst, usOrgLen);
	OneAndZeroesPadding(P, usOrgLen);
	E_AES_CBC(K, P, C, usAlignedLen, IV);

	fpBinaryFile = fopen(CI_HOST_LICENSE_CONST_FILE, "wb");
	if (fpBinaryFile == NULL)
	{
		PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Can't open file !!!\n"));
		CA_MEM_Free(P);
		CA_MEM_Free(C);
		return -1;
	}

	nDataSize = fwrite(C, 1, usAlignedLen, fpBinaryFile);
	fclose(fpBinaryFile);

	if (nDataSize != usAlignedLen)
	{
		PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Can't write data !!!\n"));
		CA_MEM_Free(P);
		CA_MEM_Free(C);
		return -1;
	}

	sync();

	CA_MEM_Free(P);
	CA_MEM_Free(C);

	return ERR_OK;
}
#endif // CI_PLUS_PRODUCTION_Credentials

#ifdef CI_PLUS_TEST_Technology_from_TrustCenter
// save CI+ host license constants data to non-volatile memory and return -1 if there is any error (데이터 무결성 및 보안을 위해 데이터들은 SHA-256 으로 hashing 되고 AES-128-CBC 로 암호화된다)
int CI_SaveHostLicenseConstantsForTestKitOnly (void)
{
	CI_HOST_LICENSE_CONST stCiHostLicenseConst;

	unsigned short usOrgLen = sizeof(CI_HOST_LICENSE_CONST), usAlignedLen = GetAlignedLen(usOrgLen);
	unsigned char *P = NULL, *C = NULL;

	FILE *fpBinaryFile = NULL;
	int nDataSize = 0;

	unsigned char	RootCert[CI_MAX_CERT_LEN] = // from ciplus_test_root.crt -> cer
	{
		0x30, 0x82, 0x03, 0xE6, 0x30, 0x82, 0x02, 0xCE, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x0F, 0x00,
		0x91, 0x30, 0x00, 0x00, 0x2C, 0xFE, 0xA5, 0x00, 0x9E, 0x5C, 0x90, 0x0F, 0x05, 0x88, 0x30, 0x0D,
		0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x00, 0x30, 0x81, 0x8B,
		0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x4B, 0x31, 0x0F, 0x30,
		0x0D, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64, 0x6F, 0x6E, 0x31, 0x0F,
		0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64, 0x6F, 0x6E, 0x31,
		0x14, 0x30, 0x12, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0B, 0x43, 0x49, 0x20, 0x50, 0x6C, 0x75,
		0x73, 0x20, 0x4C, 0x4C, 0x50, 0x31, 0x0F, 0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x06,
		0x45, 0x75, 0x72, 0x6F, 0x70, 0x65, 0x31, 0x0D, 0x30, 0x0B, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13,
		0x04, 0x74, 0x65, 0x73, 0x74, 0x31, 0x24, 0x30, 0x22, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x1B,
		0x43, 0x49, 0x20, 0x50, 0x6C, 0x75, 0x73, 0x20, 0x52, 0x6F, 0x6F, 0x74, 0x20, 0x43, 0x41, 0x20,
		0x63, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x65, 0x30, 0x1E, 0x17, 0x0D, 0x30,
		0x38, 0x31, 0x31, 0x32, 0x30, 0x31, 0x35, 0x35, 0x35, 0x34, 0x31, 0x5A, 0x17, 0x0D, 0x39, 0x39,
		0x31, 0x32, 0x33, 0x31, 0x32, 0x33, 0x35, 0x39, 0x35, 0x39, 0x5A, 0x30, 0x81, 0x8B, 0x31, 0x0B,
		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x4B, 0x31, 0x0F, 0x30, 0x0D, 0x06,
		0x03, 0x55, 0x04, 0x08, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64, 0x6F, 0x6E, 0x31, 0x0F, 0x30, 0x0D,
		0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64, 0x6F, 0x6E, 0x31, 0x14, 0x30,
		0x12, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0B, 0x43, 0x49, 0x20, 0x50, 0x6C, 0x75, 0x73, 0x20,
		0x4C, 0x4C, 0x50, 0x31, 0x0F, 0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x06, 0x45, 0x75,
		0x72, 0x6F, 0x70, 0x65, 0x31, 0x0D, 0x30, 0x0B, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x04, 0x74,
		0x65, 0x73, 0x74, 0x31, 0x24, 0x30, 0x22, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x1B, 0x43, 0x49,
		0x20, 0x50, 0x6C, 0x75, 0x73, 0x20, 0x52, 0x6F, 0x6F, 0x74, 0x20, 0x43, 0x41, 0x20, 0x63, 0x65,
		0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x65, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0D, 0x06,
		0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0F,
		0x00, 0x30, 0x82, 0x01, 0x0A, 0x02, 0x82, 0x01, 0x01, 0x00, 0xC7, 0xBE, 0xC4, 0x55, 0x4B, 0xA3,
		0xE3, 0x85, 0xAC, 0xFF, 0x51, 0xA4, 0xA9, 0x42, 0xF4, 0x4B, 0x03, 0x5B, 0x04, 0x52, 0x67, 0x3E,
		0x85, 0x43, 0xDF, 0x86, 0xC0, 0x4A, 0xAD, 0x92, 0x13, 0x7D, 0xB6, 0x2F, 0xAC, 0xC4, 0x0A, 0xE2,
		0xF1, 0x16, 0xA3, 0xC4, 0x50, 0xE9, 0xE3, 0xFE, 0x9F, 0xD9, 0x8D, 0x96, 0x2A, 0x52, 0x67, 0x3A,
		0xD6, 0x4E, 0x4F, 0xFE, 0xA6, 0xD4, 0xBF, 0x1C, 0x6E, 0x28, 0x3A, 0xCB, 0x96, 0x03, 0xAE, 0x48,
		0x6F, 0x8A, 0x80, 0x3B, 0x84, 0x1F, 0xD7, 0x93, 0x03, 0x78, 0xAE, 0x8D, 0x06, 0xDE, 0x53, 0xFF,
		0x3D, 0xE1, 0x64, 0x8E, 0x31, 0xB7, 0xD9, 0x13, 0x45, 0xEB, 0xD7, 0xC8, 0x55, 0xE8, 0x3F, 0x0F,
		0x45, 0x07, 0x00, 0x7B, 0xF5, 0x2C, 0x01, 0xAB, 0x3E, 0x15, 0xEF, 0x05, 0x19, 0x25, 0x50, 0x51,
		0x14, 0x66, 0x8D, 0xEE, 0x83, 0x9C, 0x14, 0xB8, 0x7C, 0x79, 0x0F, 0x69, 0xF4, 0x84, 0x63, 0xBD,
		0xFB, 0xBB, 0x77, 0xB7, 0xA9, 0xCF, 0x50, 0x86, 0x50, 0x85, 0x7D, 0x84, 0x26, 0x68, 0x43, 0xBC,
		0x3B, 0xB1, 0xBB, 0xF0, 0xF5, 0xFC, 0x3C, 0x70, 0x77, 0xE2, 0x25, 0x98, 0xC8, 0x59, 0xA2, 0x0B,
		0xE5, 0x27, 0x98, 0x05, 0xEA, 0x0D, 0x22, 0xD5, 0x5F, 0xF9, 0x7C, 0x33, 0x26, 0x70, 0x4E, 0x6B,
		0x5C, 0xB4, 0x3C, 0x35, 0x41, 0x88, 0xD3, 0x78, 0xA9, 0x8B, 0xDD, 0x1B, 0xAD, 0xEA, 0xEE, 0x02,
		0xFC, 0xE5, 0x55, 0x98, 0x48, 0x09, 0xF1, 0x0D, 0x49, 0x37, 0x07, 0xE8, 0xF5, 0xBD, 0x80, 0x02,
		0x0B, 0xB3, 0x66, 0x4F, 0x1A, 0x20, 0x11, 0x80, 0xE1, 0x36, 0x39, 0xC6, 0x3B, 0xCA, 0x1A, 0x71,
		0x3E, 0x45, 0x89, 0xB9, 0xCB, 0x07, 0x96, 0x70, 0x29, 0xE0, 0x43, 0x2A, 0xFF, 0x42, 0xAF, 0x56,
		0xF7, 0xCF, 0xCC, 0xDF, 0x21, 0x3F, 0x78, 0x16, 0x49, 0xB9, 0x02, 0x03, 0x01, 0x00, 0x01, 0xA3,
		0x45, 0x30, 0x43, 0x30, 0x12, 0x06, 0x03, 0x55, 0x1D, 0x13, 0x01, 0x01, 0xFF, 0x04, 0x08, 0x30,
		0x06, 0x01, 0x01, 0xFF, 0x02, 0x01, 0x01, 0x30, 0x0E, 0x06, 0x03, 0x55, 0x1D, 0x0F, 0x01, 0x01,
		0xFF, 0x04, 0x04, 0x03, 0x02, 0x01, 0x06, 0x30, 0x1D, 0x06, 0x03, 0x55, 0x1D, 0x0E, 0x04, 0x16,
		0x04, 0x14, 0x9E, 0xC2, 0xED, 0x0A, 0x3B, 0xAF, 0xDB, 0x6A, 0x07, 0x5B, 0x12, 0x19, 0x7B, 0x28,
		0x58, 0x14, 0x21, 0xCC, 0x94, 0x99, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D,
		0x01, 0x01, 0x0A, 0x30, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00, 0x0A, 0xF5, 0xCD, 0x8C, 0x96, 0x8A,
		0x34, 0x54, 0xB2, 0x99, 0x8B, 0xF0, 0x51, 0x1C, 0xC3, 0xC1, 0x72, 0x92, 0x20, 0x24, 0xBF, 0x55,
		0x1B, 0xED, 0x84, 0x95, 0x65, 0xF8, 0x7F, 0x22, 0xA5, 0x30, 0xBB, 0xBF, 0x4F, 0x34, 0xAB, 0x18,
		0x6A, 0xF5, 0x9D, 0xF8, 0xD0, 0xFF, 0xBF, 0x39, 0x29, 0x8B, 0x53, 0xDF, 0x69, 0x7A, 0x50, 0x78,
		0x14, 0x38, 0x2E, 0xB7, 0xF9, 0xC6, 0x65, 0x9E, 0xE9, 0x0C, 0x09, 0x46, 0xEC, 0x83, 0xFF, 0xEC,
		0xE4, 0xD7, 0x71, 0x92, 0x2F, 0xBD, 0xB1, 0xE3, 0x51, 0xDA, 0xB9, 0x23, 0x12, 0x70, 0xC6, 0x18,
		0xD0, 0x2A, 0xF8, 0x5E, 0x45, 0x70, 0x30, 0xC3, 0x6F, 0xF6, 0xB3, 0xAF, 0x12, 0x32, 0xDD, 0x2E,
		0xA4, 0xE9, 0xCC, 0xD9, 0x38, 0x6F, 0xCC, 0x7F, 0xA0, 0x34, 0x38, 0xE4, 0x50, 0xF9, 0xA5, 0xD1,
		0xB5, 0xFE, 0xD7, 0x0B, 0xDB, 0xA3, 0x3C, 0x09, 0x59, 0x81, 0x31, 0x93, 0x34, 0xD3, 0xAC, 0x2A,
		0x8A, 0xFA, 0x35, 0x15, 0xAB, 0x8B, 0x68, 0xEF, 0x4D, 0x72, 0x7C, 0x35, 0x94, 0xC9, 0x08, 0x41,
		0x9A, 0x56, 0xBA, 0xFB, 0xD1, 0xD1, 0xC0, 0x64, 0x36, 0xFA, 0x50, 0xD8, 0x62, 0x6D, 0xB4, 0xB6,
		0xCE, 0xA3, 0x08, 0xDE, 0x4D, 0x9F, 0x08, 0x0E, 0xC7, 0xB5, 0xD3, 0x88, 0x70, 0x7D, 0x26, 0x47,
		0x49, 0xFA, 0xEB, 0x8E, 0x77, 0x6D, 0xCA, 0xED, 0xED, 0xE4, 0x56, 0x9E, 0xBF, 0x43, 0x14, 0x4F,
		0x2A, 0xDC, 0x1B, 0x72, 0x13, 0xE6, 0x8E, 0xB8, 0x7C, 0x59, 0xB0, 0x60, 0xDE, 0x5B, 0x88, 0x0D,
		0x4A, 0x7E, 0xBA, 0xAA, 0x05, 0x5F, 0x72, 0x8B, 0x4A, 0x37, 0x37, 0x43, 0x76, 0x8D, 0xFF, 0x89,
		0x94, 0xB3, 0x04, 0xF7, 0x88, 0x6B, 0xA4, 0x2F, 0xC9, 0x34, 0x86, 0xCA, 0xB5, 0x9C, 0x99, 0x44,
		0xFB, 0xE8, 0x25, 0x1B, 0x1B, 0x7C, 0xDD, 0x5E, 0x21, 0xDE
	};
	unsigned char	Host_BrandCert[CI_MAX_CERT_LEN] = // from ciplus_test_ca.crt -> cer
	{
		0x30, 0x82, 0x03, 0xEC, 0x30, 0x82, 0x02, 0xD4, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x0E, 0x36,
		0xE5, 0x00, 0x00, 0x2C, 0xFE, 0xD1, 0x82, 0x03, 0x0A, 0xE6, 0xFB, 0xE8, 0x0B, 0x30, 0x0D, 0x06,
		0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x00, 0x30, 0x81, 0x8B, 0x31,
		0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x4B, 0x31, 0x0F, 0x30, 0x0D,
		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64, 0x6F, 0x6E, 0x31, 0x0F, 0x30,
		0x0D, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x06, 0x4C, 0x6F, 0x6E, 0x64, 0x6F, 0x6E, 0x31, 0x14,
		0x30, 0x12, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0B, 0x43, 0x49, 0x20, 0x50, 0x6C, 0x75, 0x73,
		0x20, 0x4C, 0x4C, 0x50, 0x31, 0x0F, 0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x06, 0x45,
		0x75, 0x72, 0x6F, 0x70, 0x65, 0x31, 0x0D, 0x30, 0x0B, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x04,
		0x74, 0x65, 0x73, 0x74, 0x31, 0x24, 0x30, 0x22, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x1B, 0x43,
		0x49, 0x20, 0x50, 0x6C, 0x75, 0x73, 0x20, 0x52, 0x6F, 0x6F, 0x74, 0x20, 0x43, 0x41, 0x20, 0x63,
		0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x65, 0x30, 0x1E, 0x17, 0x0D, 0x30, 0x38,
		0x31, 0x31, 0x32, 0x30, 0x31, 0x36, 0x30, 0x31, 0x32, 0x33, 0x5A, 0x17, 0x0D, 0x39, 0x39, 0x31,
		0x32, 0x33, 0x31, 0x32, 0x33, 0x35, 0x39, 0x30, 0x30, 0x5A, 0x30, 0x72, 0x31, 0x0B, 0x30, 0x09,
		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x44, 0x45, 0x31, 0x10, 0x30, 0x0E, 0x06, 0x03, 0x55,
		0x04, 0x08, 0x13, 0x07, 0x48, 0x61, 0x6D, 0x62, 0x75, 0x72, 0x67, 0x31, 0x10, 0x30, 0x0E, 0x06,
		0x03, 0x55, 0x04, 0x07, 0x13, 0x07, 0x48, 0x61, 0x6D, 0x62, 0x75, 0x72, 0x67, 0x31, 0x13, 0x30,
		0x11, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0A, 0x54, 0x65, 0x73, 0x74, 0x20, 0x53, 0x75, 0x62,
		0x43, 0x41, 0x31, 0x0D, 0x30, 0x0B, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x04, 0x74, 0x65, 0x73,
		0x74, 0x31, 0x1B, 0x30, 0x19, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x12, 0x43, 0x49, 0x20, 0x50,
		0x6C, 0x75, 0x73, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x53, 0x75, 0x62, 0x43, 0x41, 0x30, 0x82,
		0x01, 0x22, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05,
		0x00, 0x03, 0x82, 0x01, 0x0F, 0x00, 0x30, 0x82, 0x01, 0x0A, 0x02, 0x82, 0x01, 0x01, 0x00, 0xE1,
		0xFA, 0xAE, 0x00, 0xE1, 0x45, 0x39, 0x6F, 0xE0, 0x7B, 0xAD, 0x11, 0x07, 0x10, 0xC0, 0x23, 0x52,
		0x55, 0xC9, 0xD4, 0xEA, 0xAE, 0x13, 0x11, 0xF8, 0x7E, 0x7C, 0x43, 0x5A, 0x40, 0x41, 0xD8, 0x75,
		0x1D, 0x66, 0x5F, 0x08, 0x0B, 0x5C, 0x23, 0x52, 0x90, 0x7F, 0x51, 0xCC, 0x64, 0x6A, 0x6F, 0x9A,
		0xCE, 0xC1, 0x42, 0x5F, 0x65, 0x33, 0x6A, 0x4C, 0x8D, 0x31, 0xAC, 0x72, 0xE1, 0x45, 0x97, 0x12,
		0x55, 0xC2, 0xF2, 0x83, 0x8B, 0xBB, 0x92, 0xFB, 0x0B, 0x91, 0xAD, 0xEC, 0xEE, 0x6C, 0x66, 0x93,
		0xF0, 0x3F, 0xA6, 0x3C, 0xF5, 0x1B, 0x73, 0xB0, 0x4B, 0xA4, 0xEA, 0x76, 0xF1, 0x0B, 0xFB, 0x8E,
		0xC3, 0xFE, 0x65, 0xDB, 0x62, 0xA3, 0xC0, 0x52, 0x21, 0x14, 0x4E, 0x31, 0x2C, 0xD4, 0x6E, 0x1A,
		0xCB, 0x7C, 0xAE, 0xE9, 0xC8, 0x79, 0x28, 0xD0, 0x56, 0xE7, 0x42, 0x2C, 0x50, 0x61, 0xDC, 0x89,
		0x51, 0x9A, 0xDF, 0xC3, 0x9A, 0xC6, 0x3F, 0x86, 0xE9, 0x65, 0xC7, 0x14, 0xCC, 0x39, 0x3A, 0x59,
		0xA9, 0x35, 0xD6, 0xD9, 0x62, 0x41, 0x44, 0x68, 0x06, 0x9D, 0x95, 0x79, 0x76, 0x43, 0xB8, 0xC1,
		0x60, 0x94, 0xCE, 0x01, 0x83, 0x6D, 0x1E, 0xE2, 0x6A, 0xEC, 0x3A, 0xEE, 0xAB, 0x53, 0xFF, 0xD9,
		0xFF, 0x44, 0x2F, 0x24, 0x0E, 0x22, 0x2F, 0xCE, 0xD3, 0x04, 0xCF, 0x90, 0x38, 0x4E, 0x3D, 0xD5,
		0x54, 0x05, 0x5B, 0x97, 0x28, 0x21, 0x71, 0x51, 0xE8, 0x33, 0x7B, 0x4F, 0x5A, 0x4A, 0xD4, 0x54,
		0x45, 0x4C, 0x5E, 0x4B, 0x51, 0x8F, 0xB7, 0x1B, 0xCE, 0x9E, 0x44, 0x4B, 0xB6, 0x14, 0xB5, 0x61,
		0x1C, 0x27, 0x8D, 0x24, 0x51, 0xC9, 0x48, 0x30, 0x24, 0x43, 0x38, 0xB0, 0x50, 0x93, 0x73, 0x93,
		0xED, 0x87, 0x1E, 0x72, 0xA4, 0xFE, 0xB2, 0x0B, 0x47, 0x6E, 0x87, 0xE2, 0xE1, 0xF9, 0x7F, 0x02,
		0x03, 0x01, 0x00, 0x01, 0xA3, 0x66, 0x30, 0x64, 0x30, 0x1F, 0x06, 0x03, 0x55, 0x1D, 0x23, 0x04,
		0x18, 0x30, 0x16, 0x80, 0x14, 0x9E, 0xC2, 0xED, 0x0A, 0x3B, 0xAF, 0xDB, 0x6A, 0x07, 0x5B, 0x12,
		0x19, 0x7B, 0x28, 0x58, 0x14, 0x21, 0xCC, 0x94, 0x99, 0x30, 0x12, 0x06, 0x03, 0x55, 0x1D, 0x13,
		0x01, 0x01, 0xFF, 0x04, 0x08, 0x30, 0x06, 0x01, 0x01, 0xFF, 0x02, 0x01, 0x00, 0x30, 0x0E, 0x06,
		0x03, 0x55, 0x1D, 0x0F, 0x01, 0x01, 0xFF, 0x04, 0x04, 0x03, 0x02, 0x02, 0x04, 0x30, 0x1D, 0x06,
		0x03, 0x55, 0x1D, 0x0E, 0x04, 0x16, 0x04, 0x14, 0x2E, 0x5B, 0x67, 0x21, 0xE6, 0xBB, 0x28, 0x04,
		0xB4, 0x60, 0x2D, 0x7A, 0x65, 0xC8, 0xCD, 0xEE, 0xA2, 0xB7, 0xE7, 0xAF, 0x30, 0x0D, 0x06, 0x09,
		0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00,
		0x72, 0xC4, 0xC2, 0xA4, 0x5A, 0x0B, 0x1E, 0x77, 0x98, 0x1A, 0xA2, 0xBE, 0xF4, 0xC1, 0x74, 0x56,
		0x1F, 0x1A, 0x1A, 0xB5, 0xC8, 0xA7, 0xAA, 0x26, 0x95, 0xB0, 0x27, 0xF5, 0x91, 0x2A, 0x90, 0x9E,
		0xE1, 0x12, 0x15, 0xD2, 0x9C, 0xD0, 0x02, 0xF0, 0x75, 0x1B, 0x95, 0x77, 0xC0, 0x90, 0x20, 0x7F,
		0xA3, 0x6B, 0x47, 0xB4, 0x5C, 0x3B, 0x1F, 0x83, 0x12, 0x11, 0xA9, 0xE0, 0xDE, 0xDB, 0x53, 0x9C,
		0x01, 0x0F, 0xD4, 0x93, 0x7C, 0xA6, 0xED, 0x2B, 0x47, 0x5B, 0xB5, 0x96, 0xD1, 0x31, 0x69, 0x97,
		0xFF, 0xCE, 0x43, 0x79, 0x0A, 0x94, 0x03, 0xB7, 0x3A, 0xB8, 0x63, 0x8D, 0xAB, 0xAE, 0x60, 0x14,
		0x66, 0x73, 0x72, 0xE0, 0x53, 0xDE, 0xC5, 0x92, 0xE2, 0x9A, 0xFA, 0xC8, 0x15, 0x2E, 0x1B, 0x06,
		0x3C, 0xEA, 0x39, 0xDD, 0xE1, 0x73, 0x47, 0x00, 0x4D, 0xDE, 0x7F, 0x3A, 0xD3, 0x9B, 0x60, 0xE7,
		0x50, 0xA1, 0xE9, 0xF1, 0x60, 0xA4, 0xB8, 0xE4, 0xF5, 0x8B, 0x8E, 0x2A, 0x22, 0x38, 0xB4, 0xBC,
		0x7B, 0x86, 0xDB, 0xFF, 0xF7, 0x36, 0x5B, 0x47, 0xC1, 0x2A, 0x89, 0x37, 0xC9, 0x88, 0x34, 0xC2,
		0xCC, 0x60, 0x8A, 0x66, 0x71, 0x3D, 0x90, 0xA3, 0x30, 0x63, 0x04, 0x1E, 0xE5, 0xF4, 0x66, 0xF6,
		0xBC, 0xB0, 0xB9, 0xDD, 0xAE, 0x18, 0x5B, 0x99, 0xF6, 0x2F, 0xD1, 0xAB, 0x53, 0xDC, 0x44, 0xC4,
		0x21, 0xA5, 0x32, 0x3A, 0x3D, 0xB8, 0xAE, 0x5C, 0xF9, 0xFC, 0x61, 0x99, 0x16, 0x78, 0x14, 0x11,
		0x06, 0xE2, 0x9D, 0x0F, 0x00, 0x85, 0xEC, 0x8B, 0xD6, 0x35, 0x68, 0x7B, 0xDF, 0x4D, 0x10, 0x67,
		0x41, 0xD4, 0x19, 0xFF, 0xF4, 0xC1, 0xEB, 0xDA, 0x97, 0xFA, 0xD1, 0x20, 0x3E, 0x6A, 0xBB, 0x61,
		0x3B, 0x81, 0x40, 0x5B, 0xC1, 0xE6, 0x7C, 0xB7, 0x2D, 0x16, 0x2D, 0xFF, 0xFE, 0x30, 0xA3, 0x9F
	};
	unsigned char	Host_DevCert[CI_MAX_CERT_LEN] = // from 1D1852D21C1ED5DC-cert.der
	{
		0x30, 0x82, 0x03, 0xEB, 0x30, 0x82, 0x02, 0xD3, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x0E, 0x3A,
		0x41, 0x00, 0x00, 0x2C, 0xFE, 0xB6, 0xA5, 0x6F, 0xC6, 0x22, 0x70, 0xF6, 0x9C, 0x30, 0x0D, 0x06,
		0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x00, 0x30, 0x72, 0x31, 0x0B,
		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x44, 0x45, 0x31, 0x10, 0x30, 0x0E, 0x06,
		0x03, 0x55, 0x04, 0x08, 0x13, 0x07, 0x48, 0x61, 0x6D, 0x62, 0x75, 0x72, 0x67, 0x31, 0x10, 0x30,
		0x0E, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x07, 0x48, 0x61, 0x6D, 0x62, 0x75, 0x72, 0x67, 0x31,
		0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0A, 0x54, 0x65, 0x73, 0x74, 0x20, 0x53,
		0x75, 0x62, 0x43, 0x41, 0x31, 0x0D, 0x30, 0x0B, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x04, 0x74,
		0x65, 0x73, 0x74, 0x31, 0x1B, 0x30, 0x19, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x12, 0x43, 0x49,
		0x20, 0x50, 0x6C, 0x75, 0x73, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x53, 0x75, 0x62, 0x43, 0x41,
		0x30, 0x1E, 0x17, 0x0D, 0x30, 0x39, 0x30, 0x32, 0x30, 0x36, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x5A, 0x17, 0x0D, 0x31, 0x31, 0x30, 0x32, 0x30, 0x35, 0x32, 0x33, 0x35, 0x39, 0x35, 0x39, 0x5A,
		0x30, 0x81, 0x81, 0x31, 0x0D, 0x30, 0x0B, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x04, 0x74, 0x65,
		0x73, 0x74, 0x31, 0x0F, 0x30, 0x0D, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x06, 0x48, 0x6F, 0x73,
		0x74, 0x20, 0x41, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0A, 0x54, 0x65,
		0x73, 0x74, 0x20, 0x53, 0x75, 0x62, 0x43, 0x41, 0x31, 0x10, 0x30, 0x0E, 0x06, 0x03, 0x55, 0x04,
		0x07, 0x13, 0x07, 0x48, 0x61, 0x6D, 0x62, 0x75, 0x72, 0x67, 0x31, 0x10, 0x30, 0x0E, 0x06, 0x03,
		0x55, 0x04, 0x08, 0x13, 0x07, 0x48, 0x61, 0x6D, 0x62, 0x75, 0x72, 0x67, 0x31, 0x0B, 0x30, 0x09,
		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x44, 0x45, 0x31, 0x19, 0x30, 0x17, 0x06, 0x03, 0x55,
		0x04, 0x03, 0x13, 0x10, 0x31, 0x44, 0x31, 0x38, 0x35, 0x32, 0x44, 0x32, 0x31, 0x43, 0x31, 0x45,
		0x44, 0x35, 0x44, 0x43, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86,
		0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0F, 0x00, 0x30, 0x82, 0x01, 0x0A,
		0x02, 0x82, 0x01, 0x01, 0x00, 0xDC, 0x6F, 0x12, 0xA3, 0x5C, 0xF7, 0x2B, 0xB6, 0x64, 0x3D, 0x20,
		0x76, 0x8D, 0xB3, 0xE4, 0xF7, 0x25, 0xF3, 0xE8, 0xB7, 0x5C, 0x7D, 0x48, 0xE4, 0xE0, 0x9B, 0x93,
		0x80, 0x8E, 0x42, 0xE5, 0x3F, 0xD0, 0x32, 0x3B, 0x58, 0xF2, 0x0A, 0x37, 0x78, 0x19, 0xAE, 0xBF,
		0x1F, 0xFC, 0x9E, 0x1E, 0x46, 0x4C, 0x22, 0x4C, 0x76, 0x67, 0xEB, 0x2F, 0x48, 0xB9, 0x25, 0x69,
		0xB3, 0x54, 0xD7, 0x82, 0xB2, 0x92, 0x5B, 0xC4, 0xE9, 0x2D, 0xC7, 0x1D, 0xA8, 0xF4, 0x48, 0x95,
		0x07, 0x39, 0xE4, 0x81, 0xC5, 0x59, 0x7E, 0xD7, 0x9F, 0x38, 0x15, 0x7E, 0xE4, 0xD4, 0x13, 0x16,
		0xC4, 0xEE, 0x6F, 0x6F, 0xAB, 0x85, 0x1B, 0x5B, 0xB7, 0x1B, 0xA6, 0x2B, 0x8B, 0xA9, 0xC0, 0x30,
		0x54, 0x79, 0x10, 0x8E, 0x0E, 0xF4, 0x68, 0xC5, 0x29, 0xDC, 0x58, 0x87, 0xF7, 0xA6, 0x46, 0x12,
		0xFC, 0xBC, 0x57, 0x7E, 0x5C, 0x7B, 0x11, 0xA0, 0x29, 0xA5, 0x40, 0x9B, 0x41, 0xC4, 0xCA, 0x32,
		0x49, 0x84, 0xFB, 0x4E, 0xF0, 0xC3, 0xF0, 0x79, 0x67, 0x0F, 0x1B, 0x6E, 0xF5, 0x81, 0xDC, 0xBE,
		0xC9, 0xFB, 0x38, 0x66, 0x57, 0x91, 0x91, 0x1F, 0x46, 0x09, 0xAE, 0x63, 0x95, 0x02, 0xEE, 0x08,
		0x3F, 0x1B, 0x60, 0x1F, 0xE8, 0x7C, 0xA5, 0x65, 0x7D, 0x03, 0x8F, 0x50, 0x2B, 0x6B, 0x88, 0xD1,
		0xD4, 0xF5, 0x56, 0x0E, 0xB9, 0x5A, 0x8F, 0xE7, 0xE6, 0x5B, 0xD6, 0x7D, 0x35, 0x62, 0x12, 0xE6,
		0x55, 0xEB, 0x16, 0x12, 0x04, 0x14, 0x96, 0x51, 0x78, 0xA6, 0x4B, 0x59, 0xAD, 0x2B, 0x4F, 0xAC,
		0xCD, 0x90, 0xF4, 0x08, 0x5A, 0xA7, 0x3C, 0xC4, 0xCD, 0x14, 0xE8, 0x51, 0x8D, 0xD3, 0x50, 0xC7,
		0xF1, 0x3A, 0xB1, 0xDB, 0x83, 0x8F, 0xEF, 0xD7, 0x6A, 0x37, 0xFF, 0x1A, 0x40, 0x70, 0xC9, 0xF0,
		0x2E, 0x02, 0x6B, 0x58, 0x4B, 0x02, 0x03, 0x01, 0x00, 0x01, 0xA3, 0x6F, 0x30, 0x6D, 0x30, 0x1F,
		0x06, 0x03, 0x55, 0x1D, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0x2E, 0x5B, 0x67, 0x21, 0xE6,
		0xBB, 0x28, 0x04, 0xB4, 0x60, 0x2D, 0x7A, 0x65, 0xC8, 0xCD, 0xEE, 0xA2, 0xB7, 0xE7, 0xAF, 0x30,
		0x0C, 0x06, 0x03, 0x55, 0x1D, 0x13, 0x01, 0x01, 0xFF, 0x04, 0x02, 0x30, 0x00, 0x30, 0x0E, 0x06,
		0x03, 0x55, 0x1D, 0x0F, 0x01, 0x01, 0xFF, 0x04, 0x04, 0x03, 0x02, 0x07, 0x80, 0x30, 0x13, 0x06,
		0x08, 0x2B, 0x06, 0x01, 0x05, 0x05, 0x07, 0x01, 0x1A, 0x04, 0x07, 0x03, 0x05, 0x00, 0xDE, 0xAD,
		0xDE, 0xAD, 0x30, 0x17, 0x06, 0x08, 0x2B, 0x06, 0x01, 0x05, 0x05, 0x07, 0x01, 0x19, 0x01, 0x01,
		0xFF, 0x04, 0x08, 0x30, 0x06, 0x02, 0x01, 0x01, 0x02, 0x01, 0x00, 0x30, 0x0D, 0x06, 0x09, 0x2A,
		0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00, 0xD4,
		0xBC, 0xAD, 0x97, 0x1F, 0x59, 0x10, 0x45, 0x54, 0x58, 0x73, 0x40, 0xD2, 0xF7, 0x2E, 0xCE, 0x72,
		0x81, 0x9B, 0xA3, 0x8F, 0x8F, 0xF9, 0xBD, 0x57, 0xFB, 0x82, 0x6E, 0x3B, 0x5F, 0xA6, 0xE2, 0x40,
		0x2B, 0xB1, 0x00, 0x2D, 0x82, 0x50, 0x3C, 0x89, 0xA9, 0x33, 0x3C, 0x4D, 0x0D, 0xD4, 0x20, 0x99,
		0x29, 0xF3, 0x6A, 0x40, 0x35, 0x78, 0x3A, 0x6F, 0x07, 0x42, 0x3D, 0xFF, 0x93, 0x83, 0x2C, 0x5C,
		0x36, 0x8C, 0x2D, 0x4E, 0x0E, 0xC5, 0x36, 0xFA, 0x5E, 0x34, 0x30, 0xBD, 0x3A, 0x6F, 0x5A, 0x77,
		0xE1, 0xD0, 0xDF, 0x2E, 0x80, 0xEA, 0x11, 0x27, 0x6B, 0x76, 0x93, 0x83, 0x39, 0x00, 0xC5, 0x48,
		0x60, 0xCE, 0xCE, 0xCC, 0x46, 0xDD, 0x6D, 0xC7, 0x82, 0x31, 0x9A, 0x39, 0xC1, 0x9E, 0x40, 0x2F,
		0x9A, 0x34, 0x47, 0x28, 0x90, 0xF1, 0xF9, 0x48, 0x73, 0x40, 0xDE, 0x74, 0xEC, 0x50, 0xFE, 0xEB,
		0xA9, 0x25, 0x9E, 0x4A, 0xEE, 0xF2, 0x81, 0xC7, 0x3E, 0xE8, 0xA8, 0xC1, 0xE7, 0x32, 0x76, 0x52,
		0x8E, 0xE3, 0x1A, 0xA1, 0x1E, 0xE8, 0xDB, 0x49, 0x5C, 0x06, 0xDA, 0x43, 0xDC, 0x5D, 0xD8, 0xF3,
		0x7C, 0xFA, 0x73, 0x7E, 0xCD, 0xEA, 0xF3, 0x1A, 0x81, 0x0E, 0xD4, 0x1E, 0x4F, 0xBF, 0xD2, 0xCD,
		0x85, 0x7D, 0xBC, 0xE9, 0x8D, 0xC6, 0xAB, 0x38, 0xEA, 0x61, 0xA5, 0x09, 0x96, 0x5A, 0xF8, 0x3C,
		0x42, 0xD2, 0x45, 0xEE, 0xE8, 0x85, 0xC3, 0x3C, 0x6D, 0x64, 0x7E, 0xFB, 0x99, 0x57, 0xC8, 0xED,
		0xB6, 0xE9, 0xDB, 0xD3, 0x06, 0x63, 0xD5, 0x6E, 0x37, 0xFA, 0xAC, 0xB6, 0xC7, 0x6C, 0x97, 0x3B,
		0x0E, 0x32, 0x15, 0xA6, 0x77, 0x61, 0xFE, 0xCE, 0xAC, 0xFB, 0x49, 0xA3, 0x35, 0xCF, 0xEE, 0xCB,
		0x7A, 0xC2, 0x8C, 0xBE, 0x12, 0x51, 0x49, 0xBE, 0x7F, 0x91, 0xEB, 0xF4, 0x8A, 0xE7, 0xAF
	};
	unsigned char	DH_p[CI_DH_P_LEN] = // from Credentials 문서
	{
		0xA4, 0x79, 0x27, 0x2E, 0x24, 0x3D, 0x44, 0x36, 0xC8, 0x5C, 0x82, 0xB0, 0xFF, 0x7D, 0x93, 0xE1,
		0x63, 0x8D, 0x82, 0x9D, 0x2A, 0xC7, 0x9D, 0x4D, 0x40, 0x99, 0xC8, 0xD3, 0x25, 0xA5, 0x4F, 0x01,
		0x15, 0xEC, 0x29, 0x01, 0x18, 0x3B, 0x93, 0xB8, 0x36, 0xB8, 0xE0, 0xAA, 0x4F, 0x3A, 0x20, 0x77,
		0x6E, 0xB4, 0x96, 0x37, 0x36, 0x55, 0x1C, 0x36, 0x60, 0x00, 0xF7, 0x95, 0x71, 0x74, 0x48, 0xC4,
		0x77, 0x6C, 0xB2, 0x79, 0xCA, 0xAA, 0x33, 0x62, 0x87, 0xF5, 0x42, 0x12, 0x1C, 0x43, 0xE0, 0x1C,
		0x12, 0x53, 0xB2, 0xEF, 0x31, 0x56, 0x91, 0x5E, 0xE0, 0xF3, 0x92, 0x71, 0x80, 0x44, 0x0D, 0xA2,
		0xF2, 0x14, 0x2F, 0xB4, 0x29, 0xDA, 0xF6, 0xE6, 0x31, 0x65, 0x4F, 0x12, 0xEA, 0x88, 0x12, 0xC3,
		0x64, 0xE5, 0xF6, 0xE8, 0x29, 0xC4, 0x2D, 0xB3, 0x84, 0xE7, 0x6A, 0x15, 0x91, 0x0B, 0xD2, 0x38,
		0x48, 0x35, 0x59, 0x78, 0xD7, 0xAD, 0xEF, 0x52, 0x1E, 0x5C, 0x29, 0x4E, 0xEA, 0xD0, 0x30, 0xD9,
		0xC2, 0x96, 0x66, 0xC6, 0x92, 0x20, 0xC2, 0xFA, 0xD5, 0xD5, 0x58, 0xD7, 0x26, 0xEF, 0x46, 0x58,
		0x36, 0xC6, 0x22, 0x08, 0x7E, 0x48, 0x2F, 0xA6, 0xD5, 0x9E, 0x1C, 0x1C, 0x8A, 0x0F, 0x5A, 0x09,
		0xE1, 0x7D, 0xB7, 0xE6, 0x9A, 0xB2, 0x6F, 0xE7, 0x34, 0x96, 0x96, 0x63, 0xBD, 0x71, 0xAA, 0xFD,
		0x81, 0x81, 0x99, 0xEF, 0xAA, 0xDC, 0x54, 0xED, 0x6A, 0x4B, 0xEF, 0xCD, 0x39, 0x67, 0x71, 0x69,
		0x76, 0x0C, 0xD5, 0x54, 0xD4, 0xF3, 0xCF, 0x90, 0x52, 0xCE, 0xAD, 0xC6, 0x05, 0xE6, 0x05, 0xB4,
		0xE2, 0xFF, 0x00, 0x25, 0xA2, 0x3A, 0xFC, 0xC1, 0x54, 0x6E, 0x52, 0x6E, 0x83, 0x0B, 0xDE, 0x3C,
		0x62, 0xD7, 0x3C, 0x7A, 0x8E, 0xEE, 0x14, 0x34, 0x9A, 0x2E, 0xCB, 0x69, 0xDF, 0x1C, 0xC0, 0x03
	};
	unsigned char	DH_g[CI_DH_G_LEN] = // from Credentials 문서
	{
		0x96, 0xB1, 0x9B, 0xD8, 0xE1, 0x0C, 0x5F, 0x9D, 0xE4, 0x12, 0x66, 0x49, 0xCB, 0x51, 0x11, 0x65,
		0x73, 0x9F, 0xEB, 0x2C, 0xAF, 0x27, 0x20, 0x24, 0x77, 0xF8, 0x42, 0x92, 0xC3, 0x30, 0x36, 0x06,
		0x64, 0xA4, 0x89, 0x5D, 0xCE, 0x0A, 0x51, 0x34, 0x56, 0x0F, 0xBA, 0x24, 0x25, 0xCC, 0x40, 0x29,
		0x72, 0x5D, 0x40, 0x3B, 0x6E, 0x6F, 0x1F, 0x22, 0x3F, 0x4E, 0x3D, 0xB7, 0x36, 0xEE, 0x10, 0xBB,
		0xD8, 0x45, 0x3C, 0xE4, 0x69, 0x3C, 0x33, 0x34, 0x51, 0xF2, 0x10, 0x13, 0xAD, 0xD3, 0x1E, 0xE8,
		0x0B, 0xAB, 0xA2, 0x4F, 0xDF, 0xA4, 0xEC, 0xB6, 0x05, 0xF0, 0x3C, 0x9F, 0x09, 0x35, 0xA8, 0x7F,
		0xD4, 0x4D, 0x3B, 0x9C, 0x23, 0x4D, 0xB9, 0xDE, 0xD7, 0xA7, 0x20, 0xCE, 0x25, 0x9D, 0x1C, 0x65,
		0x49, 0x32, 0xED, 0x9E, 0xFE, 0x02, 0x76, 0x11, 0x0D, 0x23, 0x5B, 0xAA, 0xAF, 0x61, 0xA5, 0x1E,
		0x04, 0xE9, 0x37, 0x2A, 0x23, 0x97, 0x55, 0x64, 0x43, 0x53, 0x4F, 0x3B, 0xB7, 0xFB, 0x73, 0x23,
		0x61, 0x03, 0x4A, 0x16, 0x65, 0x78, 0x6D, 0xCC, 0x94, 0x41, 0xF5, 0x60, 0x40, 0x8E, 0x15, 0xF2,
		0x87, 0x8E, 0x35, 0x3A, 0xA6, 0xB0, 0x78, 0xED, 0xCD, 0x71, 0x8F, 0x5C, 0xFF, 0xEE, 0x9E, 0x69,
		0x1A, 0xE0, 0xA8, 0xD0, 0xD5, 0xF9, 0x24, 0x2A, 0xDD, 0xBD, 0xF2, 0x3D, 0x21, 0xB2, 0x13, 0x2F,
		0xE7, 0xD2, 0xE3, 0xC9, 0x1A, 0x64, 0x65, 0x14, 0x14, 0x37, 0x47, 0x23, 0x7C, 0xBB, 0xD3, 0x0F,
		0x4D, 0xC9, 0x65, 0x9D, 0xF5, 0xB7, 0xF5, 0x86, 0xCB, 0xD7, 0x29, 0x5B, 0x08, 0x31, 0x77, 0x15,
		0xC5, 0x81, 0xF2, 0x04, 0x60, 0x2F, 0x39, 0xB8, 0xFD, 0x6C, 0xA6, 0xC4, 0xC9, 0x43, 0x35, 0xC1,
		0x40, 0x0E, 0x30, 0x0B, 0x22, 0x9A, 0xCD, 0x50, 0x87, 0x34, 0x61, 0x6D, 0x23, 0x5B, 0x15, 0x60
	};
	unsigned char	DH_q[CI_DH_Q_LEN] = // from Credentials 문서
	{
		0xD8, 0x5E, 0xAB, 0xE8, 0xBE, 0x5B, 0xE3, 0xD2, 0xCF, 0x50, 0xE7, 0x90, 0xA8, 0x6A, 0x3F, 0xAD,
		0xDA, 0xB6, 0xE8, 0xA5, 0x0F, 0x32, 0x87, 0x71, 0xFD, 0x0B, 0xF0, 0x52, 0xAE, 0x3C, 0xA9, 0x37
	};
	unsigned char	HDQ_d[CI_HDQ_D_LEN] = // from 1D1852D21C1ED5DC-key.der
	{
		0xB2, 0xA4, 0x71, 0x7E, 0x63, 0x41, 0x0C, 0xF3, 0xEB, 0x98, 0x7E, 0x4E, 0x95, 0xD8, 0x4C, 0x9E,
		0xDE, 0xEB, 0x24, 0x96, 0x35, 0x26, 0x73, 0x84, 0xC9, 0x62, 0x4B, 0xCF, 0xCB, 0x7A, 0xFB, 0x3F,
		0x14, 0x03, 0x21, 0x85, 0x9B, 0xE2, 0x1B, 0xC2, 0x01, 0x4E, 0x55, 0x26, 0x1F, 0x1C, 0x25, 0x7C,
		0xE3, 0x06, 0x88, 0xE1, 0x0C, 0xA6, 0xD4, 0xD3, 0x22, 0xF8, 0xE7, 0x08, 0xA6, 0xA1, 0x61, 0x12,
		0x46, 0xFA, 0x88, 0x42, 0x51, 0x0F, 0x25, 0x42, 0x5F, 0x76, 0xD3, 0x0F, 0xE0, 0x23, 0x07, 0xE8,
		0x5F, 0xF7, 0x23, 0xD7, 0xAD, 0x23, 0xFE, 0x8A, 0x84, 0x34, 0x54, 0x27, 0x94, 0xF4, 0x4A, 0x93,
		0xBE, 0x73, 0xC5, 0x88, 0x47, 0xA8, 0x0B, 0x72, 0x4C, 0x47, 0xAC, 0xE3, 0x48, 0x99, 0xDA, 0x06,
		0xD4, 0x9C, 0x73, 0xEC, 0xD0, 0xDE, 0x0E, 0x92, 0xEC, 0xF5, 0xAD, 0x3D, 0x95, 0x85, 0x72, 0xA9,
		0x0F, 0x1A, 0x8D, 0xE5, 0xBC, 0x4C, 0x86, 0x2D, 0x7C, 0xB6, 0xB9, 0x7C, 0x05, 0x0A, 0x89, 0x25,
		0xA9, 0x07, 0xB1, 0x60, 0xD0, 0xE0, 0xBD, 0x2E, 0x85, 0x71, 0x35, 0xB6, 0xE1, 0xBB, 0x33, 0x08,
		0x0E, 0x19, 0x9F, 0x63, 0x5B, 0x8A, 0x7E, 0x7A, 0x9B, 0x09, 0xDD, 0x03, 0x6A, 0xF3, 0x32, 0x8C,
		0xB6, 0x7C, 0xC1, 0x84, 0x31, 0x4F, 0xFA, 0x3A, 0x4D, 0xD9, 0xB8, 0xD7, 0xDA, 0xBA, 0x02, 0x53,
		0x96, 0x53, 0x8B, 0x13, 0x87, 0xAE, 0xEC, 0x0A, 0x14, 0xDB, 0x8C, 0xE7, 0xE9, 0xAC, 0xBF, 0xA0,
		0x53, 0xD7, 0xF3, 0x4D, 0x08, 0xA7, 0x45, 0xB9, 0x8C, 0x74, 0xD2, 0x34, 0x3E, 0x76, 0x8C, 0xC5,
		0xF6, 0x2A, 0xDE, 0xE6, 0xDA, 0xBA, 0x65, 0xE3, 0xAA, 0xED, 0x56, 0xB0, 0x57, 0xA0, 0x11, 0x83,
		0x4F, 0x60, 0xA1, 0x7C, 0xF1, 0xE9, 0x9F, 0x9C, 0x84, 0xE9, 0x18, 0x10, 0x13, 0x31, 0xA8, 0xC1
	};
	unsigned char	HDQ_p[CI_HDQ_P_LEN] = // from 1D1852D21C1ED5DC-key.der
	{
		0xF1, 0xDE, 0xA6, 0x3E, 0xF6, 0xE1, 0x1E, 0xD8, 0x90, 0xA6, 0xFE, 0xB3, 0x36, 0xE6, 0x70, 0x4A,
		0x89, 0x9C, 0x80, 0xDB, 0x0E, 0xF6, 0xDB, 0x0A, 0x1E, 0xAB, 0xEC, 0x7A, 0xA3, 0x02, 0x08, 0xA8,
		0x3B, 0x07, 0xBF, 0xC8, 0xA1, 0x51, 0x8A, 0x14, 0xB7, 0xBA, 0x75, 0x30, 0x38, 0x75, 0x59, 0x6D,
		0x8B, 0x93, 0xBB, 0x8B, 0x2A, 0x72, 0xF8, 0xEB, 0xBB, 0x01, 0xC8, 0xA8, 0x57, 0xC5, 0x08, 0xBC,
		0xF7, 0x57, 0xF8, 0x63, 0x9F, 0x59, 0xD0, 0xED, 0x42, 0x38, 0xD0, 0xBB, 0x7C, 0xB0, 0xF5, 0x20,
		0xEA, 0x29, 0x5E, 0x88, 0xB7, 0x80, 0x89, 0xA2, 0x96, 0x96, 0xFD, 0x85, 0x4B, 0x13, 0xCF, 0xD2,
		0xF5, 0x0C, 0x1A, 0xE3, 0xB4, 0xEA, 0x16, 0xC5, 0x98, 0x77, 0x36, 0x0F, 0xCD, 0x91, 0x9B, 0xEB,
		0xEC, 0x9F, 0x0E, 0xB1, 0xCA, 0xB6, 0x68, 0x84, 0xF2, 0x6B, 0x75, 0xDF, 0xF0, 0x2D, 0x69, 0xE7
	};
	unsigned char	HDQ_q[CI_HDQ_Q_LEN] = // from 1D1852D21C1ED5DC-key.der
	{
		0xE9, 0x4F, 0xD5, 0x66, 0x23, 0xC7, 0x01, 0xF9, 0x22, 0x61, 0x2D, 0x18, 0x87, 0x81, 0x1D, 0xCF,
		0x48, 0xA5, 0x83, 0x83, 0xC6, 0xC2, 0x10, 0xF9, 0x24, 0x07, 0xDB, 0x06, 0x29, 0x0B, 0x1E, 0x01,
		0xB2, 0x60, 0xE5, 0xA7, 0x9D, 0xE4, 0xF4, 0xEE, 0x69, 0xF3, 0x69, 0x0A, 0x73, 0xC1, 0x55, 0xD8,
		0xCA, 0xB1, 0xD7, 0x98, 0x60, 0x0C, 0xFA, 0x13, 0xA7, 0x54, 0xAE, 0xC8, 0x30, 0x1F, 0xC9, 0x6B,
		0x6F, 0xF2, 0x8F, 0x31, 0x35, 0x03, 0x89, 0xBA, 0x24, 0x5F, 0xF4, 0xCF, 0x7F, 0x25, 0x67, 0xC8,
		0xF7, 0x7C, 0x88, 0x06, 0x5B, 0x0C, 0x4B, 0x9F, 0x4B, 0xE3, 0xAF, 0x82, 0x2F, 0xD8, 0x39, 0x29,
		0xF1, 0x45, 0x31, 0x18, 0x41, 0x90, 0x2D, 0x24, 0x27, 0x2D, 0xEE, 0x6F, 0x91, 0x0F, 0xDA, 0xDB,
		0x75, 0xF3, 0x31, 0xD8, 0xC3, 0x29, 0xFE, 0x3E, 0x93, 0x6F, 0x30, 0x57, 0x59, 0x38, 0xF9, 0xFD
	};
	unsigned char	HDQ_dP[CI_HDQ_DP_LEN] = // from 1D1852D21C1ED5DC-key.der
	{
		0xCA, 0x7E, 0xB1, 0x88, 0x7D, 0x80, 0xB4, 0x26, 0x73, 0xD4, 0x9B, 0xE0, 0xC6, 0xD1, 0xDE, 0xA9,
		0x48, 0xD4, 0xB2, 0x3C, 0xB4, 0x26, 0x8F, 0xF3, 0xC5, 0x02, 0x03, 0x16, 0x19, 0x6B, 0x16, 0x7C,
		0x62, 0x0F, 0x76, 0xCD, 0x2D, 0xE1, 0xEA, 0x4C, 0xB6, 0x15, 0x71, 0x0F, 0x51, 0xF5, 0x4D, 0x4D,
		0x9D, 0x51, 0xAD, 0xEE, 0x31, 0x37, 0xD8, 0x96, 0xE3, 0x15, 0xF7, 0x3C, 0x99, 0x5E, 0xE8, 0x95,
		0xEC, 0x2E, 0xC6, 0x52, 0x01, 0x93, 0x5C, 0x8B, 0x86, 0xA9, 0xB2, 0x77, 0x85, 0x49, 0x51, 0xB0,
		0xA0, 0xDA, 0xC9, 0xBE, 0x84, 0x83, 0x24, 0xB7, 0xEE, 0x83, 0xB2, 0xF4, 0xE9, 0x8A, 0x48, 0xB0,
		0x41, 0x60, 0x45, 0x12, 0xE6, 0xE0, 0x24, 0xF8, 0x81, 0x51, 0x2C, 0xFD, 0xC6, 0x09, 0x66, 0x14,
		0xFB, 0x21, 0x9F, 0x57, 0xD2, 0x73, 0x2C, 0xC6, 0x41, 0x7F, 0x1E, 0x4C, 0xC1, 0xF4, 0x03, 0x79
	};
	unsigned char	HDQ_dQ[CI_HDQ_DQ_LEN] = // from 1D1852D21C1ED5DC-key.der
	{
		0x53, 0x0D, 0x21, 0x18, 0xAF, 0xC9, 0xAA, 0x91, 0x25, 0xC4, 0xD3, 0xC9, 0xB4, 0x8A, 0xA8, 0xB2,
		0xDD, 0xD8, 0x55, 0x3D, 0x76, 0x66, 0x24, 0xA6, 0x9B, 0x45, 0xD4, 0x98, 0x97, 0xC9, 0xA6, 0x4F,
		0xD2, 0x50, 0x9D, 0xCF, 0x91, 0xEC, 0x2B, 0xA8, 0x26, 0xBD, 0x07, 0xFA, 0x39, 0x84, 0x6B, 0xEB,
		0xB5, 0x13, 0xA3, 0x7C, 0x51, 0x4C, 0xAD, 0x44, 0x8B, 0xBF, 0x20, 0x4C, 0x90, 0x9C, 0xF0, 0x15,
		0x37, 0x8F, 0x6F, 0x9B, 0x83, 0x94, 0x93, 0xD5, 0x58, 0x17, 0x74, 0x4C, 0xDC, 0xA4, 0xD3, 0x11,
		0xFD, 0xCF, 0x2D, 0x98, 0x9D, 0x96, 0x7D, 0xE0, 0xE1, 0xA1, 0xD6, 0x1B, 0x10, 0xAE, 0xF6, 0x82,
		0x50, 0xA9, 0x61, 0xB5, 0x91, 0xB9, 0x21, 0xE8, 0x89, 0xAD, 0xD6, 0xFF, 0x8D, 0xF2, 0xC7, 0xE4,
		0x71, 0x53, 0x35, 0xBE, 0x44, 0x92, 0xD1, 0x37, 0x33, 0x42, 0x54, 0x41, 0xF3, 0xB7, 0xCD, 0x7D
	};
	unsigned char	HDQ_qInv[CI_HDQ_QINV_LEN] = // from 1D1852D21C1ED5DC-key.der
	{
		0xA4, 0x85, 0xD1, 0x97, 0xD7, 0x26, 0xFA, 0xF9, 0xCB, 0xC8, 0xC0, 0xC0, 0x6E, 0xCD, 0xC2, 0x4D,
		0xD2, 0xA6, 0xCB, 0x9E, 0x44, 0x4E, 0x87, 0x10, 0x7C, 0xF8, 0x1C, 0xDC, 0x0C, 0x34, 0x50, 0x2A,
		0xE4, 0xD3, 0x53, 0x65, 0x6B, 0x85, 0xB0, 0x9C, 0xB6, 0xDB, 0xF9, 0x16, 0xA9, 0xBE, 0x48, 0x5A,
		0x0B, 0xB5, 0x43, 0x3D, 0x2C, 0xED, 0xFC, 0xB2, 0x10, 0x7D, 0xCA, 0x44, 0x08, 0x77, 0x35, 0xBC,
		0xCC, 0x0A, 0x78, 0x75, 0xBA, 0xC7, 0x99, 0xA8, 0xC9, 0xEF, 0x22, 0x6B, 0x47, 0xF4, 0x32, 0x9A,
		0xB4, 0x11, 0x5B, 0x3E, 0x6C, 0x93, 0xC8, 0x25, 0x9F, 0x96, 0x23, 0xEB, 0xAF, 0x26, 0xD2, 0x24,
		0xB4, 0x2F, 0x7B, 0x2D, 0x65, 0x15, 0x03, 0x2C, 0x53, 0xC9, 0xE3, 0xCB, 0x0E, 0x56, 0x8C, 0xB1,
		0x58, 0x4C, 0xCC, 0xB5, 0x1B, 0x6C, 0xE6, 0xE9, 0xAD, 0xB4, 0xF9, 0xBB, 0x13, 0x43, 0xEA, 0x43
	};
	unsigned char	PRNG_seed[16]	= {0xe5, 0x82, 0x97, 0x31, 0x7f, 0x8c, 0x60, 0x47, 0xdd, 0xd4, 0xa5, 0xd3, 0xd3, 0x2d, 0xc1, 0x5c}; // from Credentials 문서
	unsigned char	SLK[16]			= {0x9c, 0x69, 0xd1, 0x46, 0x70, 0x0d, 0x81, 0x6c, 0xfd, 0x49, 0x69, 0x71, 0x26, 0x93, 0xa3, 0x8a}; // from Credentials 문서
	unsigned char	SIV[16]			= {0xd1, 0xe8, 0xde, 0x32, 0x2e, 0x44, 0xd8, 0x7c, 0x56, 0x90, 0x81, 0x89, 0x5f, 0x50, 0x50, 0x35}; // from Credentials 문서
	unsigned char	CLK[16]			= {0xae, 0xdc, 0x1b, 0x80, 0x4c, 0x50, 0xd9, 0x5d, 0xad, 0x6d, 0x3d, 0x46, 0xac, 0xd6, 0x01, 0xa8}; // from Credentials 문서

	VK_memset(&stCiHostLicenseConst, 0x00, sizeof(CI_HOST_LICENSE_CONST));

	stCiHostLicenseConst.RootCertLen = CI_ROOT_CERT_LEN;
	VK_memcpy(stCiHostLicenseConst.RootCert, RootCert, stCiHostLicenseConst.RootCertLen);

	stCiHostLicenseConst.Host_BrandCertLen = CI_HOST_BRAND_CERT_LEN;
	VK_memcpy(stCiHostLicenseConst.Host_BrandCert, Host_BrandCert, stCiHostLicenseConst.Host_BrandCertLen);

	stCiHostLicenseConst.Host_DevCertLen = CI_HOST_DEV_CERT_LEN;
	VK_memcpy(stCiHostLicenseConst.Host_DevCert, Host_DevCert, stCiHostLicenseConst.Host_DevCertLen);

	VK_memcpy(stCiHostLicenseConst.DH_p, DH_p, CI_DH_P_LEN);
	VK_memcpy(stCiHostLicenseConst.DH_g, DH_g, CI_DH_G_LEN);
	VK_memcpy(stCiHostLicenseConst.DH_q, DH_q, CI_DH_Q_LEN);

	VK_memcpy(stCiHostLicenseConst.HDQ_d, HDQ_d, CI_HDQ_D_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_p, HDQ_p, CI_HDQ_P_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_q, HDQ_q, CI_HDQ_Q_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_dP, HDQ_dP, CI_HDQ_DP_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_dQ, HDQ_dQ, CI_HDQ_DQ_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_qInv, HDQ_qInv, CI_HDQ_QINV_LEN);

	VK_memcpy(stCiHostLicenseConst.PRNG_seed, PRNG_seed, 16);
	VK_memcpy(stCiHostLicenseConst.SLK, SLK, 16);
	VK_memcpy(stCiHostLicenseConst.SIV, SIV, 16);
	VK_memcpy(stCiHostLicenseConst.CLK, CLK, 16);

	// Host_ID, Host_CckCipher, HDQ_n (from 디바이스 인증서)
	{
		Certificate_t * pstDevCertData = NULL;
		int nScramblerCapabilities, len;

		pstDevCertData = X509_ParseRawCert(Host_DevCert, CI_HOST_DEV_CERT_LEN);
		if (pstDevCertData == NULL)
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Invalid DevCert !!!\n"));
			return -1;
		}

		// get Host_ID
		if (FALSE == GetDeviceID(pstDevCertData, stCiHostLicenseConst.Host_ID))
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetDeviceID() !!!\n"));
			return -1;
		}

		// get Host_CckCipher
		if (FALSE == GetScramblerCapabilities(pstDevCertData, &nScramblerCapabilities))
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetScramblerCapabilities() !!!\n"));
			return -1;
		}
		if (nScramblerCapabilities == 0 || nScramblerCapabilities == 1)
		{
			stCiHostLicenseConst.Host_CckCipher = nScramblerCapabilities;
		}
		else // unknown value (reserved for future use) -> CI+ 스펙 1.2 기준에서 정의되지 않은 값일 경우엔 일단 CI_CC_KEY_CIPHER_DES_56_ECB 로 설정하도록 하자...
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetScramblerCapabilities()---> unknown value %d !!!\n", nScramblerCapabilities));
			stCiHostLicenseConst.Host_CckCipher = CI_CC_KEY_CIPHER_DES_56_ECB;
		}

		// get HDQ_n
		if (FALSE == GetRSAPublicKey_N(pstDevCertData, stCiHostLicenseConst.HDQ_n, &len))
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetRSAPublicKey_N() !!!\n"));
			return -1;
		}
		if (len != CI_HDQ_N_LEN)
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetRSAPublicKey_N()---> invalid len %d !!!\n", len));
			return -1;
		}
	}

	// HDQ_n (from 키 인증서), HDQ_d, HDQ_p, HDQ_q, HDQ_dP, HDQ_dQ, HDQ_qInv
	{
		// PC 프로그램의 경우, 해당 호스트 디바이스 인증서와 매칭되는 키 인증서로부터 유도.
		// 특히, HDQ_n 의 경우엔 위의 디바이스 인증서로 유도한 값과 키 인증서로부터 유도한 값이 서로 같은지 확인해야 한다.
	}

	// DHH, DHPH
	{
		bignum bn_DH_g, bn_DHH, bn_DH_p, bn_DHPH;
		int i;

		// generate a random nonce : DHH[256] -> DHH[0..15], DHH[16..31], ... , DHH[240..255] -> PRNG(&DHH[]) 16번 처리 -> concatenated to 256 bytes -> OK?
		for (i = 0; i < 256; i += CI_CC_CIPHER_BLOCK_SIZE)
			PRNG(PRNG_seed, &stCiHostLicenseConst.DHH[i]);

		// compute DHPH
		bn_init(&bn_DH_g, DH_g, CI_DH_G_LEN);
		bn_init(&bn_DHH, stCiHostLicenseConst.DHH, 256);
		bn_init(&bn_DH_p, DH_p, CI_DH_P_LEN);
		bn_mod_exp(&bn_DH_g, &bn_DHH, &bn_DH_p, &bn_DHPH);
		if (bn_DHPH.len != 256)
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Invalid DHPH len (%d) !!!\n", bn_DHPH.len));
			return -1;
		}

		// The host checks that the computed key DHPH is of valid length and value : if 1 < DHPH < DH_p and DHPH ^ DH_q mod DH_p = 1
		{
			bignum bn_DH_q, out;
			if (bn_cmp(&bn_one, &bn_DHPH) >= 0)
			{
				PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : DHPH not bigger than 1 !!!\n"));
				return -1;
			}
			if (bn_cmp(&bn_DHPH, &bn_DH_p) >= 0)
			{
				PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : DHPH not less than DH_p !!!\n"));
				return -1;
			}
			bn_init(&bn_DH_q, DH_q, CI_DH_Q_LEN);
			bn_mod_exp(&bn_DHPH, &bn_DH_q, &bn_DH_p, &out);
			if (bn_cmp(&out, &bn_one) != 0)
			{
				PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : DHPH ^ DH_q mod DH_p not 1 !!!\n"));
				return -1;
			}
		}

		VK_memcpy(stCiHostLicenseConst.DHPH, bn_DHPH.num, bn_DHPH.len);
	}

	stCiHostLicenseConst.ucSavedFlag = 2;

	SHA_256((unsigned char *)&stCiHostLicenseConst, usOrgLen-32, stCiHostLicenseConst.ucDigest);

	P = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);
	C = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);

	VK_memcpy(P, &stCiHostLicenseConst, usOrgLen);
	OneAndZeroesPadding(P, usOrgLen);
	E_AES_CBC(K, P, C, usAlignedLen, IV);

	fpBinaryFile = fopen(CI_HOST_LICENSE_CONST_FILE, "wb");
	if (fpBinaryFile == NULL)
	{
		PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Can't open file !!!\n"));
		CA_MEM_Free(P);
		CA_MEM_Free(C);
		return -1;
	}

	nDataSize = fwrite(C, 1, usAlignedLen, fpBinaryFile);
	fclose(fpBinaryFile);

	if (nDataSize != usAlignedLen)
	{
		PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Can't write data !!!\n"));
		CA_MEM_Free(P);
		CA_MEM_Free(C);
		return -1;
	}

	sync();

	CA_MEM_Free(P);
	CA_MEM_Free(C);

	return ERR_OK;
}
#endif // CI_PLUS_TEST_Technology_from_TrustCenter

#ifdef CI_PLUS_TEST_Technology_from_SmarDTV
// save CI+ host license constants data to non-volatile memory and return -1 if there is any error (데이터 무결성 및 보안을 위해 데이터들은 SHA-256 으로 hashing 되고 AES-128-CBC 로 암호화된다)
int CI_SaveHostLicenseConstantsForTestKitOnly (void)
{
	CI_HOST_LICENSE_CONST stCiHostLicenseConst;

	unsigned short usOrgLen = sizeof(CI_HOST_LICENSE_CONST), usAlignedLen = GetAlignedLen(usOrgLen);
	unsigned char *P = NULL, *C = NULL;

	FILE *fpBinaryFile = NULL;
	int nDataSize = 0;

	unsigned char	RootCert[CI_MAX_CERT_LEN] = // from ciplusRootCert.c
		{0x30,0x82,0x04,0x50,0x30,0x82,0x03,0x0F,0xA0,0x03,0x02,0x01,0x02,0x02,0x09,0x00
		,0x8C,0xB0,0x7C,0xE3,0xE2,0x62,0xE8,0xE5,0x30,0x36,0x06,0x09,0x2A,0x86,0x48,0x86
		,0xF7,0x0D,0x01,0x01,0x0A,0x30,0x29,0x30,0x09,0x06,0x05,0x2B,0x0E,0x03,0x02,0x1A
		,0x05,0x00,0x30,0x16,0x06,0x09,0x2A,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01,0x08,0x30
		,0x09,0x06,0x05,0x2B,0x0E,0x03,0x02,0x1A,0x05,0x00,0x02,0x01,0x14,0x02,0x01,0x01
		,0x30,0x81,0x9A,0x31,0x0B,0x30,0x09,0x06,0x03,0x55,0x04,0x06,0x13,0x02,0x46,0x52
		,0x31,0x0C,0x30,0x0A,0x06,0x03,0x55,0x04,0x08,0x0C,0x03,0x44,0x31,0x33,0x31,0x12
		,0x30,0x10,0x06,0x03,0x55,0x04,0x07,0x0C,0x09,0x4C,0x61,0x20,0x43,0x69,0x6F,0x74
		,0x61,0x74,0x31,0x25,0x30,0x23,0x06,0x03,0x55,0x04,0x0A,0x0C,0x1C,0x2D,0x2D,0x20
		,0x53,0x6D,0x61,0x72,0x44,0x54,0x56,0x20,0x53,0x41,0x20,0x2D,0x2D,0x2D,0x20,0x43
		,0x49,0x2B,0x20,0x52,0x4F,0x54,0x20,0x2D,0x2D,0x31,0x11,0x30,0x0F,0x06,0x03,0x55
		,0x04,0x0B,0x0C,0x08,0x43,0x49,0x2B,0x20,0x74,0x65,0x61,0x6D,0x31,0x0D,0x30,0x0B
		,0x06,0x03,0x55,0x04,0x0B,0x0C,0x04,0x74,0x65,0x73,0x74,0x31,0x20,0x30,0x1E,0x06
		,0x03,0x55,0x04,0x03,0x0C,0x17,0x43,0x49,0x2B,0x20,0x72,0x6F,0x6F,0x74,0x20,0x43
		,0x41,0x20,0x43,0x65,0x72,0x74,0x69,0x66,0x69,0x63,0x61,0x74,0x65,0x30,0x1E,0x17
		,0x0D,0x30,0x38,0x30,0x34,0x31,0x36,0x31,0x34,0x32,0x31,0x33,0x35,0x5A,0x17,0x0D
		,0x31,0x31,0x30,0x31,0x31,0x31,0x31,0x34,0x32,0x31,0x33,0x35,0x5A,0x30,0x81,0x9A
		,0x31,0x0B,0x30,0x09,0x06,0x03,0x55,0x04,0x06,0x13,0x02,0x46,0x52,0x31,0x0C,0x30
		,0x0A,0x06,0x03,0x55,0x04,0x08,0x0C,0x03,0x44,0x31,0x33,0x31,0x12,0x30,0x10,0x06
		,0x03,0x55,0x04,0x07,0x0C,0x09,0x4C,0x61,0x20,0x43,0x69,0x6F,0x74,0x61,0x74,0x31
		,0x25,0x30,0x23,0x06,0x03,0x55,0x04,0x0A,0x0C,0x1C,0x2D,0x2D,0x20,0x53,0x6D,0x61
		,0x72,0x44,0x54,0x56,0x20,0x53,0x41,0x20,0x2D,0x2D,0x2D,0x20,0x43,0x49,0x2B,0x20
		,0x52,0x4F,0x54,0x20,0x2D,0x2D,0x31,0x11,0x30,0x0F,0x06,0x03,0x55,0x04,0x0B,0x0C
		,0x08,0x43,0x49,0x2B,0x20,0x74,0x65,0x61,0x6D,0x31,0x0D,0x30,0x0B,0x06,0x03,0x55
		,0x04,0x0B,0x0C,0x04,0x74,0x65,0x73,0x74,0x31,0x20,0x30,0x1E,0x06,0x03,0x55,0x04
		,0x03,0x0C,0x17,0x43,0x49,0x2B,0x20,0x72,0x6F,0x6F,0x74,0x20,0x43,0x41,0x20,0x43
		,0x65,0x72,0x74,0x69,0x66,0x69,0x63,0x61,0x74,0x65,0x30,0x82,0x01,0x22,0x30,0x0D
		,0x06,0x09,0x2A,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01,0x01,0x05,0x00,0x03,0x82,0x01
		,0x0F,0x00,0x30,0x82,0x01,0x0A,0x02,0x82,0x01,0x01,0x00,0xDE,0xF4,0x45,0x74,0x4F
		,0x4B,0x66,0x4F,0x5E,0x86,0x08,0x15,0x90,0x97,0x2D,0x48,0x1A,0x44,0xE2,0xE8,0x6F
		,0x14,0x44,0xBB,0x2D,0x7C,0x5A,0xB6,0x44,0xF1,0xCD,0xE3,0xDD,0x6E,0x9E,0x78,0x92
		,0xD0,0x70,0x80,0xBE,0xC4,0x86,0x6C,0x82,0x05,0x0A,0x6A,0x5A,0x82,0x14,0x3C,0x64
		,0xDE,0x03,0x05,0xEF,0x5F,0xEB,0x8C,0x33,0x70,0x8F,0x87,0x62,0x13,0xFE,0xB5,0x2C
		,0xC7,0xDC,0xAF,0x20,0x95,0xAA,0x3E,0x52,0x60,0xCA,0x5B,0x7C,0x9E,0x21,0xD8,0x52
		,0x1F,0x99,0x37,0x42,0x7F,0x7C,0xB1,0x71,0x8A,0x73,0xA1,0x5B,0xF7,0x2A,0xF3,0x17
		,0x1D,0x5E,0xF9,0x20,0x3B,0xCA,0x3B,0x35,0xAC,0x71,0xC4,0x1F,0xCD,0x6F,0xAE,0x6B
		,0x74,0x6F,0xFE,0x22,0x35,0x4E,0x54,0xB4,0x3E,0xA4,0x51,0x0B,0x0E,0x29,0x41,0x6A
		,0x15,0x0D,0x13,0x9C,0xDB,0x5D,0x73,0x66,0x15,0x8F,0x94,0x8F,0x5E,0x84,0x2F,0xD7
		,0xED,0x93,0x69,0x47,0xE4,0x4D,0x69,0x59,0x9B,0x42,0x31,0x2A,0x69,0x79,0xE8,0x9E
		,0xC2,0xD4,0xAC,0x3B,0x34,0x2E,0x77,0x0E,0xAA,0x1A,0xF4,0x8A,0x7E,0x67,0x84,0xED
		,0x76,0xC8,0x6F,0xE5,0xBF,0xDF,0xA4,0xE2,0x8C,0x13,0x76,0x9C,0x11,0x65,0xAE,0xD9
		,0xB0,0xC3,0x0F,0x92,0xDC,0x91,0x2C,0xF3,0xEB,0xF4,0x66,0xBF,0xB9,0xC2,0x43,0x76
		,0x14,0x83,0xAE,0x06,0x96,0x47,0x70,0x1F,0xDE,0xE0,0xDA,0xD3,0xE7,0x17,0x9B,0x47
		,0x9B,0xD6,0x32,0xCE,0x3A,0x96,0x43,0xE3,0x37,0xA3,0xD8,0xF8,0x8D,0xEC,0xB1,0x35
		,0x86,0xAC,0x16,0x54,0x0B,0x88,0xF8,0xB1,0x3B,0xC8,0x7F,0x02,0x03,0x01,0x00,0x01
		,0xA3,0x45,0x30,0x43,0x30,0x12,0x06,0x03,0x55,0x1D,0x13,0x01,0x01,0xFF,0x04,0x08
		,0x30,0x06,0x01,0x01,0xFF,0x02,0x01,0x01,0x30,0x0E,0x06,0x03,0x55,0x1D,0x0F,0x01
		,0x01,0xFF,0x04,0x04,0x03,0x02,0x02,0x04,0x30,0x1D,0x06,0x03,0x55,0x1D,0x0E,0x04
		,0x16,0x04,0x14,0x55,0xC9,0x18,0xF8,0x8F,0x06,0xD1,0x8A,0xB5,0xE0,0xC1,0xFC,0x3B
		,0x55,0x39,0xE9,0xDE,0xA4,0x3C,0x88,0x30,0x36,0x06,0x09,0x2A,0x86,0x48,0x86,0xF7
		,0x0D,0x01,0x01,0x0A,0x30,0x29,0x30,0x09,0x06,0x05,0x2B,0x0E,0x03,0x02,0x1A,0x05
		,0x00,0x30,0x16,0x06,0x09,0x2A,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01,0x08,0x30,0x09
		,0x06,0x05,0x2B,0x0E,0x03,0x02,0x1A,0x05,0x00,0x02,0x01,0x14,0x02,0x01,0x01,0x03
		,0x82,0x01,0x01,0x00,0x1A,0x43,0x9F,0x48,0x3C,0xDA,0xCF,0x56,0xA6,0x86,0xD4,0xC8
		,0x2F,0xD3,0xE4,0x67,0xBC,0xEC,0x60,0x96,0x8E,0x3C,0xF1,0xF5,0xC7,0x10,0x78,0x53
		,0xED,0xB4,0xC0,0x92,0x0E,0xB9,0x2C,0x5E,0x5F,0xF4,0xF9,0x03,0xA5,0xF6,0xEF,0x35
		,0xD7,0x40,0x26,0x65,0xAE,0xEE,0x89,0xB4,0xD3,0x72,0x58,0x3D,0x6A,0x5E,0xE0,0xF0
		,0x3E,0xAE,0x29,0xD6,0xA4,0xBA,0xCA,0x10,0x9A,0x6D,0x0C,0x60,0xC8,0x25,0xD5,0x77
		,0x02,0xF8,0xE1,0x75,0xE1,0x63,0x6B,0x70,0xE6,0xC8,0x02,0x1A,0xBA,0xEB,0xAB,0x84
		,0x99,0xEF,0x2E,0x02,0xB4,0x94,0x48,0x0F,0xA8,0xBC,0x31,0xA4,0x2C,0xBC,0x7F,0x1F
		,0xEE,0x86,0x14,0x74,0xF3,0xFD,0xB4,0xC4,0x46,0xB1,0x12,0x4A,0xCA,0x6D,0xC7,0x6F
		,0x3A,0x6E,0x75,0x8D,0xBF,0x17,0x92,0x0C,0xAD,0x01,0x9F,0x1D,0xC7,0x26,0xC2,0xA8
		,0x4C,0xE5,0x4B,0x98,0xCF,0x64,0x9C,0xF3,0xF7,0x68,0xFB,0xA2,0xFB,0xC1,0x1C,0xF7
		,0x51,0x96,0xD5,0x96,0x05,0xBD,0x7F,0x23,0x5B,0xEB,0x74,0xC2,0xF6,0x7C,0x95,0x00
		,0x1D,0x68,0xC0,0xA1,0xD3,0xE2,0x9F,0xA3,0xE8,0xE2,0x7B,0x14,0x7B,0x43,0x91,0xDE
		,0xB3,0x36,0xF2,0x52,0x55,0xF6,0x0C,0x19,0x71,0x46,0xF0,0x1F,0xD0,0x45,0x0D,0x9B
		,0xD7,0x5F,0xB9,0x4B,0x3C,0x03,0xCE,0xE9,0xF1,0xF6,0x23,0x84,0x16,0xFB,0xB4,0x9D
		,0xBC,0x7B,0xBF,0xA9,0x6C,0xD7,0x5C,0x27,0x9D,0xA9,0x58,0x63,0xB8,0x32,0x3B,0x5F
		,0x72,0x29,0x01,0xC1,0x0B,0x4A,0xE7,0xAA,0x31,0x22,0x81,0x45,0xF2,0xEC,0x06,0x9A
		,0xAA,0x3E,0xD2,0x77};
	unsigned char	Host_BrandCert[CI_MAX_CERT_LEN] =
	{
		#if 1 // from ciplusBrandACert.c
		0x30, 0x82, 0x04, 0x3D, 0x30, 0x82, 0x02, 0xFC, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x02, 0x10,
		0x04, 0x30, 0x36, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x29,
		0x30, 0x09, 0x06, 0x05, 0x2B, 0x0E, 0x03, 0x02, 0x1A, 0x05, 0x00, 0x30, 0x16, 0x06, 0x09, 0x2A,
		0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x08, 0x30, 0x09, 0x06, 0x05, 0x2B, 0x0E, 0x03, 0x02,
		0x1A, 0x05, 0x00, 0x02, 0x01, 0x14, 0x02, 0x01, 0x01, 0x30, 0x81, 0x9A, 0x31, 0x0B, 0x30, 0x09,
		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x46, 0x52, 0x31, 0x0C, 0x30, 0x0A, 0x06, 0x03, 0x55,
		0x04, 0x08, 0x0C, 0x03, 0x44, 0x31, 0x33, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x07,
		0x0C, 0x09, 0x4C, 0x61, 0x20, 0x43, 0x69, 0x6F, 0x74, 0x61, 0x74, 0x31, 0x25, 0x30, 0x23, 0x06,
		0x03, 0x55, 0x04, 0x0A, 0x0C, 0x1C, 0x2D, 0x2D, 0x20, 0x53, 0x6D, 0x61, 0x72, 0x44, 0x54, 0x56,
		0x20, 0x53, 0x41, 0x20, 0x2D, 0x2D, 0x2D, 0x20, 0x43, 0x49, 0x2B, 0x20, 0x52, 0x4F, 0x54, 0x20,
		0x2D, 0x2D, 0x31, 0x11, 0x30, 0x0F, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x0C, 0x08, 0x43, 0x49, 0x2B,
		0x20, 0x74, 0x65, 0x61, 0x6D, 0x31, 0x0D, 0x30, 0x0B, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x0C, 0x04,
		0x74, 0x65, 0x73, 0x74, 0x31, 0x20, 0x30, 0x1E, 0x06, 0x03, 0x55, 0x04, 0x03, 0x0C, 0x17, 0x43,
		0x49, 0x2B, 0x20, 0x72, 0x6F, 0x6F, 0x74, 0x20, 0x43, 0x41, 0x20, 0x43, 0x65, 0x72, 0x74, 0x69,
		0x66, 0x69, 0x63, 0x61, 0x74, 0x65, 0x30, 0x1E, 0x17, 0x0D, 0x30, 0x38, 0x30, 0x34, 0x31, 0x36,
		0x31, 0x34, 0x33, 0x31, 0x32, 0x31, 0x5A, 0x17, 0x0D, 0x30, 0x39, 0x30, 0x38, 0x32, 0x39, 0x31,
		0x34, 0x33, 0x31, 0x32, 0x31, 0x5A, 0x30, 0x6E, 0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04,
		0x06, 0x13, 0x02, 0x46, 0x52, 0x31, 0x0C, 0x30, 0x0A, 0x06, 0x03, 0x55, 0x04, 0x08, 0x0C, 0x03,
		0x44, 0x31, 0x33, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x07, 0x0C, 0x09, 0x4C, 0x61,
		0x20, 0x43, 0x69, 0x6F, 0x74, 0x61, 0x74, 0x31, 0x10, 0x30, 0x0E, 0x06, 0x03, 0x55, 0x04, 0x0A,
		0x0C, 0x07, 0x42, 0x72, 0x61, 0x6E, 0x64, 0x20, 0x41, 0x31, 0x0D, 0x30, 0x0B, 0x06, 0x03, 0x55,
		0x04, 0x0B, 0x0C, 0x04, 0x74, 0x65, 0x73, 0x74, 0x31, 0x1C, 0x30, 0x1A, 0x06, 0x03, 0x55, 0x04,
		0x03, 0x0C, 0x13, 0x43, 0x49, 0x2B, 0x20, 0x52, 0x4F, 0x54, 0x20, 0x66, 0x6F, 0x72, 0x20, 0x62,
		0x72, 0x61, 0x6E, 0x64, 0x20, 0x41, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86,
		0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0F, 0x00, 0x30, 0x82,
		0x01, 0x0A, 0x02, 0x82, 0x01, 0x01, 0x00, 0xB6, 0xBD, 0xDE, 0x45, 0x0D, 0xCD, 0x53, 0xA0, 0x56,
		0x36, 0xA8, 0x8C, 0x17, 0x0B, 0x9B, 0xE7, 0x24, 0xF2, 0xB1, 0x66, 0xAE, 0xF2, 0x7C, 0xAC, 0x21,
		0x12, 0x0B, 0xFA, 0x94, 0xEB, 0xDD, 0x9B, 0xDE, 0x05, 0x7F, 0xD7, 0x7A, 0x45, 0xBE, 0xF0, 0xB6,
		0x45, 0x92, 0xC4, 0x30, 0xC1, 0x23, 0x46, 0x63, 0x7B, 0x09, 0x44, 0x46, 0x28, 0x7F, 0x9C, 0x47,
		0x67, 0x14, 0x23, 0x7B, 0xBC, 0x01, 0x52, 0x3C, 0x58, 0x86, 0xF8, 0xC7, 0x67, 0x31, 0xB3, 0x64,
		0x7C, 0xC6, 0xE3, 0xF6, 0xA5, 0x9F, 0x67, 0x24, 0xD5, 0x2B, 0x8A, 0x2A, 0x06, 0x82, 0x7E, 0x9E,
		0xFE, 0x53, 0x09, 0x64, 0xEE, 0xFD, 0xB1, 0x78, 0xC0, 0x3A, 0x4D, 0xB2, 0x34, 0x87, 0x9E, 0x8C,
		0x1F, 0x83, 0x0B, 0xE5, 0xB7, 0x80, 0xD1, 0x48, 0x7D, 0xB7, 0x42, 0x0D, 0x6F, 0x1D, 0xA0, 0x2B,
		0xBE, 0x42, 0xFC, 0xED, 0xC0, 0xC4, 0x63, 0xE1, 0xD1, 0xBC, 0x5E, 0x34, 0x88, 0x5E, 0xDE, 0x55,
		0x42, 0x46, 0xDB, 0x8B, 0x38, 0xA6, 0xAA, 0xA9, 0x89, 0xAC, 0xC8, 0xC7, 0x66, 0xE2, 0x03, 0x61,
		0x6C, 0x36, 0xCE, 0x16, 0x02, 0x9C, 0xDC, 0x51, 0xA2, 0xA5, 0x0F, 0x6D, 0x73, 0xA9, 0xCC, 0x28,
		0x6C, 0x81, 0xFB, 0x25, 0x45, 0x2F, 0x53, 0xE9, 0xC7, 0x17, 0xE8, 0x64, 0xEF, 0x3D, 0xAE, 0x3A,
		0xCF, 0xA2, 0xDF, 0x3D, 0xEB, 0xED, 0xEC, 0x58, 0x7B, 0x8B, 0x9D, 0x03, 0x45, 0x77, 0xD9, 0xE6,
		0x91, 0x54, 0x5C, 0x98, 0x22, 0x26, 0xF0, 0x89, 0xCE, 0xFF, 0xCE, 0x52, 0xF3, 0x3D, 0x4E, 0xFD,
		0x68, 0x20, 0xE1, 0x8D, 0x85, 0xD7, 0x43, 0xC1, 0x55, 0xDE, 0x9F, 0x2B, 0xFD, 0xC3, 0xE1, 0xB5,
		0x97, 0x89, 0xC0, 0x81, 0xDD, 0xA7, 0x3C, 0x6D, 0xAE, 0x79, 0x30, 0x15, 0xF4, 0x0B, 0xAB, 0xF7,
		0xFC, 0x6A, 0xA5, 0x4A, 0xCD, 0x5C, 0xF1, 0x02, 0x03, 0x01, 0x00, 0x01, 0xA3, 0x66, 0x30, 0x64,
		0x30, 0x12, 0x06, 0x03, 0x55, 0x1D, 0x13, 0x01, 0x01, 0xFF, 0x04, 0x08, 0x30, 0x06, 0x01, 0x01,
		0xFF, 0x02, 0x01, 0x00, 0x30, 0x0E, 0x06, 0x03, 0x55, 0x1D, 0x0F, 0x01, 0x01, 0xFF, 0x04, 0x04,
		0x03, 0x02, 0x02, 0x04, 0x30, 0x1D, 0x06, 0x03, 0x55, 0x1D, 0x0E, 0x04, 0x16, 0x04, 0x14, 0x36,
		0xD1, 0xB3, 0xAA, 0xAF, 0x16, 0x0C, 0x03, 0xD9, 0xD0, 0x84, 0x55, 0x1C, 0xF6, 0x2C, 0xCC, 0x3E,
		0x74, 0xA3, 0x94, 0x30, 0x1F, 0x06, 0x03, 0x55, 0x1D, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14,
		0x55, 0xC9, 0x18, 0xF8, 0x8F, 0x06, 0xD1, 0x8A, 0xB5, 0xE0, 0xC1, 0xFC, 0x3B, 0x55, 0x39, 0xE9,
		0xDE, 0xA4, 0x3C, 0x88, 0x30, 0x36, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01,
		0x0A, 0x30, 0x29, 0x30, 0x09, 0x06, 0x05, 0x2B, 0x0E, 0x03, 0x02, 0x1A, 0x05, 0x00, 0x30, 0x16,
		0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x08, 0x30, 0x09, 0x06, 0x05, 0x2B,
		0x0E, 0x03, 0x02, 0x1A, 0x05, 0x00, 0x02, 0x01, 0x14, 0x02, 0x01, 0x01, 0x03, 0x82, 0x01, 0x01,
		0x00, 0xA3, 0xD7, 0x0A, 0xD8, 0x60, 0xD6, 0x75, 0x33, 0x7D, 0xC6, 0x92, 0x05, 0xE1, 0xBC, 0x14,
		0xF3, 0xAF, 0xF7, 0x20, 0xFF, 0x27, 0x0A, 0x94, 0x33, 0xF9, 0xA0, 0xD7, 0x97, 0xB9, 0xDF, 0x8B,
		0xB4, 0x85, 0x03, 0xF7, 0xF4, 0xE8, 0xFB, 0xE2, 0xA3, 0xF8, 0xBB, 0x90, 0x5B, 0xFF, 0xDC, 0x89,
		0xB0, 0x5F, 0x6B, 0x73, 0xC1, 0x80, 0x74, 0x6C, 0x80, 0x5A, 0x61, 0x10, 0x04, 0x10, 0x0F, 0x40,
		0xD1, 0x61, 0x33, 0x66, 0xD4, 0x06, 0x7C, 0xFF, 0xF8, 0x3F, 0x67, 0x9C, 0x3E, 0x1E, 0x7B, 0x21,
		0xC4, 0x2F, 0x8B, 0xFD, 0x38, 0xE3, 0x5E, 0x14, 0x48, 0xA7, 0xEC, 0x5E, 0xC9, 0x66, 0x52, 0xC4,
		0xE1, 0xB4, 0xC3, 0x5B, 0x26, 0xEE, 0x4F, 0x97, 0xC0, 0x1E, 0x37, 0xED, 0x65, 0x79, 0xB7, 0x50,
		0x56, 0xA8, 0x7F, 0x34, 0xCE, 0x4C, 0xB4, 0x59, 0x43, 0xA9, 0x8B, 0xD3, 0x86, 0x3F, 0x8F, 0x06,
		0x82, 0x5B, 0x8A, 0xFF, 0x57, 0x0F, 0x2C, 0xA6, 0x08, 0xB0, 0x65, 0xE0, 0xE9, 0xDD, 0x7A, 0x79,
		0xED, 0xA5, 0x98, 0x87, 0xC9, 0x4E, 0xA9, 0xF3, 0xA8, 0xAA, 0xFF, 0x8E, 0x2E, 0x51, 0x37, 0xD5,
		0xF5, 0xBD, 0x5B, 0x24, 0xE9, 0xE1, 0x93, 0xB8, 0x4B, 0xDC, 0xA3, 0x24, 0x5F, 0x29, 0x5B, 0x42,
		0x24, 0xA3, 0x26, 0x99, 0x24, 0x6D, 0xB7, 0x8C, 0x98, 0xD0, 0xC6, 0xA1, 0xF7, 0xB8, 0x03, 0xB3,
		0xB8, 0x9A, 0xB6, 0x8C, 0xEE, 0x3F, 0xE1, 0x14, 0x3F, 0x90, 0x09, 0x52, 0x50, 0x39, 0x9D, 0x10,
		0xD5, 0xA2, 0xEB, 0x1B, 0x75, 0xF4, 0xE4, 0xF1, 0xE6, 0xB7, 0xCC, 0xC3, 0xD9, 0x02, 0x14, 0x35,
		0x1F, 0x90, 0xCA, 0x28, 0x97, 0xCA, 0xF9, 0xFC, 0x35, 0x20, 0xDD, 0xFB, 0x9B, 0xB2, 0x62, 0x19,
		0x68, 0x6A, 0xAD, 0x6C, 0x01, 0xE3, 0xB0, 0x1B, 0x0B, 0x03, 0xBE, 0x34, 0x68, 0xF0, 0x49, 0xCC,
		0xDD
		#else // from ciplusBrandBCert.c
		 0x30,0x82,0x04,0x3D,0x30,0x82,0x02,0xFC,0xA0,0x03,0x02,0x01,0x02,0x02,0x02,0x10
		,0x05,0x30,0x36,0x06,0x09,0x2A,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01,0x0A,0x30,0x29
		,0x30,0x09,0x06,0x05,0x2B,0x0E,0x03,0x02,0x1A,0x05,0x00,0x30,0x16,0x06,0x09,0x2A
		,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01,0x08,0x30,0x09,0x06,0x05,0x2B,0x0E,0x03,0x02
		,0x1A,0x05,0x00,0x02,0x01,0x14,0x02,0x01,0x01,0x30,0x81,0x9A,0x31,0x0B,0x30,0x09
		,0x06,0x03,0x55,0x04,0x06,0x13,0x02,0x46,0x52,0x31,0x0C,0x30,0x0A,0x06,0x03,0x55
		,0x04,0x08,0x0C,0x03,0x44,0x31,0x33,0x31,0x12,0x30,0x10,0x06,0x03,0x55,0x04,0x07
		,0x0C,0x09,0x4C,0x61,0x20,0x43,0x69,0x6F,0x74,0x61,0x74,0x31,0x25,0x30,0x23,0x06
		,0x03,0x55,0x04,0x0A,0x0C,0x1C,0x2D,0x2D,0x20,0x53,0x6D,0x61,0x72,0x44,0x54,0x56
		,0x20,0x53,0x41,0x20,0x2D,0x2D,0x2D,0x20,0x43,0x49,0x2B,0x20,0x52,0x4F,0x54,0x20
		,0x2D,0x2D,0x31,0x11,0x30,0x0F,0x06,0x03,0x55,0x04,0x0B,0x0C,0x08,0x43,0x49,0x2B
		,0x20,0x74,0x65,0x61,0x6D,0x31,0x0D,0x30,0x0B,0x06,0x03,0x55,0x04,0x0B,0x0C,0x04
		,0x74,0x65,0x73,0x74,0x31,0x20,0x30,0x1E,0x06,0x03,0x55,0x04,0x03,0x0C,0x17,0x43
		,0x49,0x2B,0x20,0x72,0x6F,0x6F,0x74,0x20,0x43,0x41,0x20,0x43,0x65,0x72,0x74,0x69
		,0x66,0x69,0x63,0x61,0x74,0x65,0x30,0x1E,0x17,0x0D,0x30,0x38,0x30,0x34,0x31,0x36
		,0x31,0x34,0x33,0x33,0x34,0x31,0x5A,0x17,0x0D,0x30,0x39,0x30,0x38,0x32,0x39,0x31
		,0x34,0x33,0x33,0x34,0x31,0x5A,0x30,0x6E,0x31,0x0B,0x30,0x09,0x06,0x03,0x55,0x04
		,0x06,0x13,0x02,0x46,0x52,0x31,0x0C,0x30,0x0A,0x06,0x03,0x55,0x04,0x08,0x0C,0x03
		,0x44,0x31,0x33,0x31,0x12,0x30,0x10,0x06,0x03,0x55,0x04,0x07,0x0C,0x09,0x4C,0x61
		,0x20,0x43,0x69,0x6F,0x74,0x61,0x74,0x31,0x10,0x30,0x0E,0x06,0x03,0x55,0x04,0x0A
		,0x0C,0x07,0x42,0x72,0x61,0x6E,0x64,0x20,0x42,0x31,0x0D,0x30,0x0B,0x06,0x03,0x55
		,0x04,0x0B,0x0C,0x04,0x74,0x65,0x73,0x74,0x31,0x1C,0x30,0x1A,0x06,0x03,0x55,0x04
		,0x03,0x0C,0x13,0x43,0x49,0x2B,0x20,0x52,0x4F,0x54,0x20,0x66,0x6F,0x72,0x20,0x62
		,0x72,0x61,0x6E,0x64,0x20,0x42,0x30,0x82,0x01,0x22,0x30,0x0D,0x06,0x09,0x2A,0x86
		,0x48,0x86,0xF7,0x0D,0x01,0x01,0x01,0x05,0x00,0x03,0x82,0x01,0x0F,0x00,0x30,0x82
		,0x01,0x0A,0x02,0x82,0x01,0x01,0x00,0xAF,0x4F,0x8A,0x97,0xDE,0x96,0x20,0x6E,0x10
		,0x0E,0xEE,0xDA,0xB7,0x0E,0xC0,0x26,0x34,0xAA,0xAA,0xE7,0xBF,0xFF,0x38,0xF4,0xBA
		,0xC4,0xDF,0xD6,0x69,0xDB,0x93,0x63,0x7D,0x0E,0x72,0x17,0x43,0xBD,0x0B,0x41,0x4C
		,0x3F,0xEC,0x84,0x41,0x8A,0x18,0xFD,0x15,0xBB,0x09,0xE5,0x1F,0xFD,0xEF,0x36,0x84
		,0x6E,0xF5,0x6F,0x20,0x9D,0x9A,0x74,0x8C,0x5B,0x7C,0x35,0x3B,0x62,0x1F,0x95,0xB6
		,0x8B,0x98,0xDA,0x4E,0x31,0x35,0x6F,0xCD,0x5D,0x7B,0xC8,0x39,0x1C,0x6A,0x62,0x29
		,0x58,0xAE,0x19,0xC7,0xC3,0xF9,0xF8,0xDF,0x67,0x0C,0x8D,0xD6,0x16,0x11,0x7F,0x9D
		,0xB5,0x30,0x2F,0xEB,0xE4,0xC2,0x42,0xBD,0x95,0x09,0xC2,0x56,0x54,0x82,0x93,0xED
		,0xD5,0x81,0xD9,0x82,0x41,0xD0,0x60,0x21,0xD7,0x95,0xA0,0x64,0x7C,0xCC,0x70,0x79
		,0xDD,0xA5,0xFF,0xA0,0x96,0xEE,0xAC,0x0A,0xED,0x0D,0xBB,0x48,0x69,0x50,0x14,0xF2
		,0x40,0x9C,0x18,0x7B,0xE6,0xE2,0x02,0x7B,0x02,0xF4,0x57,0x94,0x9B,0xF0,0xF9,0x47
		,0x75,0xA8,0x34,0xBE,0x3D,0xA6,0xC8,0x3F,0xA0,0xC8,0xAC,0xE3,0x8A,0x39,0xC4,0xBC
		,0xC7,0x6B,0x73,0xCF,0x6E,0x45,0xA4,0x36,0x63,0x2F,0x7F,0xDB,0x1A,0x8F,0xB9,0x29
		,0xAC,0x74,0x93,0xAF,0xA1,0x30,0x9A,0x8A,0x3B,0x39,0xD7,0x5F,0x76,0x15,0x49,0x52
		,0x99,0x79,0xFB,0xBA,0x44,0x83,0x52,0xC1,0x79,0x2A,0xAF,0x30,0xC9,0x9D,0x87,0xF0
		,0xFF,0xD4,0xB4,0xF3,0xCE,0x7D,0xCC,0x95,0x87,0x4C,0xB6,0x00,0x86,0x0B,0x19,0xD3
		,0x1F,0xCC,0xDC,0x22,0x7E,0x14,0xF7,0x02,0x03,0x01,0x00,0x01,0xA3,0x66,0x30,0x64
		,0x30,0x12,0x06,0x03,0x55,0x1D,0x13,0x01,0x01,0xFF,0x04,0x08,0x30,0x06,0x01,0x01
		,0xFF,0x02,0x01,0x00,0x30,0x0E,0x06,0x03,0x55,0x1D,0x0F,0x01,0x01,0xFF,0x04,0x04
		,0x03,0x02,0x02,0x04,0x30,0x1D,0x06,0x03,0x55,0x1D,0x0E,0x04,0x16,0x04,0x14,0x33
		,0x30,0xF0,0x89,0x99,0x49,0x0E,0xA1,0x47,0xD9,0x6F,0x5D,0xB2,0x00,0x86,0x61,0x56
		,0x01,0x0F,0xEA,0x30,0x1F,0x06,0x03,0x55,0x1D,0x23,0x04,0x18,0x30,0x16,0x80,0x14
		,0x55,0xC9,0x18,0xF8,0x8F,0x06,0xD1,0x8A,0xB5,0xE0,0xC1,0xFC,0x3B,0x55,0x39,0xE9
		,0xDE,0xA4,0x3C,0x88,0x30,0x36,0x06,0x09,0x2A,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01
		,0x0A,0x30,0x29,0x30,0x09,0x06,0x05,0x2B,0x0E,0x03,0x02,0x1A,0x05,0x00,0x30,0x16
		,0x06,0x09,0x2A,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01,0x08,0x30,0x09,0x06,0x05,0x2B
		,0x0E,0x03,0x02,0x1A,0x05,0x00,0x02,0x01,0x14,0x02,0x01,0x01,0x03,0x82,0x01,0x01
		,0x00,0x25,0x7F,0x53,0x11,0x52,0x9D,0x4D,0x71,0x08,0x2A,0x39,0xEA,0x1E,0x3B,0x86
		,0x3F,0x09,0x55,0xD8,0x97,0xED,0x08,0x48,0xF9,0x21,0x2E,0x0B,0x98,0x83,0x18,0x22
		,0xD4,0xE8,0x4D,0xC4,0x9A,0xF0,0x4C,0x70,0x9F,0xAA,0x29,0xD4,0x9D,0x23,0xBB,0xDE
		,0x21,0xFE,0x8C,0xA7,0xE8,0x83,0x09,0x5B,0x08,0xD9,0xDA,0x10,0xD1,0xEE,0xB8,0x23
		,0xA9,0x59,0x97,0x76,0xCB,0x9B,0xF0,0x3C,0xE9,0xAD,0x38,0xED,0x7D,0x19,0xCA,0xEB
		,0x60,0x9C,0x39,0x68,0xE0,0x2B,0xED,0x8E,0x1C,0x9E,0x60,0xC6,0xA7,0x84,0x23,0xF7
		,0x39,0x53,0xAB,0xAB,0x14,0x08,0xE5,0x57,0x43,0xDF,0x7A,0xEE,0xE1,0x21,0x4C,0xF0
		,0xD7,0xFB,0x9A,0xDC,0xE4,0x3C,0x0B,0x91,0x92,0x5E,0x3D,0xEA,0x05,0x5F,0xCE,0xF0
		,0xD3,0xF2,0x7A,0x15,0x05,0x69,0x46,0xEA,0xD8,0x6B,0xBA,0xBA,0xEA,0x8C,0xB5,0x01
		,0x94,0x05,0xFC,0x82,0x32,0xA9,0x24,0xB7,0x68,0x18,0x95,0x66,0x04,0x17,0x56,0x4D
		,0x58,0x28,0xDB,0x88,0x51,0xC8,0x2B,0xAA,0xB9,0x7C,0xBB,0xB8,0x9C,0x3D,0xAF,0xB8
		,0x54,0xA1,0xB9,0x17,0x34,0xEE,0x63,0x7D,0xA8,0x02,0x60,0x0B,0x88,0x0D,0xCF,0xFF
		,0xAB,0xCC,0xB7,0x7D,0x0E,0xA4,0x27,0x00,0xE8,0xE7,0x37,0xD8,0x1F,0x88,0x67,0x18
		,0xF4,0xD0,0x22,0x2E,0x22,0x58,0xF5,0x2E,0x8C,0x29,0x0D,0x56,0xC6,0x2F,0x14,0x00
		,0xB8,0x44,0xB3,0x10,0x12,0x5A,0xFA,0x56,0x13,0x3D,0xE6,0xEA,0xC0,0x6A,0xE7,0x87
		,0x2E,0x93,0xC3,0xB4,0x87,0x11,0x9A,0x99,0x28,0xCD,0x34,0xD0,0x34,0x7A,0x52,0xEB
		,0xA7
		#endif
	};
	unsigned char	Host_DevCert[CI_MAX_CERT_LEN] =
	{
		#if 1 // from ciplusDevice1Cert.c (1045 bytes)
		0x30, 0x82, 0x04, 0x11, 0x30, 0x82, 0x02, 0xD0, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x02, 0x20,
		0x03, 0x30, 0x36, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x29,
		0x30, 0x09, 0x06, 0x05, 0x2B, 0x0E, 0x03, 0x02, 0x1A, 0x05, 0x00, 0x30, 0x16, 0x06, 0x09, 0x2A,
		0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x08, 0x30, 0x09, 0x06, 0x05, 0x2B, 0x0E, 0x03, 0x02,
		0x1A, 0x05, 0x00, 0x02, 0x01, 0x14, 0x02, 0x01, 0x01, 0x30, 0x6E, 0x31, 0x0B, 0x30, 0x09, 0x06,
		0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x46, 0x52, 0x31, 0x0C, 0x30, 0x0A, 0x06, 0x03, 0x55, 0x04,
		0x08, 0x0C, 0x03, 0x44, 0x31, 0x33, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x07, 0x0C,
		0x09, 0x4C, 0x61, 0x20, 0x43, 0x69, 0x6F, 0x74, 0x61, 0x74, 0x31, 0x10, 0x30, 0x0E, 0x06, 0x03,
		0x55, 0x04, 0x0A, 0x0C, 0x07, 0x42, 0x72, 0x61, 0x6E, 0x64, 0x20, 0x41, 0x31, 0x0D, 0x30, 0x0B,
		0x06, 0x03, 0x55, 0x04, 0x0B, 0x0C, 0x04, 0x74, 0x65, 0x73, 0x74, 0x31, 0x1C, 0x30, 0x1A, 0x06,
		0x03, 0x55, 0x04, 0x03, 0x0C, 0x13, 0x43, 0x49, 0x2B, 0x20, 0x52, 0x4F, 0x54, 0x20, 0x66, 0x6F,
		0x72, 0x20, 0x62, 0x72, 0x61, 0x6E, 0x64, 0x20, 0x41, 0x30, 0x1E, 0x17, 0x0D, 0x30, 0x38, 0x30,
		0x34, 0x31, 0x36, 0x31, 0x34, 0x35, 0x37, 0x33, 0x36, 0x5A, 0x17, 0x0D, 0x30, 0x39, 0x30, 0x38,
		0x32, 0x39, 0x31, 0x34, 0x35, 0x37, 0x33, 0x36, 0x5A, 0x30, 0x7B, 0x31, 0x0B, 0x30, 0x09, 0x06,
		0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x46, 0x52, 0x31, 0x0C, 0x30, 0x0A, 0x06, 0x03, 0x55, 0x04,
		0x08, 0x0C, 0x03, 0x44, 0x31, 0x33, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x07, 0x0C,
		0x09, 0x4C, 0x61, 0x20, 0x43, 0x69, 0x6F, 0x74, 0x61, 0x74, 0x31, 0x10, 0x30, 0x0E, 0x06, 0x03,
		0x55, 0x04, 0x0A, 0x0C, 0x07, 0x42, 0x72, 0x61, 0x6E, 0x64, 0x20, 0x41, 0x31, 0x0E, 0x30, 0x0C,
		0x06, 0x03, 0x55, 0x04, 0x0B, 0x0C, 0x05, 0x54, 0x56, 0x20, 0x23, 0x31, 0x31, 0x0D, 0x30, 0x0B,
		0x06, 0x03, 0x55, 0x04, 0x0B, 0x0C, 0x04, 0x74, 0x65, 0x73, 0x74, 0x31, 0x19, 0x30, 0x17, 0x06,
		0x03, 0x55, 0x04, 0x03, 0x0C, 0x10, 0x41, 0x42, 0x32, 0x45, 0x35, 0x41, 0x30, 0x31, 0x33, 0x33,
		0x30, 0x32, 0x43, 0x31, 0x46, 0x33, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86,
		0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0F, 0x00, 0x30, 0x82,
		0x01, 0x0A, 0x02, 0x82, 0x01, 0x01, 0x00, 0xB1, 0x4E, 0xCE, 0x0D, 0x1D, 0x57, 0x10, 0x8B, 0xE4,
		0x8C, 0xD5, 0x6E, 0x3F, 0xAD, 0x70, 0xF3, 0xBF, 0xCC, 0xD8, 0x28, 0x72, 0x37, 0xB4, 0xF0, 0x3E,
		0x2E, 0xCA, 0x6A, 0xF8, 0x5D, 0x29, 0x0E, 0x7B, 0x60, 0x14, 0x25, 0xB3, 0xA2, 0x65, 0xB6, 0xE7,
		0xED, 0xF0, 0x37, 0xC9, 0xA8, 0x2E, 0x50, 0x07, 0x07, 0x2E, 0x29, 0x81, 0xA7, 0x96, 0x32, 0x65,
		0xBA, 0xA4, 0x45, 0x97, 0x19, 0xFA, 0xFA, 0x20, 0xD5, 0x8F, 0x63, 0x3B, 0xF5, 0x58, 0xB6, 0x8A,
		0xDD, 0x15, 0x2A, 0xB0, 0x12, 0xF4, 0x9A, 0xB6, 0xB1, 0xD1, 0x63, 0x77, 0x85, 0x58, 0xD8, 0x8C,
		0xB1, 0x0F, 0x21, 0x8D, 0x0F, 0xF6, 0xA4, 0xFB, 0x4B, 0xAB, 0xB5, 0xEA, 0xDC, 0x4F, 0xE9, 0xC5,
		0xC3, 0xD9, 0xD6, 0xC2, 0x94, 0x5B, 0xD9, 0x10, 0xBA, 0xB3, 0xC7, 0x6A, 0xC3, 0xBA, 0xC8, 0xCE,
		0xEA, 0xCD, 0xD4, 0x42, 0x90, 0xDC, 0xC6, 0x12, 0x69, 0x4F, 0xAF, 0x58, 0xE7, 0x6D, 0x82, 0xD9,
		0xA1, 0xA8, 0x3C, 0x6A, 0xFA, 0x29, 0x3B, 0x7D, 0x52, 0x44, 0xB2, 0xFF, 0xA3, 0x30, 0xB9, 0x2E,
		0xA2, 0x55, 0xDC, 0x31, 0x22, 0xD3, 0xFD, 0x69, 0xD9, 0xE9, 0x4F, 0xD1, 0x34, 0x2E, 0xF5, 0x8F,
		0xB9, 0x42, 0x8E, 0x35, 0xB6, 0x20, 0x69, 0xED, 0xC4, 0xD6, 0x7C, 0xEF, 0x12, 0x38, 0xA4, 0x81,
		0xED, 0x09, 0x83, 0xAF, 0x54, 0xC2, 0xB1, 0xDE, 0xD9, 0x53, 0x8E, 0x49, 0x09, 0xA5, 0xEA, 0xC2,
		0xC8, 0x9C, 0x9F, 0xF4, 0x49, 0x99, 0xE9, 0x99, 0x89, 0x94, 0xB8, 0x01, 0x65, 0xE5, 0x78, 0xF2,
		0xCC, 0xA8, 0x6F, 0x57, 0xC3, 0xD5, 0x89, 0x89, 0x14, 0xAE, 0x64, 0x39, 0xAC, 0xBF, 0xCA, 0xE0,
		0x97, 0x73, 0xE4, 0xB0, 0xAA, 0x27, 0x98, 0x08, 0x41, 0x69, 0x76, 0xAA, 0x35, 0x73, 0x6C, 0x3F,
		0x2F, 0x0E, 0xFA, 0x38, 0x63, 0xB2, 0xE7, 0x02, 0x03, 0x01, 0x00, 0x01, 0xA3, 0x5A, 0x30, 0x58,
		0x30, 0x0C, 0x06, 0x03, 0x55, 0x1D, 0x13, 0x01, 0x01, 0xFF, 0x04, 0x02, 0x30, 0x00, 0x30, 0x0E,
		0x06, 0x03, 0x55, 0x1D, 0x0F, 0x01, 0x01, 0xFF, 0x04, 0x04, 0x03, 0x02, 0x07, 0x80, 0x30, 0x1F,
		0x06, 0x03, 0x55, 0x1D, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0x36, 0xD1, 0xB3, 0xAA, 0xAF,
		0x16, 0x0C, 0x03, 0xD9, 0xD0, 0x84, 0x55, 0x1C, 0xF6, 0x2C, 0xCC, 0x3E, 0x74, 0xA3, 0x94, 0x30,
		0x17, 0x06, 0x08, 0x2B, 0x06, 0x01, 0x05, 0x05, 0x07, 0x01, 0x19, 0x01, 0x01, 0xFF, 0x04, 0x08,
		0x30, 0x06, 0x02, 0x01, 0x01, 0x02, 0x01, 0x01, 0x30, 0x36, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86,
		0xF7, 0x0D, 0x01, 0x01, 0x0A, 0x30, 0x29, 0x30, 0x09, 0x06, 0x05, 0x2B, 0x0E, 0x03, 0x02, 0x1A,
		0x05, 0x00, 0x30, 0x16, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x08, 0x30,
		0x09, 0x06, 0x05, 0x2B, 0x0E, 0x03, 0x02, 0x1A, 0x05, 0x00, 0x02, 0x01, 0x14, 0x02, 0x01, 0x01,
		0x03, 0x82, 0x01, 0x01, 0x00, 0x96, 0x76, 0x75, 0x9A, 0x2C, 0x87, 0x9E, 0x47, 0xBB, 0x5C, 0xD4,
		0x0D, 0x5B, 0xFD, 0x41, 0xFF, 0x57, 0x3B, 0xB1, 0x1A, 0x0B, 0x24, 0x89, 0xD9, 0xE7, 0x38, 0xAB,
		0xC6, 0x88, 0x45, 0x2E, 0x6C, 0xE7, 0x04, 0x3B, 0x69, 0x96, 0x2D, 0xD0, 0x6E, 0xBB, 0x3D, 0x9E,
		0x0D, 0x8D, 0x24, 0x3F, 0x6B, 0xD7, 0x33, 0x43, 0xA5, 0x21, 0x30, 0x80, 0xE5, 0x3B, 0x02, 0x70,
		0x20, 0xC0, 0x32, 0x21, 0xC5, 0xAB, 0x2B, 0x4F, 0xAB, 0xD0, 0x95, 0xA4, 0xD1, 0x41, 0x3B, 0x88,
		0x6F, 0x58, 0x92, 0xE0, 0x7E, 0x15, 0x36, 0x7C, 0x6A, 0xAC, 0x86, 0xD1, 0xAF, 0xAB, 0x40, 0x09,
		0xC0, 0xEF, 0x6E, 0x8F, 0x3D, 0xC5, 0xE4, 0x2C, 0x6F, 0xBD, 0x96, 0x25, 0x0C, 0xF7, 0x18, 0xEB,
		0x32, 0x2B, 0x44, 0x47, 0x03, 0x73, 0xF4, 0x2C, 0x28, 0x31, 0xAA, 0x50, 0x01, 0x56, 0xA3, 0xF5,
		0xA1, 0xE1, 0x50, 0x50, 0xB6, 0x6A, 0x7A, 0xDE, 0x23, 0x69, 0x40, 0x4C, 0x42, 0xB5, 0x03, 0x39,
		0x66, 0x74, 0x73, 0x60, 0xC9, 0x9B, 0x77, 0x00, 0x5F, 0x3A, 0xB6, 0x4D, 0xC3, 0x19, 0xAC, 0x8B,
		0x06, 0xE4, 0x1A, 0xB7, 0x73, 0xD3, 0x11, 0xD1, 0xD7, 0xF4, 0xF7, 0x7F, 0x33, 0x78, 0xF4, 0xB9,
		0x93, 0x79, 0xC1, 0xDB, 0xBC, 0x41, 0x6B, 0xF2, 0x65, 0xEE, 0x03, 0xEF, 0xF1, 0x9A, 0x44, 0x2E,
		0xBB, 0x7E, 0x93, 0x68, 0x40, 0xA8, 0x27, 0x08, 0x7B, 0x1C, 0x68, 0x74, 0xCC, 0x0E, 0xC7, 0x10,
		0xAB, 0x08, 0xF3, 0x8A, 0x90, 0x7F, 0x6F, 0xE2, 0x6D, 0x0B, 0x7F, 0x9E, 0x19, 0x9A, 0x37, 0x90,
		0xC5, 0x11, 0xED, 0x15, 0xD2, 0x69, 0x57, 0xA0, 0x1A, 0x80, 0xA7, 0x77, 0xAB, 0xDA, 0xC0, 0x85,
		0x1C, 0xCB, 0xF0, 0x3A, 0xA4, 0x2C, 0x78, 0xBD, 0x01, 0xB6, 0x15, 0xDF, 0x7C, 0x7C, 0xBF, 0x2C,
		0xA6, 0xB6, 0xED, 0x95, 0x00
		#else // from ciplusDevice2Cert.c (1051 bytes)
		 0x30,0x82,0x04,0x17,0x30,0x82,0x02,0xD6,0xA0,0x03,0x02,0x01,0x02,0x02,0x02,0x30
		,0x0E,0x30,0x36,0x06,0x09,0x2A,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01,0x0A,0x30,0x29
		,0x30,0x09,0x06,0x05,0x2B,0x0E,0x03,0x02,0x1A,0x05,0x00,0x30,0x16,0x06,0x09,0x2A
		,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01,0x08,0x30,0x09,0x06,0x05,0x2B,0x0E,0x03,0x02
		,0x1A,0x05,0x00,0x02,0x01,0x14,0x02,0x01,0x01,0x30,0x6E,0x31,0x0B,0x30,0x09,0x06
		,0x03,0x55,0x04,0x06,0x13,0x02,0x46,0x52,0x31,0x0C,0x30,0x0A,0x06,0x03,0x55,0x04
		,0x08,0x0C,0x03,0x44,0x31,0x33,0x31,0x12,0x30,0x10,0x06,0x03,0x55,0x04,0x07,0x0C
		,0x09,0x4C,0x61,0x20,0x43,0x69,0x6F,0x74,0x61,0x74,0x31,0x10,0x30,0x0E,0x06,0x03
		,0x55,0x04,0x0A,0x0C,0x07,0x42,0x72,0x61,0x6E,0x64,0x20,0x42,0x31,0x0D,0x30,0x0B
		,0x06,0x03,0x55,0x04,0x0B,0x0C,0x04,0x74,0x65,0x73,0x74,0x31,0x1C,0x30,0x1A,0x06
		,0x03,0x55,0x04,0x03,0x0C,0x13,0x43,0x49,0x2B,0x20,0x52,0x4F,0x54,0x20,0x66,0x6F
		,0x72,0x20,0x62,0x72,0x61,0x6E,0x64,0x20,0x42,0x30,0x1E,0x17,0x0D,0x30,0x38,0x30
		,0x34,0x31,0x36,0x31,0x34,0x35,0x37,0x34,0x36,0x5A,0x17,0x0D,0x30,0x39,0x30,0x38
		,0x32,0x39,0x31,0x34,0x35,0x37,0x34,0x36,0x5A,0x30,0x6C,0x31,0x0B,0x30,0x09,0x06
		,0x03,0x55,0x04,0x06,0x13,0x02,0x46,0x52,0x31,0x0C,0x30,0x0A,0x06,0x03,0x55,0x04
		,0x08,0x0C,0x03,0x44,0x31,0x33,0x31,0x12,0x30,0x10,0x06,0x03,0x55,0x04,0x07,0x0C
		,0x09,0x4C,0x61,0x20,0x43,0x69,0x6F,0x74,0x61,0x74,0x31,0x10,0x30,0x0E,0x06,0x03
		,0x55,0x04,0x0A,0x0C,0x07,0x42,0x72,0x61,0x6E,0x64,0x20,0x42,0x31,0x0E,0x30,0x0C
		,0x06,0x03,0x55,0x04,0x0B,0x0C,0x05,0x54,0x56,0x20,0x23,0x32,0x31,0x19,0x30,0x17
		,0x06,0x03,0x55,0x04,0x03,0x0C,0x10,0x31,0x41,0x42,0x43,0x32,0x38,0x33,0x30,0x31
		,0x36,0x45,0x32,0x44,0x30,0x38,0x31,0x30,0x82,0x01,0x22,0x30,0x0D,0x06,0x09,0x2A
		,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01,0x01,0x05,0x00,0x03,0x82,0x01,0x0F,0x00,0x30
		,0x82,0x01,0x0A,0x02,0x82,0x01,0x01,0x00,0xC9,0xFE,0x66,0xFF,0x7F,0x3A,0xB4,0xD3
		,0xF0,0xA3,0x1C,0x8E,0x45,0x6E,0xA3,0x45,0xAE,0x9B,0x95,0xCD,0x2B,0x9E,0xBC,0x86
		,0x6B,0x91,0x4D,0x30,0x3B,0x4A,0x3A,0x55,0x2D,0xD6,0xF6,0x7D,0xD7,0xFC,0x87,0x61
		,0x8B,0xBD,0xF1,0x4C,0x92,0xDD,0x27,0xE9,0x4E,0x5C,0x0C,0x79,0x85,0xB7,0x64,0x46
		,0xA3,0x6C,0x27,0x7F,0xAB,0xE2,0x11,0xF8,0xAF,0x71,0x90,0x4C,0xA0,0x7C,0xB2,0x80
		,0x69,0x94,0xC7,0x1A,0x32,0x6C,0x5C,0x29,0xA0,0x75,0x43,0x6A,0xCC,0x50,0x0C,0x69
		,0xBD,0x25,0xF5,0x7D,0x76,0x10,0xCD,0x97,0x73,0x81,0xB3,0x94,0xFE,0x56,0xB5,0x3F
		,0x4B,0xA8,0xCD,0x3F,0x34,0xB5,0xE0,0x45,0x2E,0x4C,0x5E,0x65,0x9D,0x6D,0xD3,0x83
		,0x00,0xD8,0xA9,0x10,0xEE,0xA4,0xBF,0x0F,0xE0,0xBE,0xFB,0x5C,0x55,0x78,0x5D,0xDB
		,0x53,0xD3,0xF3,0xCB,0xC9,0x0D,0xD8,0xB6,0xD9,0xB4,0x12,0x53,0x2F,0xB6,0x3F,0xBF
		,0xF8,0xE6,0x93,0xBA,0x92,0x71,0xE3,0xAA,0xA0,0x0C,0x29,0xE5,0x58,0xA0,0x74,0xFE
		,0x5A,0x22,0x67,0x72,0x87,0x7E,0x09,0xCA,0x07,0xDB,0x85,0x67,0x2B,0x14,0x69,0x1E
		,0x93,0x69,0x64,0x08,0x2F,0x10,0x5F,0x9B,0x36,0xD9,0xA7,0xDA,0x44,0x39,0xE7,0x5C
		,0xDE,0x64,0x2A,0x60,0x96,0x28,0x94,0xEA,0x70,0xFD,0x6F,0x5D,0x9E,0xCF,0x7B,0xCA
		,0xEF,0x16,0xAE,0x38,0x74,0x7D,0x3E,0x7B,0x03,0x12,0xFD,0x87,0xCE,0x75,0x1F,0x79
		,0xFB,0x94,0x81,0x23,0xB0,0x27,0x58,0x1D,0x26,0x7B,0xAB,0x45,0x6A,0x00,0x6C,0x41
		,0xDA,0x51,0xE2,0xA5,0xC6,0xF6,0xD5,0x07,0x02,0x03,0x01,0x00,0x01,0xA3,0x6F,0x30
		,0x6D,0x30,0x0C,0x06,0x03,0x55,0x1D,0x13,0x01,0x01,0xFF,0x04,0x02,0x30,0x00,0x30
		,0x0E,0x06,0x03,0x55,0x1D,0x0F,0x01,0x01,0xFF,0x04,0x04,0x03,0x02,0x07,0x80,0x30
		,0x1F,0x06,0x03,0x55,0x1D,0x23,0x04,0x18,0x30,0x16,0x80,0x14,0x36,0xD1,0xB3,0xAA
		,0xAF,0x16,0x0C,0x03,0xD9,0xD0,0x84,0x55,0x1C,0xF6,0x2C,0xCC,0x3E,0x74,0xA3,0x94
		,0x30,0x17,0x06,0x08,0x2B,0x06,0x01,0x05,0x05,0x07,0x01,0x19,0x01,0x01,0xFF,0x04
		,0x08,0x30,0x06,0x02,0x01,0x00,0x02,0x01,0x01,0x30,0x13,0x06,0x08,0x2B,0x06,0x01
		,0x05,0x05,0x07,0x01,0x1A,0x04,0x07,0x03,0x05,0x00,0xDE,0xAD,0xBE,0xEF,0x30,0x36
		,0x06,0x09,0x2A,0x86,0x48,0x86,0xF7,0x0D,0x01,0x01,0x0A,0x30,0x29,0x30,0x09,0x06
		,0x05,0x2B,0x0E,0x03,0x02,0x1A,0x05,0x00,0x30,0x16,0x06,0x09,0x2A,0x86,0x48,0x86
		,0xF7,0x0D,0x01,0x01,0x08,0x30,0x09,0x06,0x05,0x2B,0x0E,0x03,0x02,0x1A,0x05,0x00
		,0x02,0x01,0x14,0x02,0x01,0x01,0x03,0x82,0x01,0x01,0x00,0x62,0x9E,0x4A,0xB7,0x84
		,0x29,0x16,0xD9,0xA4,0x06,0x5C,0x7B,0xD1,0x49,0x99,0xFF,0x74,0x72,0x9B,0x9F,0x70
		,0xA3,0x1F,0x26,0x33,0x68,0xD7,0x90,0xC8,0x48,0xE4,0xD9,0x3A,0x48,0x21,0xFE,0xBA
		,0x53,0x44,0x79,0xB3,0x0A,0x94,0x58,0x2D,0x22,0x81,0xE5,0xBD,0x15,0xAE,0x51,0x09
		,0x22,0x8B,0xA3,0x48,0x82,0x96,0x63,0x4C,0x83,0xB2,0x34,0xCD,0x26,0x6F,0x2D,0x07
		,0x97,0x09,0xA1,0x68,0x68,0x34,0xA6,0x8E,0xA7,0x7C,0x98,0x00,0x36,0xBC,0x1A,0xF8
		,0x08,0x08,0x46,0xB0,0xF6,0x64,0x6D,0xCD,0x15,0x2C,0xBC,0x0C,0x75,0x72,0xCE,0xC2
		,0x7F,0xE3,0x64,0x5D,0x1D,0x97,0x15,0xDB,0xA1,0xF6,0x4D,0x30,0x4F,0x8D,0x29,0xC3
		,0x8A,0x2A,0xF4,0x3E,0xF2,0x9B,0x69,0x0E,0xC9,0xA8,0xEA,0xE4,0x0F,0x4C,0xD2,0x26
		,0xFE,0x48,0x3B,0x22,0xE2,0x9B,0x8C,0x43,0x54,0x55,0x56,0x4D,0xB9,0xD9,0xA9,0xC0
		,0x47,0xDE,0x8D,0x2B,0x4A,0x54,0xA2,0x65,0xC5,0x61,0x0B,0x78,0x8A,0xF0,0xFD,0x76
		,0x2E,0x4C,0xE6,0x0F,0xA1,0x52,0x55,0x61,0x67,0x2C,0x46,0xDD,0x6B,0x53,0x4D,0x84
		,0x06,0x0F,0x89,0x12,0x2C,0x0C,0x08,0xD4,0x2D,0x19,0x21,0x0A,0x24,0x3C,0x69,0x9B
		,0x45,0x23,0x60,0xD4,0xEA,0x82,0x32,0x8D,0xF1,0xC3,0xB6,0x74,0x1B,0x45,0xC3,0x9E
		,0xF3,0x69,0x04,0xE9,0x8D,0xB1,0x69,0x53,0xFD,0xCF,0x1F,0xE4,0x73,0x93,0xB3,0x54
		,0x2B,0x52,0xE4,0xA5,0x1F,0x49,0x92,0xD9,0x9E,0x73,0xB9,0x88,0xF0,0x16,0x7A,0x04
		,0xEE,0x30,0xBE,0xAD,0x42,0xF1,0xD2,0xFB,0x78,0xBB,0x14
		#endif
	};
	unsigned char	DH_p[CI_DH_P_LEN] = // from Credentials 문서
	{
		0xC8, 0x90, 0x97, 0xD9, 0x22, 0x16, 0x0E, 0x7E, 0x1D, 0xE9, 0x1A, 0xF7, 0x4E, 0x97, 0xEC, 0xF7,
		0x5F, 0xF2, 0x6E, 0xC7, 0xD5, 0x7B, 0xF3, 0xEC, 0x99, 0x15, 0xD2, 0x74, 0x64, 0x17, 0x10, 0xC4,
		0xF2, 0xFE, 0x2F, 0x94, 0xAE, 0x8F, 0xA6, 0x43, 0x8E, 0x0A, 0x00, 0x0F, 0x6D, 0x55, 0xB7, 0xF7,
		0x1E, 0x87, 0xE8, 0xD5, 0x58, 0xF1, 0xF5, 0x41, 0x76, 0x90, 0xD4, 0x3C, 0x5A, 0x1B, 0x1B, 0x01,
		0xF9, 0xB8, 0xBD, 0xD2, 0x05, 0xC0, 0x55, 0xBF, 0xC3, 0xE1, 0xF2, 0x2D, 0x26, 0x07, 0x0C, 0x19,
		0xB0, 0x6C, 0x9B, 0x8C, 0xAF, 0x48, 0x1A, 0x4B, 0x00, 0x29, 0xAE, 0xE4, 0xB2, 0xC1, 0x83, 0xA3,
		0x5C, 0xA4, 0x75, 0x4A, 0x2B, 0x06, 0x8F, 0xF8, 0x0F, 0x4F, 0x53, 0xC0, 0x95, 0x58, 0x4B, 0x01,
		0xEC, 0xE9, 0x94, 0x5A, 0x75, 0x22, 0x12, 0x31, 0xAE, 0x4D, 0x5A, 0xD1, 0xDF, 0x7E, 0x82, 0x8F,
		0x1B, 0x84, 0xED, 0x7D, 0xB4, 0x4B, 0xAB, 0xC6, 0xB6, 0xE7, 0x0B, 0x5A, 0x36, 0xB9, 0x21, 0x45,
		0x82, 0xF8, 0x6E, 0x92, 0x9E, 0xB0, 0x5E, 0xAB, 0x3D, 0xEA, 0x9C, 0x8E, 0x9B, 0xC9, 0x6E, 0x94,
		0x4B, 0xE6, 0x32, 0x2D, 0x71, 0x6D, 0x74, 0x88, 0x16, 0xAF, 0xFD, 0xA6, 0xE4, 0x60, 0x98, 0x8E,
		0xF5, 0xBF, 0x41, 0x66, 0x35, 0x55, 0xAC, 0xE4, 0xCC, 0xA6, 0xF4, 0xE1, 0x8F, 0x3B, 0xC4, 0xB3,
		0x2B, 0xAE, 0xFF, 0x8B, 0xFF, 0x3E, 0x21, 0xD8, 0x47, 0xF3, 0x4B, 0x75, 0x2B, 0xE8, 0x99, 0xA1,
		0x90, 0xC2, 0xF5, 0xCD, 0xD7, 0x11, 0xC3, 0x70, 0x69, 0x0F, 0xD0, 0xDE, 0x50, 0x56, 0x0C, 0x26,
		0x6A, 0xCC, 0xBB, 0x3F, 0x20, 0xCC, 0x80, 0xB4, 0x76, 0x5D, 0xA0, 0xC8, 0xD8, 0x3E, 0x5D, 0xC1,
		0x41, 0x85, 0x57, 0x19, 0xC3, 0xA7, 0xC6, 0x23, 0xCA, 0x89, 0x6B, 0x85, 0xAB, 0xA9, 0x88, 0x29
	};
	unsigned char	DH_g[CI_DH_G_LEN] = // from Credentials 문서
	{
		0x3B, 0x8C, 0x4C, 0xF4, 0x09, 0x17, 0x83, 0x5C, 0xE0, 0x14, 0xA0, 0xB7, 0x06, 0xC9, 0x2F, 0x05,
		0xFA, 0xC3, 0xB6, 0x0A, 0xE9, 0x96, 0x5A, 0x3F, 0x16, 0x78, 0x3A, 0xD5, 0xF8, 0x27, 0x80, 0x2E,
		0xFA, 0xC5, 0x9C, 0xEB, 0x80, 0xAA, 0x52, 0x57, 0xC7, 0xB9, 0x48, 0xBE, 0x78, 0xA8, 0x78, 0x25,
		0x94, 0x80, 0x6C, 0xDF, 0xEE, 0x42, 0x79, 0xA6, 0x93, 0xEC, 0xA1, 0xEA, 0xF7, 0xC2, 0x27, 0x8E,
		0x93, 0x4C, 0xFA, 0xA5, 0x6C, 0xC6, 0x31, 0xD2, 0xFA, 0x64, 0x3E, 0x68, 0xD1, 0xBA, 0xAD, 0x7B,
		0xFD, 0xCD, 0x25, 0xC7, 0x7D, 0xE2, 0xF6, 0xE9, 0xC2, 0xFF, 0x1A, 0x21, 0xE0, 0xA8, 0x52, 0xA6,
		0x8A, 0x01, 0xB1, 0xAB, 0x35, 0x1E, 0x6D, 0x87, 0x1D, 0x37, 0xA3, 0x3C, 0x96, 0x03, 0xBC, 0xFA,
		0x56, 0xD4, 0x77, 0x68, 0x3C, 0xC1, 0x8A, 0xE3, 0x54, 0xFB, 0x66, 0xF6, 0xC8, 0xC6, 0x91, 0x54,
		0x46, 0xEA, 0x88, 0x71, 0x8A, 0x25, 0x0B, 0x18, 0x7A, 0x25, 0x49, 0x84, 0xFF, 0x42, 0x45, 0xFD,
		0x0D, 0x28, 0xAE, 0x42, 0xD1, 0x8A, 0x01, 0x43, 0xDE, 0x56, 0x5C, 0xA1, 0xBB, 0xC2, 0x68, 0x05,
		0x54, 0x43, 0xAB, 0xC3, 0xE2, 0x25, 0xE4, 0x69, 0xF5, 0xB6, 0x99, 0x6C, 0x42, 0x0C, 0xB6, 0xF6,
		0x47, 0x59, 0x68, 0xD9, 0x65, 0x38, 0xB8, 0x2B, 0x48, 0x8A, 0x79, 0xFD, 0x3D, 0x6C, 0x56, 0x25,
		0x3A, 0xFB, 0xCD, 0xDD, 0x79, 0x44, 0xC2, 0xA8, 0x52, 0x3E, 0x03, 0x5A, 0x16, 0x4E, 0x20, 0x6B,
		0x44, 0xA7, 0x75, 0x00, 0xAD, 0x2C, 0xD5, 0x39, 0x62, 0x41, 0x21, 0x73, 0x36, 0xAB, 0xE1, 0x15,
		0x92, 0xCB, 0xAE, 0x91, 0x50, 0x0E, 0x4F, 0x08, 0x69, 0xD2, 0xF4, 0x62, 0xF0, 0x12, 0x28, 0xDA,
		0x56, 0x6B, 0xDF, 0x9F, 0xDD, 0xCF, 0x06, 0xA0, 0x87, 0x15, 0xDF, 0xD4, 0x5D, 0x74, 0x17, 0xE4
	};
	unsigned char	DH_q[CI_DH_Q_LEN] = // from Credentials 문서
	{
		0xF9, 0x4F, 0x97, 0x2C, 0x07, 0xAD, 0xB1, 0x95, 0x8E, 0xD1, 0xB7, 0x36, 0x41, 0xD0, 0x95, 0xC2,
		0x09, 0x27, 0x54, 0x7A, 0xDC, 0x9F, 0xE8, 0x95, 0x94, 0xEB, 0x79, 0x65, 0xB4, 0xBC, 0xC7, 0xD7
	};
	unsigned char	HDQ_d[CI_HDQ_D_LEN] = // from ciplusDevice1Key.c and ciplusDevice2Key.c
	{
		0x1F, 0x7D, 0x26, 0x5C, 0xEF, 0xE4, 0x01, 0x7D, 0x46, 0xB6, 0xB8, 0x44, 0xDF, 0x2C, 0x37, 0x4E,
		0x22, 0xB7, 0x07, 0x80, 0x8F, 0x60, 0x53, 0x53, 0x03, 0x48, 0x1E, 0x0C, 0xC7, 0x55, 0x0C, 0x30,
		0x95, 0x3A, 0xA7, 0xF9, 0x56, 0x20, 0xB6, 0x3D, 0xB8, 0x8C, 0xEA, 0x47, 0x8E, 0x19, 0xBF, 0x37,
		0xD9, 0x37, 0xAE, 0x3C, 0x12, 0xD9, 0xA7, 0x74, 0x05, 0xDB, 0x12, 0xC7, 0x85, 0x21, 0x49, 0x10,
		0x58, 0xFA, 0x74, 0x7F, 0xA4, 0x2B, 0x5B, 0x78, 0xF7, 0xCA, 0x71, 0xB2, 0xE6, 0x18, 0x47, 0xB6,
		0x9E, 0x51, 0x90, 0x25, 0x41, 0x19, 0xBE, 0x80, 0x9E, 0xE3, 0xE7, 0x13, 0x07, 0x51, 0x59, 0x75,
		0x4D, 0x67, 0xCF, 0xF3, 0xFB, 0xE4, 0xEA, 0x90, 0x52, 0xDE, 0x08, 0x76, 0xFA, 0x91, 0x8C, 0x8A,
		0x4D, 0x4D, 0x4B, 0x16, 0x54, 0x60, 0xB4, 0x70, 0x6B, 0x47, 0x0A, 0x0C, 0xF3, 0x51, 0x74, 0xD3,
		0xB0, 0xCC, 0xD2, 0x9D, 0x40, 0x08, 0xF0, 0x6E, 0x95, 0x2B, 0xAF, 0xC8, 0x55, 0x03, 0xD4, 0x9F,
		0x8E, 0x30, 0x78, 0xD5, 0xFE, 0xB6, 0x50, 0x66, 0x75, 0xC1, 0xA7, 0xAF, 0x6C, 0x73, 0x70, 0x1B,
		0xAB, 0x80, 0x50, 0xF9, 0x83, 0xEC, 0x2B, 0xC9, 0x29, 0x1D, 0x24, 0x0D, 0xE5, 0x5A, 0x73, 0xD4,
		0x6E, 0xE7, 0x2A, 0x1B, 0x3E, 0x75, 0x38, 0x3B, 0x60, 0xC0, 0x4A, 0xEA, 0xB2, 0x6E, 0x29, 0x80,
		0x71, 0x91, 0x83, 0xE3, 0xA2, 0x8F, 0xF0, 0x37, 0x7E, 0xAA, 0x8B, 0x07, 0xD3, 0x55, 0xA8, 0x69,
		0x55, 0x88, 0x75, 0xDB, 0x6B, 0x80, 0xF0, 0xBF, 0xEC, 0xC2, 0xAA, 0xFB, 0x53, 0x34, 0x20, 0xEF,
		0x6D, 0x10, 0x21, 0xBA, 0x8F, 0xE1, 0x2A, 0x37, 0xDA, 0x4A, 0x52, 0xC7, 0x85, 0x85, 0xD8, 0x20,
		0xAD, 0x27, 0x7D, 0x6C, 0x49, 0xEC, 0x43, 0x68, 0x91, 0x1D, 0x1E, 0x98, 0x32, 0x3B, 0xBD, 0xE9
	};
	unsigned char	HDQ_p[CI_HDQ_P_LEN] = // from ciplusDevice1Key.c and ciplusDevice2Key.c
	{
		0xD8, 0x0A, 0x30, 0xE6, 0xB4, 0x15, 0x9F, 0xEE, 0x5F, 0xFF, 0x54, 0xAF, 0x3F, 0x3A, 0x5D, 0x96,
		0xBD, 0x2A, 0xEA, 0xA8, 0xBA, 0x58, 0x1C, 0x5A, 0xC7, 0x79, 0x12, 0xD1, 0x1E, 0x9E, 0xD0, 0xF7,
		0xC8, 0x18, 0x01, 0x30, 0x46, 0x22, 0x56, 0x7B, 0x76, 0x96, 0x75, 0x35, 0xA0, 0xDE, 0xA0, 0x72,
		0x22, 0x44, 0xE8, 0x53, 0x32, 0xA3, 0x33, 0xDC, 0xCF, 0x27, 0x71, 0x6D, 0xE9, 0x81, 0x6E, 0x23,
		0x87, 0xBB, 0x0B, 0xA8, 0x33, 0xBC, 0x3D, 0x24, 0x39, 0xFA, 0xE0, 0x75, 0x47, 0x6B, 0xF6, 0xE0,
		0x5C, 0xDC, 0xE4, 0x9F, 0x34, 0x89, 0x3E, 0x06, 0xA4, 0x5F, 0xAE, 0xE5, 0xDE, 0xD5, 0xDB, 0x4C,
		0x3B, 0x74, 0x0D, 0x09, 0x2D, 0xB9, 0x61, 0x06, 0xB6, 0x5F, 0x23, 0x6D, 0xEC, 0x02, 0x70, 0x78,
		0x20, 0xA3, 0x96, 0x80, 0x6F, 0x0E, 0x8B, 0xDE, 0xDE, 0xD3, 0xE4, 0x8B, 0x47, 0x51, 0xD5, 0xED
	};
	unsigned char	HDQ_q[CI_HDQ_Q_LEN] = // from ciplusDevice1Key.c and ciplusDevice2Key.c
	{
		0xD2, 0x1A, 0x98, 0xBE, 0x99, 0x8D, 0xCE, 0x61, 0xDF, 0x93, 0x37, 0x81, 0xE4, 0x53, 0xEA, 0xFA,
		0x5B, 0xFC, 0xE0, 0xF8, 0x22, 0x7D, 0x88, 0x9E, 0x0D, 0x98, 0x4E, 0x15, 0x40, 0xC6, 0x34, 0x5A,
		0xBD, 0x3A, 0xC2, 0x46, 0x03, 0xC9, 0x06, 0xCA, 0x89, 0x42, 0x89, 0x88, 0xD9, 0xFC, 0x89, 0x13,
		0x8E, 0xFA, 0x71, 0x3E, 0x8D, 0x8D, 0x55, 0xAA, 0x23, 0x2C, 0x73, 0x38, 0xBC, 0xB9, 0x00, 0xF6,
		0x2D, 0x5F, 0x65, 0xE5, 0x8B, 0x9F, 0x7A, 0x40, 0x85, 0x75, 0xA6, 0xD2, 0xCC, 0x10, 0xE9, 0xAF,
		0x2B, 0x2B, 0xC9, 0xDB, 0x0D, 0x63, 0x2B, 0x87, 0x90, 0x76, 0xB3, 0xC4, 0xDA, 0xD7, 0x68, 0x55,
		0x95, 0xF4, 0xF1, 0x18, 0x25, 0x7E, 0x2D, 0xB7, 0x8C, 0xF3, 0xA4, 0xF3, 0x40, 0xDA, 0x5B, 0x05,
		0x21, 0x70, 0x0F, 0xCE, 0x0F, 0x80, 0x70, 0x5D, 0x70, 0x11, 0x44, 0xD7, 0xA9, 0xEA, 0xD1, 0xA3
	};
	unsigned char	HDQ_dP[CI_HDQ_DP_LEN] = // from ciplusDevice1Key.c and ciplusDevice2Key.c
	{
		0x3A, 0xCA, 0xD3, 0x32, 0x05, 0x72, 0x19, 0x1A, 0xFA, 0xFE, 0xF6, 0x61, 0xD6, 0xB8, 0x20, 0x7E,
		0x04, 0x2E, 0xE8, 0xBB, 0x50, 0x32, 0xE8, 0x4C, 0x80, 0x1A, 0x5F, 0xD7, 0x8F, 0x18, 0xB3, 0x4F,
		0xAB, 0x21, 0x75, 0x39, 0x58, 0xEC, 0xC1, 0x52, 0x4A, 0x1C, 0x79, 0xFB, 0x45, 0x33, 0x30, 0xC0,
		0xBE, 0xB8, 0xB7, 0xEC, 0xE4, 0x4B, 0xEB, 0xB2, 0x3C, 0xA1, 0xC4, 0x49, 0xA0, 0x11, 0x3C, 0x12,
		0xE9, 0x3E, 0x2A, 0xD6, 0xF4, 0x75, 0x56, 0xC2, 0x44, 0x11, 0x15, 0x02, 0x75, 0x94, 0x59, 0x14,
		0x07, 0xD1, 0x89, 0x5A, 0x16, 0x26, 0xFF, 0x3D, 0x39, 0x80, 0x5C, 0x8D, 0x6C, 0x0E, 0x10, 0xE6,
		0xF7, 0x0B, 0x06, 0xFD, 0x27, 0x77, 0x5A, 0x83, 0x44, 0x20, 0x31, 0xF9, 0x19, 0x10, 0x34, 0xE1,
		0x4C, 0x28, 0x98, 0xAD, 0x8D, 0x0B, 0x8D, 0x5E, 0xF2, 0x8F, 0x01, 0x94, 0x31, 0xAD, 0x80, 0xA5
	};
	unsigned char	HDQ_dQ[CI_HDQ_DQ_LEN] = // from ciplusDevice1Key.c and ciplusDevice2Key.c
	{
		0x22, 0x02, 0x0C, 0x17, 0x4D, 0xE3, 0x96, 0x34, 0x61, 0x6C, 0x02, 0xE0, 0x13, 0x85, 0x41, 0xD3,
		0xA4, 0x70, 0x1A, 0x3A, 0x0F, 0xDB, 0x21, 0xF1, 0xF3, 0x61, 0x63, 0xC2, 0x2C, 0xE9, 0xE8, 0x2F,
		0x87, 0xD1, 0xAB, 0x00, 0x8A, 0x3C, 0x4F, 0xCD, 0x18, 0xCA, 0x9C, 0x58, 0x7A, 0x70, 0x55, 0xFF,
		0xC4, 0x74, 0xE5, 0x3F, 0xAA, 0xC9, 0xE5, 0xC3, 0xD4, 0x4D, 0xAD, 0x98, 0xD1, 0x73, 0x60, 0xA4,
		0x78, 0x53, 0xA8, 0xBA, 0xAF, 0x0E, 0xF1, 0x4A, 0xE0, 0x4F, 0x5A, 0xE1, 0x64, 0x06, 0x98, 0xCC,
		0xB1, 0xC0, 0x34, 0xBC, 0x30, 0x3E, 0x8D, 0x1D, 0x34, 0x55, 0x02, 0x64, 0x2A, 0xC8, 0x13, 0x2B,
		0x47, 0x4A, 0x8E, 0x7B, 0xCA, 0x15, 0xD2, 0x70, 0x93, 0x70, 0x1C, 0x93, 0x03, 0x3C, 0x54, 0xDF,
		0x4F, 0xBA, 0x43, 0xD4, 0xA6, 0xCD, 0xB3, 0x62, 0x6C, 0x71, 0x5F, 0x23, 0x49, 0x6D, 0xA8, 0xE1
	};
	unsigned char	HDQ_qInv[CI_HDQ_QINV_LEN] = // from ciplusDevice1Key.c and ciplusDevice2Key.c
	{
		0xA9, 0xA9, 0xB7, 0x2A, 0x34, 0xB8, 0x84, 0xF5, 0x7D, 0xC1, 0x76, 0x82, 0x65, 0x78, 0x5B, 0xBC,
		0x5A, 0xAE, 0xA0, 0xAD, 0x03, 0xD3, 0x61, 0xDF, 0x85, 0xA4, 0xDC, 0x4D, 0x9B, 0x5B, 0x82, 0xC1,
		0x7A, 0x7E, 0xAC, 0xF3, 0xD3, 0xB1, 0x91, 0x5D, 0x9A, 0x18, 0x2E, 0xE8, 0xA5, 0x3D, 0xEA, 0x8B,
		0xD6, 0xC4, 0xDE, 0xC6, 0x25, 0xA3, 0xB5, 0x00, 0x18, 0x28, 0x24, 0x33, 0x2C, 0x7B, 0xF3, 0x1D,
		0x96, 0x3A, 0x2F, 0x3F, 0x30, 0xC6, 0xE2, 0xCE, 0xFF, 0x49, 0x9F, 0xA1, 0xFB, 0x70, 0x5A, 0x60,
		0xF4, 0xB6, 0x2C, 0x04, 0x13, 0x58, 0x39, 0x6A, 0x03, 0xBD, 0xCA, 0x72, 0xD5, 0x54, 0xFA, 0xE3,
		0x2E, 0x94, 0x25, 0x79, 0x9A, 0x32, 0x16, 0xA2, 0x6C, 0xE2, 0x1E, 0xCF, 0x61, 0x44, 0x78, 0x9B,
		0x5B, 0xC2, 0xDE, 0xA5, 0xC0, 0x64, 0xC7, 0x63, 0x58, 0xAC, 0x46, 0x41, 0x2E, 0x02, 0x70, 0x67
	};
	unsigned char	PRNG_seed[16]	= {0x7A, 0x98, 0x15, 0x38, 0x18, 0xC3, 0x78, 0x9B, 0xAA, 0xBE, 0xF6, 0x97, 0x59, 0x05, 0x26, 0xA0}; // from Credentials 문서
	unsigned char	SLK[16]			= {0x35, 0x6B, 0xF3, 0xB8, 0xB9, 0x3D, 0x75, 0x9C, 0xCF, 0x5C, 0x25, 0x53, 0x2B, 0xA0, 0xFF, 0x60}; // from Credentials 문서
	unsigned char	SIV[16]			= {0x09, 0x3C, 0xB1, 0x0B, 0xE6, 0xFF, 0x4D, 0xAD, 0x1A, 0x48, 0x85, 0x81, 0x34, 0x8B, 0x17, 0x62}; // from Credentials 문서
	unsigned char	CLK[16]			= {0x17, 0xB5, 0xF8, 0xE0, 0x39, 0xDA, 0x8A, 0x47, 0xDE, 0x05, 0x38, 0xB1, 0x8A, 0x6B, 0x26, 0x51}; // from Credentials 문서

	VK_memset(&stCiHostLicenseConst, 0x00, sizeof(CI_HOST_LICENSE_CONST));

	stCiHostLicenseConst.RootCertLen = CI_ROOT_CERT_LEN;
	VK_memcpy(stCiHostLicenseConst.RootCert, RootCert, stCiHostLicenseConst.RootCertLen);

	stCiHostLicenseConst.Host_BrandCertLen = CI_HOST_BRAND_CERT_LEN;
	VK_memcpy(stCiHostLicenseConst.Host_BrandCert, Host_BrandCert, stCiHostLicenseConst.Host_BrandCertLen);

	stCiHostLicenseConst.Host_DevCertLen = CI_HOST_DEV_CERT_LEN;
	VK_memcpy(stCiHostLicenseConst.Host_DevCert, Host_DevCert, stCiHostLicenseConst.Host_DevCertLen);

	VK_memcpy(stCiHostLicenseConst.DH_p, DH_p, CI_DH_P_LEN);
	VK_memcpy(stCiHostLicenseConst.DH_g, DH_g, CI_DH_G_LEN);
	VK_memcpy(stCiHostLicenseConst.DH_q, DH_q, CI_DH_Q_LEN);

	VK_memcpy(stCiHostLicenseConst.HDQ_d, HDQ_d, CI_HDQ_D_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_p, HDQ_p, CI_HDQ_P_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_q, HDQ_q, CI_HDQ_Q_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_dP, HDQ_dP, CI_HDQ_DP_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_dQ, HDQ_dQ, CI_HDQ_DQ_LEN);
	VK_memcpy(stCiHostLicenseConst.HDQ_qInv, HDQ_qInv, CI_HDQ_QINV_LEN);

	VK_memcpy(stCiHostLicenseConst.PRNG_seed, PRNG_seed, 16);
	VK_memcpy(stCiHostLicenseConst.SLK, SLK, 16);
	VK_memcpy(stCiHostLicenseConst.SIV, SIV, 16);
	VK_memcpy(stCiHostLicenseConst.CLK, CLK, 16);

	// Host_ID, Host_CckCipher, HDQ_n (from 디바이스 인증서)
	{
		Certificate_t * pstDevCertData = NULL;
		int nScramblerCapabilities, len;

		pstDevCertData = X509_ParseRawCert(Host_DevCert, CI_HOST_DEV_CERT_LEN);
		if (pstDevCertData == NULL)
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Invalid DevCert !!!\n"));
			return -1;
		}

		// get Host_ID
		if (FALSE == GetDeviceID(pstDevCertData, stCiHostLicenseConst.Host_ID))
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetDeviceID() !!!\n"));
			return -1;
		}

		// get Host_CckCipher
		if (FALSE == GetScramblerCapabilities(pstDevCertData, &nScramblerCapabilities))
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetScramblerCapabilities() !!!\n"));
			return -1;
		}
		if (nScramblerCapabilities == 0 || nScramblerCapabilities == 1)
		{
			stCiHostLicenseConst.Host_CckCipher = nScramblerCapabilities;
		}
		else // unknown value (reserved for future use) -> CI+ 스펙 1.2 기준에서 정의되지 않은 값일 경우엔 일단 CI_CC_KEY_CIPHER_DES_56_ECB 로 설정하도록 하자...
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetScramblerCapabilities()---> unknown value %d !!!\n", nScramblerCapabilities));
			stCiHostLicenseConst.Host_CckCipher = CI_CC_KEY_CIPHER_DES_56_ECB;
		}

		// get HDQ_n
		if (FALSE == GetRSAPublicKey_N(pstDevCertData, stCiHostLicenseConst.HDQ_n, &len))
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetRSAPublicKey_N() !!!\n"));
			return -1;
		}
		if (len != CI_HDQ_N_LEN)
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : GetRSAPublicKey_N()---> invalid len %d !!!\n", len));
			return -1;
		}
	}

	// HDQ_n (from 키 인증서), HDQ_d, HDQ_p, HDQ_q, HDQ_dP, HDQ_dQ, HDQ_qInv
	{
		// PC 프로그램의 경우, 해당 호스트 디바이스 인증서와 매칭되는 키 인증서로부터 유도.
		// 특히, HDQ_n 의 경우엔 위의 디바이스 인증서로 유도한 값과 키 인증서로부터 유도한 값이 서로 같은지 확인해야 한다.
	}

	// DHH, DHPH
	{
		bignum bn_DH_g, bn_DHH, bn_DH_p, bn_DHPH;
		int i;

		// generate a random nonce : DHH[256] -> DHH[0..15], DHH[16..31], ... , DHH[240..255] -> PRNG(&DHH[]) 16번 처리 -> concatenated to 256 bytes -> OK?
		for (i = 0; i < 256; i += CI_CC_CIPHER_BLOCK_SIZE)
			PRNG(PRNG_seed, &stCiHostLicenseConst.DHH[i]);

		// compute DHPH
		bn_init(&bn_DH_g, DH_g, CI_DH_G_LEN);
		bn_init(&bn_DHH, stCiHostLicenseConst.DHH, 256);
		bn_init(&bn_DH_p, DH_p, CI_DH_P_LEN);
		bn_mod_exp(&bn_DH_g, &bn_DHH, &bn_DH_p, &bn_DHPH);
		if (bn_DHPH.len != 256)
		{
			PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Invalid DHPH len (%d) !!!\n", bn_DHPH.len));
			return -1;
		}

		// The host checks that the computed key DHPH is of valid length and value : if 1 < DHPH < DH_p and DHPH ^ DH_q mod DH_p = 1
		{
			bignum bn_DH_q, out;
			if (bn_cmp(&bn_one, &bn_DHPH) >= 0)
			{
				PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : DHPH not bigger than 1 !!!\n"));
				return -1;
			}
			if (bn_cmp(&bn_DHPH, &bn_DH_p) >= 0)
			{
				PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : DHPH not less than DH_p !!!\n"));
				return -1;
			}
			bn_init(&bn_DH_q, DH_q, CI_DH_Q_LEN);
			bn_mod_exp(&bn_DHPH, &bn_DH_q, &bn_DH_p, &out);
			if (bn_cmp(&out, &bn_one) != 0)
			{
				PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : DHPH ^ DH_q mod DH_p not 1 !!!\n"));
				return -1;
			}
		}

		VK_memcpy(stCiHostLicenseConst.DHPH, bn_DHPH.num, bn_DHPH.len);
	}

	stCiHostLicenseConst.ucSavedFlag = 2;

	SHA_256((unsigned char *)&stCiHostLicenseConst, usOrgLen-32, stCiHostLicenseConst.ucDigest);

	P = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);
	C = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);

	VK_memcpy(P, &stCiHostLicenseConst, usOrgLen);
	OneAndZeroesPadding(P, usOrgLen);
	E_AES_CBC(K, P, C, usAlignedLen, IV);

	fpBinaryFile = fopen(CI_HOST_LICENSE_CONST_FILE, "wb");
	if (fpBinaryFile == NULL)
	{
		PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Can't open file !!!\n"));
		CA_MEM_Free(P);
		CA_MEM_Free(C);
		return -1;
	}

	nDataSize = fwrite(C, 1, usAlignedLen, fpBinaryFile);
	fclose(fpBinaryFile);

	if (nDataSize != usAlignedLen)
	{
		PrintErr(("[CI+]---> CI_SaveHostLicenseConstants()---> Error : Can't write data !!!\n"));
		CA_MEM_Free(P);
		CA_MEM_Free(C);
		return -1;
	}

	sync();

	CA_MEM_Free(P);
	CA_MEM_Free(C);

	return ERR_OK;
}
#endif // CI_PLUS_TEST_Technology_from_SmarDTV

// download CI+ host license constants data -> 히든 메뉴에서 사용
int CI_DownloadHostLicenseConstants (HUINT8 ucValue)
{
#ifdef CONFIG_DTV			/* STB에 API 미구현. */
	return DI_FAC_SetCiLicenseDownload (ucValue);
#else
	return 0;
#endif
}

// CI+ host license download 결과 받기 위한 callback 등록 -> CI_DownloadHostLicenseConstants()와 함께 사용
int CI_AddNotifyFuncForDownloading (pfnDI_FAC_DOWNLOAD_Notify fnFacNotify)
{
#ifdef CONFIG_DTV			/* STB에 API 미구현. */
	return DI_FAC_RegisterDownloadNotify (fnFacNotify);
#else
	return 0;
#endif
}

// init CI+ authentication contexts data and return -1 if there is any error (데이터 무결성 및 보안을 위해 데이터들은 SHA-256 으로 hashing 되고 AES-128-CBC 로 암호화된다)
int CI_InitAuthContexts (CI_SLOT_ID usSlotId)
{
	CI_AUTH_CTXs stCiAuthCtxs;

	unsigned short usOrgLen = sizeof(CI_AUTH_CTXs), usAlignedLen = GetAlignedLen(usOrgLen);
	unsigned char *P = NULL, *C = NULL;

	FILE *fpBinaryFile = NULL;
	int nDataSize = 0;

	if (usSlotId >= 2)
	{
		PrintErr(("[CI+]---> CI_InitAuthContexts()---> Error : Invalid params !!!\n"));
		return -1;
	}

	VK_memset(&stCiAuthCtxs, 0x00, usOrgLen);
	SHA_256((unsigned char *)&stCiAuthCtxs, usOrgLen-32, stCiAuthCtxs.ucDigest);

	P = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);
	C = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);

	VK_memcpy(P, &stCiAuthCtxs, usOrgLen);
	OneAndZeroesPadding(P, usOrgLen);
	E_AES_CBC(K, P, C, usAlignedLen, IV);

	if (usSlotId == 0)
	{
		fpBinaryFile = fopen(CI_AUTH_CTXS_1ST_FILE, "wb");
		if (fpBinaryFile == NULL)
		{
			PrintErr(("[CI+]---> CI_InitAuthContexts()---> Error : Can't open file !!!\n"));
			CA_MEM_Free(P);
			CA_MEM_Free(C);
			return -1;
		}

		nDataSize = fwrite(C, 1, usAlignedLen, fpBinaryFile);
		fclose(fpBinaryFile);

		if (nDataSize != usAlignedLen)
		{
			PrintErr(("[CI+]---> CI_InitAuthContexts()---> Error : Can't write data !!!\n"));
			CA_MEM_Free(P);
			CA_MEM_Free(C);
			return -1;
		}
	}
	else
	{
		fpBinaryFile = fopen(CI_AUTH_CTXS_2ND_FILE, "wb");
		if (fpBinaryFile == NULL)
		{
			PrintErr(("[CI+]---> CI_InitAuthContexts()---> Error : Can't open file !!!\n"));
			CA_MEM_Free(P);
			CA_MEM_Free(C);
			return -1;
		}

		nDataSize = fwrite(C, 1, usAlignedLen, fpBinaryFile);
		fclose(fpBinaryFile);

		if (nDataSize != usAlignedLen)
		{
			PrintErr(("[CI+]---> CI_InitAuthContexts()---> Error : Can't write data !!!\n"));
			CA_MEM_Free(P);
			CA_MEM_Free(C);
			return -1;
		}
	}

	sync();

	CA_MEM_Free(P);
	CA_MEM_Free(C);

	if (CI_LoadAuthContexts(usSlotId, &s_stCiAuthCtxs[usSlotId]))
	{
		PrintErr(("[CI+]---> CI_InitAuthContexts()---> Error : Can't load contexts !!!\n"));
		return -1;
	}

	return ERR_OK;
}

// load CI+ authentication contexts data for given slot from non-volatile memory and return -1 if there is any error (데이터 무결성 및 보안을 위해 데이터들은 SHA-256 으로 hashing 되고 AES-128-CBC 로 암호화된다)
int CI_LoadAuthContexts (CI_SLOT_ID usSlotId, CI_AUTH_CTXs *pstCiAuthCtxs)
{
	unsigned short usOrgLen = sizeof(CI_AUTH_CTXs), usAlignedLen = GetAlignedLen(usOrgLen);
	unsigned char *C = NULL, *P = NULL;
	unsigned char D[32];

	FILE *fpBinaryFile = NULL;
	int nDataSize = 0;

	if ((usSlotId >= 2) || (pstCiAuthCtxs == NULL))
	{
		PrintErr(("[CI+]---> CI_LoadAuthContexts()---> Error : Invalid params !!!\n"));
		return -1;
	}

	C = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);
	P = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);

	if (usSlotId == 0)
		fpBinaryFile = fopen(CI_AUTH_CTXS_1ST_FILE, "rb");
	else
		fpBinaryFile = fopen(CI_AUTH_CTXS_2ND_FILE, "rb");

	if (fpBinaryFile == NULL)
	{
		PrintErr(("[CI+]---> CI_LoadAuthContexts()---> Error : Can't open file !!!\n"));
		CA_MEM_Free(C);
		CA_MEM_Free(P);
		return -1;
	}

	nDataSize = fread(C, 1, usAlignedLen, fpBinaryFile);
	fclose(fpBinaryFile);

	if (nDataSize != usAlignedLen)
	{
		PrintErr(("[CI+]---> CI_LoadAuthContexts()---> Error : Can't read data !!!\n"));
		CA_MEM_Free(C);
		CA_MEM_Free(P);
		return -1;
	}

	D_AES_CBC(K, C, P, usAlignedLen, IV);
	VK_memcpy(pstCiAuthCtxs, P, usOrgLen);

	CA_MEM_Free(C);
	CA_MEM_Free(P);

	SHA_256((unsigned char *)pstCiAuthCtxs, usOrgLen-32, D);

	if (VK_memcmp(pstCiAuthCtxs->ucDigest, D, 32) != 0)
	{
		PrintErr(("[CI+]---> CI_LoadAuthContexts()---> Error : Invalid digest !!!\n"));
		return -1;
	}

	return ERR_OK;
}

// save CI+ authentication contexts data for given slot to non-volatile memory and return -1 if there is any error (데이터 무결성 및 보안을 위해 데이터들은 SHA-256 으로 hashing 되고 AES-128-CBC 로 암호화된다)
int CI_SaveAuthContexts (CI_SLOT_ID usSlotId, CI_AUTH_CTXs *pstCiAuthCtxs)
{
	unsigned short usOrgLen = sizeof(CI_AUTH_CTXs), usAlignedLen = GetAlignedLen(usOrgLen);
	unsigned char *P = NULL, *C = NULL;

	FILE *fpBinaryFile = NULL;
	int nDataSize = 0;

	if ((usSlotId >= 2) || (pstCiAuthCtxs == NULL))
	{
		PrintErr(("[CI+]---> CI_SaveAuthContexts()---> Error : Invalid params !!!\n"));
		return -1;
	}

	SHA_256((unsigned char *)pstCiAuthCtxs, usOrgLen-32, pstCiAuthCtxs->ucDigest);

	P = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);
	C = (unsigned char *)CA_MEM_Alloc(sizeof(unsigned char) * usAlignedLen);

	VK_memcpy(P, pstCiAuthCtxs, usOrgLen);
	OneAndZeroesPadding(P, usOrgLen);
	E_AES_CBC(K, P, C, usAlignedLen, IV);

	if (usSlotId == 0)
		fpBinaryFile = fopen(CI_AUTH_CTXS_1ST_FILE, "wb");
	else
		fpBinaryFile = fopen(CI_AUTH_CTXS_2ND_FILE, "wb");

	if (fpBinaryFile == NULL)
	{
		PrintErr(("[CI+]---> CI_SaveAuthContexts()---> Error : Can't open file to write !!!\n"));
		CA_MEM_Free(P);
		CA_MEM_Free(C);
		return -1;
	}

	nDataSize = fwrite(C, 1, usAlignedLen, fpBinaryFile);
	fclose(fpBinaryFile);

	if (nDataSize != usAlignedLen)
	{
		PrintErr(("[CI+]---> CI_SaveAuthContexts()---> Error : Can't write data !!!\n"));
		CA_MEM_Free(P);
		CA_MEM_Free(C);
		return -1;
	}

	sync();

	CA_MEM_Free(P);
	CA_MEM_Free(C);

	return ERR_OK;
}

// get current UTC time and return -1 if there is any error ("YYMMDDHHMMSSZ" 형태의 UTC Time format 스트링을 얻어온다)
int CI_GetCurrentUtcTime (unsigned char szUtcTime[13])
{
	unsigned long	ulCurTime;	// UNIXTIME
	DATE_TIME_T		stDateTime;

	if (VK_CLOCK_GetTime(&ulCurTime))
		return -1;
	if (UTIL_TCONV_ConvertUnixTimeToDateTime((UNIXTIME)ulCurTime, &stDateTime))
		return -1;

#ifdef CI_PLUS_TEST_Technology_from_SmarDTV /* SmarDTV CI+ 테스트 킷 스트림이 함께 제공된 인증서 날짜 정보와 맞지 않아 테스트용으로 추가한 코드임 */
	stDateTime.stDate.usYear = 2008;
	stDateTime.stDate.ucMonth = 12;
	stDateTime.stDate.ucDay = 25;
	stDateTime.stTime.ucHour = stDateTime.stTime.ucMinute = stDateTime.stTime.ucSecond = 0;
#endif

	sprintf(szUtcTime, "%02d%02d%02d%02d%02d%02dZ",
		stDateTime.stDate.usYear % 100, stDateTime.stDate.ucMonth, stDateTime.stDate.ucDay,
		stDateTime.stTime.ucHour, stDateTime.stTime.ucMinute, stDateTime.stTime.ucSecond);

	return ERR_OK;
}

// compare UTC Times : return 1 if t1 > t2, 0 if t1 = t2, -1 if t1 < t2
int CI_CompareUtcTimes (unsigned char szUtcTime1[13], unsigned char szUtcTime2[13])
{
	int cmp;

	cmp = VK_memcmp(szUtcTime1, szUtcTime2, 13); // CI+ 스펙에 따르면 "YYMMDDHHMMSSZ" -> The year field shall be interpreted as 20YY... 라고 하니까 이렇게 단순 비교해도 괜찮을 듯은 한데...

	if (cmp > 0)
		return 1;

	if (cmp < 0)
		return -1;

	return 0;
}

// set descrambler key (CCKey) to descrambler and return -1 if there is any error
// when enKeyCipher is CI_CC_KEY_CIPHER_DES_56_ECB  : CCK is 64 bits, CIV is NULL
// when enKeyCipher is CI_CC_KEY_CIPHER_AES_128_CBC : CCK is 128 bits, CIV is 128 bits
int CI_SetCckToDesc (CI_SLOT_ID usSlotId, CI_CC_KEY_CIPHER enKeyCipher, CI_CC_KEY_MODE enKeyMode, unsigned char *pucCck, unsigned char *pucCiv)
{
	CI_NOTIFY_SET_KEY_FUNC 	pfnNotifySetKey;
	CIPLUS_KeyInfo_t		stKeyInfo;

	stKeyInfo.enKeyCipher = enKeyCipher;
	stKeyInfo.enKeyMode = enKeyMode;
	stKeyInfo.pucCck = pucCck;
	stKeyInfo.pucCiv = pucCiv;

	Callback_Reset(g_hCbNotifySetKey);
	while ((pfnNotifySetKey = (CI_NOTIFY_SET_KEY_FUNC)Callback_GetNextFunc(g_hCbNotifySetKey)) != NULL)
	{
		if ((*pfnNotifySetKey)(usSlotId, &stKeyInfo) != ERR_OK)
			return -1;
	}

	return ERR_OK;
}

// apply URI to external interface and return -1 if there is any error
// - ucMode         : see CI_CC_URI_MODE_
// - ucAps          : see CI_CC_URI_APS_
// - ucEmi          : see CI_CC_URI_EMI_
// - ucIct          : see CI_CC_URI_ICT_
// - ucRct          : see CI_CC_URI_RCT_
// - ulMinutesForRL : minutes for RL
int CI_ApplyUriToExternalOutput (
	CI_SLOT_ID usSlotId,
	unsigned short usServiceId,
	unsigned char ucMode,
	unsigned char ucAps,
	unsigned char ucEmi,
	unsigned char ucIct,
	unsigned char ucRct,
	unsigned long ulMinutesForRL)
{
	CI_NOTIFY_URI_CONTROL_FUNC 	pfnNotifyUriControl;
	CIPLUS_UriInfo_t			stUriInfo;

	stUriInfo.usServiceId = usServiceId; // ucMode 가 CI_CC_URI_MODE_FROMCAM 일 때만 유효.
	stUriInfo.ucMode = ucMode;
	stUriInfo.ucAps = ucAps;
	stUriInfo.ucEmi = ucEmi;
	stUriInfo.ucIct = ucIct;
	stUriInfo.ucRct = ucRct;
	stUriInfo.ulMinutesForRL = ulMinutesForRL;

	Callback_Reset(g_hCbNotifyUriControl);
	while ((pfnNotifyUriControl = (CI_NOTIFY_URI_CONTROL_FUNC)Callback_GetNextFunc(g_hCbNotifyUriControl)) != NULL)
	{
		if ((*pfnNotifyUriControl)(usSlotId, &stUriInfo) != ERR_OK)
			return -1;
	}

	return ERR_OK;
}

// set plus mode for given slot (Host Service Shunning 을 위한 SI/SVC 연동 함수)
void CI_SetPlusMode (CI_PLUS_MODE enPlusMode)
{
	s_enPlusMode = enPlusMode;
}

// get plus mode for given slot (Host Service Shunning 을 위한 SI/SVC 연동 함수)
CI_PLUS_MODE CI_GetPlusMode (void)
{
	return s_enPlusMode;
}

// set host mode
void CI_SetHostMode (CI_HOST_MODE enHostMode)
{
	s_enHostMode = enHostMode;
}

// get host mode
CI_HOST_MODE CI_GetHostMode (void)
{
	return s_enHostMode;
}

// get host country code as ISO 3166-1 alpha 3 (에러 처리는 자체적으로 핸들링 하기 때문에 항시 ERR_OK 리턴함)
int CI_GetCountryCode (unsigned char *pucCode)
{
	/* The country code is a 24-bit field that identifies the host country using 3 uppercase characters as specified by ISO 3166-1 alpha 3.
	   Each character is coded as 8-bits according to ISO 8859-1. */

	HINT32 nValue;
	HUINT8 szIso3166Code[4];
	HERROR err;

	if (pucCode == NULL)
	{
		PrintErr(("[CI+]---> CI_GetCountryCode()---> Error : Invalid params !!!\n"));
		return -1;
	}

	err = DB_SETUP_GetMenuItemValue(MENUCFG_ITEMNAME_COUNTRY, &nValue);
	if (err != ERR_OK)
	{
		PrintErr(("[CI+]---> CI_GetCountryCode()---> Error : DB_SETUP_GetMenuItemValue !!!\n"));
		nValue = eCountry_ENGLAND;
	}

	err = UTIL_ISOSVC_GetIso3166CodeByCountryIndex((Country_Idx_t)nValue, szIso3166Code);
	if (err != ERR_OK)
	{
		PrintErr(("[CI+]---> CI_GetCountryCode()---> Error : UTIL_ISOSVC_GetIso3166CodeByCountryIndex (%d) !!!\n", nValue));
		szIso3166Code[0] = 'G';
		szIso3166Code[1] = 'B';
		szIso3166Code[2] = 'R';
	}

	pucCode[0] = szIso3166Code[0];
	pucCode[1] = szIso3166Code[1];
	pucCode[2] = szIso3166Code[2];

	PrintNotify(("host country setting is %c%c%c\n", pucCode[0], pucCode[1], pucCode[2]));

	return ERR_OK;
}

// get host language code as ISO 639 Part 2 (에러 처리는 자체적으로 핸들링 하기 때문에 항시 ERR_OK 리턴함)
int CI_GetLanguageCode (unsigned char *pucCode)
{
	/*  The language code is a 24-bit field that identifies the language using 3 lowercase characters as specified by ISO 639 Part 2.
	    Each character is coded as 8-bits according to ISO 8859-1. */

	HINT32 nValue;
	HUINT8 szIso639Code1[4];
	HUINT8 szIso639Code2[4];
	HUINT8 szIso639Code3[4];
	HINT32 lMatchCount = 0;
	HERROR err;

	if (pucCode == NULL)
	{
		PrintErr(("[CI+]---> CI_GetLanguageCode()---> Error : Invalid params !!!\n"));
		return -1;
	}

	err = DB_SETUP_GetMenuItemValue(MENUCFG_ITEMNAME_MENU_LANG, &nValue);
	if (err != ERR_OK)
	{
		PrintErr(("[CI+]---> CI_GetLanguageCode()---> Error : DB_SETUP_GetMenuItemValue !!!\n"));
		nValue = eLangID_English;
	}

	err = UTIL_Get_639CodeByLangIdx((Language_Id_t)nValue, &lMatchCount, szIso639Code1, szIso639Code2, szIso639Code3);
	if (err != ERR_OK)
	{
		PrintErr(("[CI+]---> CI_GetLanguageCode()---> Error : UTIL_Get_639CodeByLangIdx (%d) !!!\n", nValue));
		szIso639Code1[0] = 'e';
		szIso639Code1[1] = 'n';
		szIso639Code1[2] = 'g';
	}

	pucCode[0] = szIso639Code1[0];
	pucCode[1] = szIso639Code1[1];
	pucCode[2] = szIso639Code1[2];

	PrintNotify(("host language setting is %c%c%c\n", pucCode[0], pucCode[1], pucCode[2]));

	return ERR_OK;
}

// get Host ID and return -1 if there is any error (이 경우 ID는 empty 또는 invalid 로 간주)
// 이 함수의 호출은 CiCc_Task() 기동이 완료된 후에야 유효한 결과를 줌에 유의할 것
int CI_GetHostId (unsigned char ucHostId[8])
{
	return CiCc_GetHostId(ucHostId);
}

// get current binded CI+ CAM ID for given slot and return -1 if there is any error (이 경우 ID는 empty 또는 invalid 로 간주)
// 이 함수의 호출은 캠 삽입후 일정 시간 경과된 후에야 유효한 결과를 줌에 유의할 것
int CI_GetBindedCamId (CI_SLOT_ID usSlotId, unsigned char ucBindedCamId[8])
{
	return CiCc_GetBindedCamId(usSlotId, ucBindedCamId);
}

// get current binded CI+ CAM Brand ID for given slot and return -1 if there is any error (이 경우 ID는 empty 또는 invalid 로 간주)
// BindedCamBrandId 값이 0 으로 리턴되는 경우 BindedCamBrandId 가 없는 것을 의미한다.
// 이 함수의 호출은 캠 삽입후 일정 시간 경과된 후에야 유효한 결과를 줌에 유의할 것
int CI_GetBindedCamBrandId (CI_SLOT_ID usSlotId, unsigned short *pusBindedCamBrandId)
{
	// SMiT : 14399 (0x383F), Neotion : 23308 (0x5B0C)
	return CiCc_GetBindedCamBrandId(usSlotId, pusBindedCamBrandId);
}

// get negotiated scrambling cipher for given slot to set descrambler mode when descrambler open and return -1 if there is any error
// 이 함수의 호출은 캠 삽입후 일정 시간 경과된 후에야 유효한 결과를 줌에 유의할 것
int CI_GetNegotiatedCckCipher (CI_SLOT_ID usSlotId, CI_CC_KEY_CIPHER *penNegotiatedCckCipher)
{
	return CiCc_GetNegotiatedCckCipher(usSlotId, penNegotiatedCckCipher);
}

// request CC to set descrambler key (CCKey) to descrambler
// 이 함수의 호출은 캠 삽입후 일정 시간 경과된 후에야 유효한 결과를 줌에 유의할 것 -> 더이상 사용되지 않으나 추후 필요한 용도가 있을 수도 있어 일단 남겨두도록 한다.
void CI_ReqSetCckToDesc (CI_SLOT_ID usSlotId)
{
	CiCc_ReqSetCckToDesc(usSlotId);
}

// set URI default values and URI timer for given slot to do control external interface when zapping
// 이 함수의 호출은 캠 삽입후 일정 시간 경과된 후에야 유효한 결과를 줌에 유의할 것
void CI_SetUriDefault (CI_SLOT_ID usSlotId, HBOOL bOn)
{
	CiCc_SetUriDefault(usSlotId, bOn);
}

// check CI+ CAM is inserted for given slot : return 1 if CI+ CAM is inserted, 0 if no CAM or normal CAM is inserted
// 해당 슬롯의 캠이 CI+ 캠인지 일반 캠인지를 확인하여 리턴한다 (CI+ 캠인 경우 1, 일반 캠인 경우 0)
int CI_IsCiPlusCam (CI_SLOT_ID usSlotId)
{
	#define USE_CIS_INFORMATION

	#ifdef USE_CIS_INFORMATION

	// "CI Plus Compatibility Identification" 정보를 보고 판단하는 방식 (CI+ 스펙 1.2 이상에서) -> Neotion 의 경우 rescue mode 에서는 무용지물임에 주의하자!
	return PHYS_IsCiPlusCam(usSlotId);

	#else

	// CI+의 핵심인 CC 리소스가 오픈되었는지를 보고 판단하는 방식
	return CiCc_IsOpened(usSlotId);

	#endif
}

// notify host country setting is changed to CAM and return -1 if there is any error
int CI_NotifyHostCountrySettingChangedToCam (CI_SLOT_ID usSlotId)
{
	return CiHlc_NotifyHostCountryInfoChanged(usSlotId);
}

// notify host language setting is changed to CAM and return -1 if there is any error
int CI_NotifyHostLanguageSettingChangedToCam (CI_SLOT_ID usSlotId)
{
	return CiHlc_NotifyHostLanguageInfoChanged(usSlotId);
}

// for MES : CI+ host license constants 파일에서 호스트 아이디를 얻기 위한 함수임 (MES 프로토콜을 위한 함수임)
int CI_MES_GetHostIdFromLicenseConstDataFile (char* hostId)
{
	CI_HOST_LICENSE_CONST ciHostLicenseConst;
	Certificate_t * pstDevCertData = NULL;

	// CI+ host license constants 파일 로딩
	if (CI_LoadHostLicenseConstants(&ciHostLicenseConst))
	{
		PrintErr(("[CI+]---> GetHostIdFromLicenseConstDataFile()---> Error : Can't load CI+ host license constants !!!\n"));
		return -1;
	}
	if (ciHostLicenseConst.ucSavedFlag != 1 && ciHostLicenseConst.ucSavedFlag != 2)
	{
		PrintErr(("[CI+]---> GetHostIdFromLicenseConstDataFile()---> Error : CI+ host license constants not saved !!!\n"));
		return -2;
	}

	// 호스트 디바이스 인증서로부터 호스트 아이디 추출
	pstDevCertData = X509_ParseRawCert(ciHostLicenseConst.Host_DevCert, ciHostLicenseConst.Host_DevCertLen);
	if (pstDevCertData == NULL)
	{
		PrintErr(("[CI+]---> GetHostIdFromLicenseConstDataFile()---> Error : Invalid device certificate !!!\n"));
		return -3;
	}
	if (FALSE == GetDeviceIDAsAsciiCode(pstDevCertData, hostId))
	{
		PrintErr(("[CI+]---> GetHostIdFromLicenseConstDataFile()---> Error : Can't get device id as ascii codes !!!\n"));
		X509_FreeCert(pstDevCertData);
		return -4;
	}

	// 위에서 추출한 아이디와 PC 프로그램에서 저장한 아이디가 같은지 크로스 체크 : hostIds cross check (deviceCert <--> ciHostLicenseConst.Host_ID (8 bytes)
	{
		unsigned char ucHostIdBuf[8];
		GetDeviceID(pstDevCertData, ucHostIdBuf);
		if (VK_memcmp(ucHostIdBuf, ciHostLicenseConst.Host_ID, 8))
		{
			PrintErr(("[CI+]---> GetHostIdFromLicenseConstDataFile()---> Error : cross check -> not same (deviceCert <-> ciHostLicenseConst.Host_ID) !!!\n"));
			X509_FreeCert(pstDevCertData);
			return -5;
		}
	}

	X509_FreeCert(pstDevCertData);
	return ERR_OK;
}

// for MES : If CI+ host license constants data downloading is occured on booting process,
//           then unexpected error could be occured due to timing between CI+ downloading and CI+ initialization tasks.
//           Therefore, we use this callback func to wait CI+ host license constants data downloading task processing.
HERROR  CI_MES_LicenseDownCbFunc (HINT32 lResult)
{
	/* CI+ Download 시작 시에 리모콘 입력 disable -> 종료 후에 enable
      (리모콘 입력에 의해 CI+ Download 영향 받으므로 이런 처리를 함)
      callback은 CI+ Download 시작 시, 종료 후 호출 */
	if (lResult == DI_FAC_DOWNLOAD_SIGNAL_CHECKED)
	{
		PAL_KEY_DisableKeyInput();
		return ERR_OK;
	}

    s_bIsLicenseDownTaskEnd = TRUE;
	PAL_KEY_EnableKeyInput();
	return ERR_OK;
}

void CI_MES_SetLicenseDownCbRegState (HBOOL bFlag)
{
	s_bIsLicenseDownCbRegSuccess = bFlag;
}

HBOOL CI_MES_IsLicenseDownCbRegSuccess (void)
{
	return s_bIsLicenseDownCbRegSuccess;
}

HBOOL CI_MES_IsLicenseDownTaskEnd (void)
{
	return s_bIsLicenseDownTaskEnd;
}


/*-------------------------------------------*/
/*  callback to notify for CI / CAS manager  */
/*-------------------------------------------*/

int CIPLUS_Init(void)
{
	g_hCbNotifyCcReport = Callback_CreateList();
	g_hCbNotifySetKey = Callback_CreateList();
	g_hCbNotifyUriControl = Callback_CreateList();
	g_hCbNotifyHostTune = Callback_CreateList();
	g_hCbNotifyPidReplace = Callback_CreateList();
	g_hCbNotifyCamUpgrade = Callback_CreateList();

	return ERR_OK;
}

int CIPLUS_AddNotifyFunc(CIPLUS_NOTIFY_FUNC_LIST notifyList)
{
	if (notifyList.pfnNotifyCcReport != NULL)
	{
		if (Callback_AddFunc(g_hCbNotifyCcReport, (void *)notifyList.pfnNotifyCcReport) == NULL)
		{
			PrintErr(("[CI+]---> CIPLUS_AddNotifyFunc()---> Error : CcReport !!!\n"));
			return -1;
		}

		PrintDbg(("[CI+]---> CIPLUS_AddNotifyFunc()---> add CcReport notify success...\n"));
	}

	if (notifyList.pfnNotifySetKey != NULL)
	{
		if (Callback_AddFunc(g_hCbNotifySetKey, (void *)notifyList.pfnNotifySetKey) == NULL)
		{
			PrintErr(("[CI+]---> CIPLUS_AddNotifyFunc()---> Error : SetKey !!!\n"));
			return -1;
		}

		PrintDbg(("[CI+]---> CIPLUS_AddNotifyFunc()---> add SetKey notify success...\n"));
	}

	if (notifyList.pfnNotifyUriControl != NULL)
	{
		if (Callback_AddFunc(g_hCbNotifyUriControl, (void *)notifyList.pfnNotifyUriControl) == NULL)
		{
			PrintErr(("[CI+]---> CIPLUS_AddNotifyFunc()---> Error : UriControl !!!\n"));
			return -1;
		}

		PrintDbg(("[CI+]---> CIPLUS_AddNotifyFunc()---> add UriControl notify success...\n"));
	}

	if (notifyList.pfnNotifyHostTune != NULL)
	{
		if (Callback_AddFunc(g_hCbNotifyHostTune, (void *)notifyList.pfnNotifyHostTune) == NULL)
		{
			PrintErr(("[CI+]---> CIPLUS_AddNotifyFunc()---> Error : HostTune !!!\n"));
			return -1;
		}

		PrintDbg(("[CI+]---> CIPLUS_AddNotifyFunc()---> add HostTune notify success...\n"));
	}

	if (notifyList.pfnNotifyPidReplace != NULL)
	{
		if (Callback_AddFunc(g_hCbNotifyPidReplace, (void *)notifyList.pfnNotifyPidReplace) == NULL)
		{
			PrintErr(("[CI+]---> CIPLUS_AddNotifyFunc()---> Error : PidReplace !!!\n"));
			return -1;
		}

		PrintDbg(("[CI+]---> CIPLUS_AddNotifyFunc()---> add PidReplace notify success...\n"));
	}

	if (notifyList.pfnNotifyCamUpgrade != NULL)
	{
		if (Callback_AddFunc(g_hCbNotifyCamUpgrade, (void *)notifyList.pfnNotifyCamUpgrade) == NULL)
		{
			PrintErr(("[CI+]---> CIPLUS_AddNotifyFunc()---> Error : CamUpgrade !!!\n"));
			return -1;
		}

		PrintDbg(("[CI+]---> CIPLUS_AddNotifyFunc()---> add CamUpgrade notify success...\n"));
	}

	return ERR_OK;
}

int CIPLUS_DeleteNotifyFunc(CIPLUS_NOTIFY_FUNC_LIST notifyList)
{
	if (notifyList.pfnNotifyCcReport != NULL)
		Callback_RemoveFunc(g_hCbNotifyCcReport, (void *)notifyList.pfnNotifyCcReport);

	if (notifyList.pfnNotifySetKey != NULL)
		Callback_RemoveFunc(g_hCbNotifySetKey, (void *)notifyList.pfnNotifySetKey);

	if (notifyList.pfnNotifyUriControl != NULL)
		Callback_RemoveFunc(g_hCbNotifyUriControl, (void *)notifyList.pfnNotifyUriControl);

	if (notifyList.pfnNotifyHostTune != NULL)
		Callback_RemoveFunc(g_hCbNotifyHostTune, (void *)notifyList.pfnNotifyHostTune);

	if (notifyList.pfnNotifyPidReplace != NULL)
		Callback_RemoveFunc(g_hCbNotifyPidReplace, (void *)notifyList.pfnNotifyPidReplace);

	if (notifyList.pfnNotifyCamUpgrade != NULL)
		Callback_RemoveFunc(g_hCbNotifyCamUpgrade, (void *)notifyList.pfnNotifyCamUpgrade);

	return ERR_OK;
}

