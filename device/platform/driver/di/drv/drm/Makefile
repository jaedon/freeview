include $(HUMAX_WORK_DIR)/platform/sdk/driver/bcm_environment.config
##############################
# PLAYREADY
##############################
ifeq ($(CONFIG_PLAYREADY),y)
ifeq ($(NEXUS_SECURITY_TREE), SECURITY_TREE_1302)
DRM_SOURCE_PATH=$(HUMAX_WORK_DIR)/platform/sdk/driver_patches/BSEAV/lib/playready20/source
else
inccflag-y += -I$(HUMAX_WORK_DIR)/platform/sdk/driver/BSEAV/lib/playready
ifeq ($(CONFIG_PLAYREADY_25),y)
DRM_SOURCE_PATH=$(HUMAX_WORK_DIR)/platform/sdk/driver/BSEAV/lib/playready25/source
else
DRM_SOURCE_PATH=$(HUMAX_WORK_DIR)/platform/sdk/driver/BSEAV/lib/playready20/source
endif
endif
ifeq ($(CONFIG_PLAYREADY_25),y)
inccflag-y += -I$(DRM_SOURCE_PATH)/playready/include
inccflag-y += -I$(DRM_SOURCE_PATH)/inc
inccflag-y += -I$(DRM_SOURCE_PATH)/results
inccflag-y += -I$(DRM_SOURCE_PATH)/certs
inccflag-y += -I$(DRM_SOURCE_PATH)/xmr
inccflag-y += -I$(DRM_SOURCE_PATH)/ndtinc
inccflag-y += -I$(DRM_SOURCE_PATH)/keyfile
inccflag-y += -I$(DRM_SOURCE_PATH)/keyfileformat
inccflag-y += -I$(DRM_SOURCE_PATH)/oem/common/inc
inccflag-y += -I$(DRM_SOURCE_PATH)/oem/ansi/inc
inccflag-y += -I$(DRM_SOURCE_PATH)/oem/ansi/trace
inccflag-y += -I$(DRM_SOURCE_PATH)/tools/common
else
inccflag-y += -I$(DRM_SOURCE_PATH)/inc
inccflag-y += -I$(DRM_SOURCE_PATH)/results
inccflag-y += -I$(DRM_SOURCE_PATH)/certs
inccflag-y += -I$(DRM_SOURCE_PATH)/xmr
inccflag-y += -I$(DRM_SOURCE_PATH)/ndtinc
inccflag-y += -I$(DRM_SOURCE_PATH)/keyfile
inccflag-y += -I$(DRM_SOURCE_PATH)/keyfileformat
inccflag-y += -I$(DRM_SOURCE_PATH)/oem/common/inc
inccflag-y += -I$(DRM_SOURCE_PATH)/oem/ansi/inc
inccflag-y += -I$(DRM_SOURCE_PATH)/oem/ansi/trace
inccflag-y += -I$(DRM_SOURCE_PATH)/tools/common
endif
inccflag-y += -I$(HUMAX_WORK_DIR)/platform/sdk/driver/BSEAV/lib/asf
inccflag-y += -I$(HUMAX_WORK_DIR)/platform/sdk/driver/BSEAV/lib/media
inccflag-y += -I$(HUMAX_WORK_DIR)/platform/sdk/driver/BSEAV/lib/utils
inccflag-y += -I$(HUMAX_WORK_DIR)/platform/sdk/driver/BSEAV/lib/security/common_crypto/include
inccflag-y += -I$(HUMAX_WORK_DIR)/platform/sdk/driver/magnum/basemodules/mem

ifeq ($(CONFIG_PLAYREADY_25),y)
HUMAX_EXTRA_CFLAG += -DB_HAS_DRM=1
HUMAX_EXTRA_CFLAG += -DNEXUS_DRM_BUILD=1
HUMAX_EXTRA_CFLAG += -DDRM_BUILD_PROFILE=900
HUMAX_EXTRA_CFLAG += -DTARGET_LITTLE_ENDIAN=1
HUMAX_EXTRA_CFLAG += -DTARGET_SUPPORTS_UNALIGNED_DWORD_POINTERS=1
HUMAX_EXTRA_CFLAG += -DLINUX_BUILD
HUMAX_EXTRA_CFLAG += -DDRM_ACTIVATION_PLATFORM=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_LOCKING=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_MULTI_THREADING=1
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_ECCPROFILING=1
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_INLINEDWORDCPY=1
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_DATASTORE_PREALLOC=1
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_REACTIVATION=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_NATIVE_64BIT_TYPES=1
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_FORCE_ALIGN=1
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_ASSEMBLY=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_PRECOMPUTE_GTABLE=1
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_SECUREOEMHAL=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_SECUREOEMHAL_PLAY_ONLY=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_TRACING=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_PRIVATE_KEY_CACHE=0X_EXTRA_CFLAG
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_EMBEDDED_CERTS=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_DEVICE_SIGNING_KEY=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_NONVAULTSIGNING=1
HUMAX_EXTRA_CFLAG += -DDRM_USE_IOCTL_HAL_GET_DEVICE_INFO=0
HUMAX_EXTRA_CFLAG += -D_DATASTORE_WRITE_THRU=1
HUMAX_EXTRA_CFLAG += -D_ADDLICENSE_WRITE_THRU=0
HUMAX_EXTRA_CFLAG += -DDRM_HDS_COPY_BUFFER_SIZE=32768
HUMAX_EXTRA_CFLAG += -DDRM_TEST_SUPPORT_NET_IO=0
HUMAX_EXTRA_CFLAG += -DDRM_TEST_SUPPORT_ACTIVATION=0
HUMAX_EXTRA_CFLAG += -DUSE_PK_NAMESPACES=0
HUMAX_EXTRA_CFLAG += -DDRM_INCLUDE_PK_NAMESPACE_USING_STATEMENT=1
HUMAX_EXTRA_CFLAG += -DDRM_KEYFILE_VERSION=3
HUMAX_EXTRA_CFLAG += -DDRM_TOOLS_PRND_TRANSMITTER_USES_UPNP=0
HUMAX_EXTRA_CFLAG += -DDBG=1
HUMAX_EXTRA_CFLAG += -DPLAY_READY_25
HUMAX_EXTRA_CFLAG += -DTEE
else
HUMAX_EXTRA_CFLAG += -DDRM_BUILD_PROFILE=10
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_LOCKING=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_MULTI_THREADING=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_DATASTORE_PREALLOC=1
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_NATIVE_64BIT_TYPES=1
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_FORCE_ALIGN=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_ASSEMBLY=1
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_PRECOMPUTE_GTABLE=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_TRACING=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_PRIVATE_KEY_CACHE=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_EMBEDDED_CERTS=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_DEVICE_SIGNING_KEY=0
HUMAX_EXTRA_CFLAG += -DDRM_SUPPORT_NONVAULTSIGNING=1
HUMAX_EXTRA_CFLAG += -DDRM_USE_IOCTL_HAL_GET_DEVICE_INFO=0
HUMAX_EXTRA_CFLAG += -D_DATASTORE_WRITE_THRU=1
HUMAX_EXTRA_CFLAG += -D_ADDLICENSE_WRITE_THRU=0
HUMAX_EXTRA_CFLAG += -DDRM_HDS_COPY_BUFFER_SIZE=32768
HUMAX_EXTRA_CFLAG += -DDRM_TEST_SUPPORT_NET_IO=0
HUMAX_EXTRA_CFLAG += -DUSE_PK_NAMESPACES=0
HUMAX_EXTRA_CFLAG += -DDRM_INCLUDE_PK_NAMESPACE_USING_STATEMENT=0
HUMAX_EXTRA_CFLAG += -DDRM_KEYFILE_VERSION=3
HUMAX_EXTRA_CFLAG += -DDBG=1
HUMAX_EXTRA_CFLAG += -D_CRT_SECURE_NO_DEPRECATE
HUMAX_EXTRA_CFLAG += -D_CRT_OBSOLETE_NO_DEPRECATE
HUMAX_EXTRA_CFLAG += -D_CRT_SECURE_FORCE_DEPRECATE
HUMAX_EXTRA_CFLAG += -D_X86_
#HUMAX_EXTRA_CFLAG += -D_M_IX86
HUMAX_EXTRA_CFLAG += -DTARGET_LITTLE_ENDIAN=1
endif

ifeq ($(CONFIG_BRCM_MOD_PRDY_ROBUSTNESS_ENABLE), y)
HUMAX_EXTRA_CFLAG += -DPRDY_ROBUSTNESS
endif
endif

ifeq ($(CONFIG_PLAYREADY_25_BRCM),y)
inccflag-y += -I$(HUMAX_WORK_DIR)/platform/sdk/driver/BSEAV/lib/security/common_drm/include
inccflag-y += -I$(HUMAX_WORK_DIR)/platform/sdk/driver/BSEAV/lib/security/common_crypto/include
endif

##############################
# VIEWRIGHTWEB
##############################
ifeq ($(CONFIG_VIEWRIGHTWEB),y)
HUMAX_VIEWRIGHTWEB_INCLUDE=$(HUMAX_WORK_DIR)/../packages/viewrightweb/include
inccflag-y += -I$(HUMAX_VIEWRIGHTWEB_INCLUDE)/
endif

HUMAX_EXTRA_CFLAG += -I$(HUMAX_DRIVER_DIR)/di/media20/iptuner

obj-y += drv_drm.o

ifeq ($(CONFIG_PLAYREADY),y)
ifeq ($(NEXUS_SECURITY_TREE), SECURITY_TREE_1302)
fullpath-obj-y += $(HUMAX_WORK_DIR)/platform/sdk/driver_patches/BSEAV/lib/playready20/source/prdy/prdy_http.o
inccflag-y += -I$(HUMAX_WORK_DIR)/platform/sdk/driver_patches/BSEAV/lib/playready20/source/prdy
else
fullpath-obj-y += $(HUMAX_WORK_DIR)/platform/sdk/driver/BSEAV/lib/playready/prdy_http.o
endif
endif
