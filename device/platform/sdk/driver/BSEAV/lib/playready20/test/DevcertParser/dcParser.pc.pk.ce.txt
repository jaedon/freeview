110462:BVT:P0:DevCertGetAttribute should retrieve all supported attributes from a valid devcert
TEST_API_DevCertGetAttribute(NORMAL, 1 DRM_DEVCERT_SERIALNUMBER, NULL, CgoKCgoKCgoKCgoKCgoKCgoKCgo=)
TEST_API_DevCertGetAttribute(NORMAL, 2 DRM_DEVCERT_DEVICEPUBKEY, NULL, 2rVLgWBb3FkbJZdM34mOzbhEEiiBnvOFoNv0blUT9/SOMzA/POmNCg==)
'TEST_API_DevCertGetAttribute(NORMAL, 3 DRM_DEVCERT_DEVICEPRIVKEY, NULL, GgiTW/I53qZncoLHHAAmbtWOspU=)
TEST_API_DevCertGetAttribute(NORMAL, 4 DRM_DEVCERT_DEVICEDATANODE, NULL, IGNORE)
TEST_API_DevCertGetAttribute(NORMAL, 5 DRM_DEVCERT_DEVICESIGNATURE, NULL, /r8UYuegNHWnYZdcPdFTPNH4kFBtD5zG0n9fEzOPjKTfZAdJ+AJPTg==)
TEST_API_DevCertGetAttribute(NORMAL, 6 DRM_DEVCERT_COMPATIBILITYVERSION, NULL, "2.3.0.2")
TEST_API_DevCertGetAttribute(NORMAL, 7 DRM_DEVCERT_COMPATABILITYCERT, NULL, "2rVLgWBb3FkbJZdM34mOzbhEEiiBnvOFoNv0blUT9/SOMzA/POmNCgIDAAI9Q1iuZc3Tlvwey3ocJyjuxUdaP4rUdoQ5jWH9rhXa537ASm352xJT")
TEST_API_DevCertGetAttribute(NORMAL, 8 DRM_DEVCERT_SECURECLOCK, NULL, 2)
TEST_API_DevCertGetAttribute(NORMAL, 9 DRM_DEVCERT_SECURECLOCKURL, NULL, http://go.microsoft.com/fwlink/?LinkId=25817)
TEST_API_DevCertGetAttribute(NORMAL, 10 DRM_DEVCERT_SECURECLOCKPUBKEY, NULL, "!CNhvvz1WaNV1AFUmetxkvm9iD4UrE9cnGUi!qcqdxMiXmD1*ikYGA==")
TEST_API_DevCertGetAttribute(NORMAL, 11 DRM_DEVCERT_METERING, NULL, 1)
TEST_API_DevCertGetAttribute(NORMAL, 12 DRM_DEVCERT_LICENSEACQUISITIONMODE, NULL, 1)
TEST_API_DevCertGetAttribute(NORMAL, 13 DRM_DEVCERT_LICENSESYNCMODE, NULL, 1)

TEST_API_DevCertGetAttribute(NORMAL, 14 DRM_DEVCERT_SYMMETRICOPTIMIZATIONS, NULL, 1)

TEST_API_DevCertGetAttribute(NORMAL, 15 DRM_DEVCERT_ENCRYPTION, NULL, 1)
TEST_API_DevCertGetAttribute(NORMAL, 16 DRM_DEVCERT_MAXCHAINDEPTH, NULL, 2)
TEST_API_DevCertGetAttribute(NORMAL, 17 DRM_DEVCERT_MAXLICENSESIZE, NULL, 10240)
TEST_API_DevCertGetAttribute(NORMAL, 18 DRM_DEVCERT_MAXHEADERSIZE, NULL, 5120)
TEST_API_DevCertGetAttribute(NORMAL, 19 DRM_DEVCERT_GROUPSECURITYLEVEL, NULL, 150)
TEST_API_DevCertGetAttribute(NORMAL, 20 DRM_DEVCERT_GROUPCERTPUBKEY, NULL, R4Y8KwUNRzd0bAG2eHyDReaYoFgjP4kNAUZOzvP1wYp0ggmpUgk2Sg==)
TEST_API_DevCertGetAttribute(NORMAL, 21 DRM_DEVCERT_GROUPCERTDATANODE, NULL, IGNORE)
TEST_API_DevCertGetAttribute(NORMAL, 22 DRM_DEVCERT_GROUPCERTSIGNATURE, NULL, fGe30aAGrJ/0ZSK+QxuVDFKgXYQ9Z8B4FXKL/KMaHOShy+XMjFCUZg==)
TEST_API_DevCertGetAttribute(NORMAL, 23 DRM_DEVCERT_DACSECURITYLEVEL, NULL, 150)
TEST_API_DevCertGetAttribute(NORMAL, 24 DRM_DEVCERT_SUBJECTID, NULL, 42)
TEST_API_DevCertGetAttribute(NORMAL, 25 DRM_DEVCERT_DACPUBKEY, NULL, BK0TrceAT9k0KF1Rj*m2agup2U0p1s0b*ZqMe6ys6JuUAwdEmqglDg==)
TEST_API_DevCertGetAttribute(NORMAL, 26 DRM_DEVCERT_DACDATANODE, NULL, IGNORE)
TEST_API_DevCertGetAttribute(NORMAL, 27 DRM_DEVCERT_DACSIGNATURE, NULL, !urXn9xY7VYLzb5SgBa3k2w!1GOM73p7g56pXFpDdqx!bCUcblmJBA==)
TEST_API_DevCertGetAttribute(NORMAL, 28 DRM_DEVCERT_DACROOTPUBKEY, NULL, a1t3hxrg!qbOgktnbYaEEi4teCse!gz6RvTPuC!zizKJlpU7xoduSw==)
TEST_API_DevCertGetAttribute(NORMAL, 29 DRM_DEVCERT_AUTHROOTDATANODE, NULL, IGNORE)
TEST_API_DevCertGetAttribute(NORMAL, 30 DRM_DEVCERT_AUTHROOTSIGNATURE, NULL, TfY1*7027R3BKl250wI9iWZ1P1iT6IdfiAqZ1WfaBenuYkIVVulcKg==)

TEST_API_DevCertGetAttribute(NORMAL, 1 DRM_DEVCERT_SERIALNUMBER, <UNIQUEID private="1">CgoKCgoKCgoKCgoKCgoKCgoKCgo=</UNIQUEID>, NULL)
'TEST_API_DevCertGetAttribute(NORMAL, 3 DRM_DEVCERT_DEVICEPRIVKEY, <KEYDATA>GgiTW/I53qZncoLHHAAmbtWOspU=</KEYDATA>, NULL)

110463:BVT:P0:DRM_DCP_VerifyDeviceCert should verify valid devcert
TEST_API_DevCertVerifyDeviceCert(NORMAL, 1 DRM_DCP_VERIFY_DEVICE_CERT, NORMAL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 2 DRM_DCP_VERIFY_GROUP_CERT, NORMAL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)

-------------------BVT ends here--------------------------

110464:DevCertGetAttribute should return an error if a default attribute is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, GROUP, DATA/FEATURES/CLOCK)
TEST_API_DevCertGetAttribute(NORMAL, 8 DRM_DEVCERT_SECURECLOCK, NULL, IGNORE)=-2147172273(0X8004C04F, DRM_E_XMLNOTFOUND)

110465:DRM_DCP_GetAttribute fails when asked for invalid attribute
TEST_API_DevCertGetAttribute(NORMAL, 100 Invalid attribute, NULL, IGNORE)=-2147024809(0X80070057, E_INVALIDARG)

110466:DRM_DCP_GetAttribute returns error on null parameters
TEST_API_DevCertGetAttribute(NULL, 1, IGNORE, IGNORE)=-2147024809(0X80070057, E_INVALIDARG)
TEST_API_DevCertGetAttribute(NORMAL, 1, NULL, NULL)=-2147024809(0X80070057, E_INVALIDARG)

110467:DRM_DCP_VerifyDeviceCert(device) should fail if signature is broken
TEST_ChangeDevcertNode(Modify, CERTIFICATE, DEVICE, DATA/UNIQUEID)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 1 DRM_DCP_VERIFY_DEVICE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 2 DRM_DCP_VERIFY_GROUP_CERT, NORMAL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)

110468:DRM_DCP_VerifyDeviceCert(all) should fail if security level is modified
TEST_ChangeDevcertNode(Modify, CERTIFICATE, GROUP, DATA/SECURITYLEVEL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 2 DRM_DCP_VERIFY_GROUP_CERT, NORMAL)=-2147172299(0X8004C035, DRM_E_INVALIDDEVICECERTIFICATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172299(0X8004C035, DRM_E_INVALIDDEVICECERTIFICATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 1 DRM_DCP_VERIFY_DEVICE_CERT, NORMAL)=-2147172299(0X8004C035, DRM_E_INVALIDDEVICECERTIFICATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147172299(0X8004C035, DRM_E_INVALIDDEVICECERTIFICATE)

110556:DRM_DCP_VerifyDeviceCert(group) should fail if group cert is modified
TEST_ChangeDevcertNode(Modify, CERTIFICATE, GROUP, DATA/MODEL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 2 DRM_DCP_VERIFY_GROUP_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 1 DRM_DCP_VERIFY_DEVICE_CERT, NORMAL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)

110469:DRM_DCP_VerifyDeviceCert(DAC) should fail if DAC is modified
TEST_ChangeDevcertNode(Modify, CERTIFICATE, AUTHORIZATION, DATA/SECURITYLEVEL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 1 DRM_DCP_VERIFY_DEVICE_CERT, NORMAL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 2 DRM_DCP_VERIFY_GROUP_CERT, NORMAL)

110470:DRM_DCP_VerifyDeviceCert(DAC) should fail if root cert is modified
TEST_ChangeDevcertNode(Modify, CERTIFICATE, AUTHORIZATION_ROOT, DATA/PUBLICKEY)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 1 DRM_DCP_VERIFY_DEVICE_CERT, NORMAL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 2 DRM_DCP_VERIFY_GROUP_CERT, NORMAL)

110471:No time bomb in devcert
TEST_RollForwardClockInYears(10)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)

110472:DRM_DCP_VerifyDeviceCert(DAC) should fail if root signature node is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, AUTHORIZATION_ROOT, MSDRM_SIGNATURE_VALUE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)

111543:DRM_DCP_VerifyDeviceCert(DAC) should fail if DAC signature node is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, AUTHORIZATION, MSDRM_SIGNATURE_VALUE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)

111544:DRM_DCP_VerifyDeviceCert(GROUP) should fail if group signature node is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, GROUP, MSDRM_SIGNATURE_VALUE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 2 DRM_DCP_VERIFY_GROUP_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)

111545:DRM_DCP_VerifyDeviceCert(DEVICE) should fail if the device signature node is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, DEVICE, MSDRM_SIGNATURE_VALUE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 1 DRM_DCP_VERIFY_DEVICE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)

111546:DRM_DCP_VerifyDeviceCert(DAC) should fail if the root pubkey is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, AUTHORIZATION_ROOT, DATA/PUBLICKEY)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147172273(0X8004C04F, DRM_E_XMLNOTFOUND)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172273(0X8004C04F, DRM_E_XMLNOTFOUND)

111547:DRM_DCP_VerifyDeviceCert(DAC) should fail if the dac pubkey is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, AUTHORIZATION, DATA/PUBLICKEY)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172273(0X8004C04F, DRM_E_XMLNOTFOUND)

111548:DRM_DCP_VerifyDeviceCert(GROUP) should fail if the group pubkey is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, GROUP, DATA/PUBLICKEY)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 2 DRM_DCP_VERIFY_GROUP_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172286(0X8004C042, DRM_E_INVALIDDEVICECERTIFICATETEMPLATE)

111549:DRM_DCP_VerifyDeviceCert(DEVICE) should fail if the fallback cert is missing
TEST_ChangeDevcertNode(Remove, FALLBACK, NULL, NULL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 1 DRM_DCP_VERIFY_DEVICE_CERT, NORMAL)=-2147172273(0X8004C04F, DRM_E_XMLNOTFOUND)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172273(0X8004C04F, DRM_E_XMLNOTFOUND)

111550:DRM_DCP_VerifyDeviceCert(GROUP) should fail if the group cert is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, GROUP, NULL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 2 DRM_DCP_VERIFY_GROUP_CERT, NORMAL)=-2147172299(0X8004C035, DRM_E_INVALIDDEVICECERTIFICATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172299(0X8004C035, DRM_E_INVALIDDEVICECERTIFICATE)

111551:DRM_DCP_VerifyDeviceCert(DAC) should fail if the dac node is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, AUTHORIZATION, NULL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147172299(0X8004C035, DRM_E_INVALIDDEVICECERTIFICATE)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172299(0X8004C035, DRM_E_INVALIDDEVICECERTIFICATE)

111552:DRM_DCP_VerifyDeviceCert(DAC) should fail if the root node is missing
TEST_ChangeDevcertNode(Remove, CERTIFICATE, AUTHORIZATION_ROOT, NULL)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147172273(0X8004C04F, DRM_E_XMLNOTFOUND)
TEST_API_DevCertVerifyDeviceCert(NORMAL, 7 DRM_DCP_VERIFY_ENTIRE_CERT, NORMAL)=-2147172273(0X8004C04F, DRM_E_XMLNOTFOUND)

111553:DRM_DCP_VerifyDeviceCert fails on null devcert
TEST_API_DevCertVerifyDeviceCert(NULL, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147024809(0X80070057, E_INVALIDARG)
TEST_API_DevCertVerifyDeviceCert(EMPTY, 4 DRM_DCP_VERIFY_DAC, NORMAL)=-2147024809(0X80070057, E_INVALIDARG)

111554:DRM_DCP_VerifyDeviceCert fails on null crypto context
TEST_API_DevCertVerifyDeviceCert(NORMAL, 4 DRM_DCP_VERIFY_DAC, NULL)=-2147024809(0X80070057, E_INVALIDARG)

111555:DRM_DCP_VerifyDeviceCert fails on invalid attribute flag
TEST_API_DevCertVerifyDeviceCert(NORMAL, 100 Invalid, NORMAL)=-2147024809(0X80070057, E_INVALIDARG)
