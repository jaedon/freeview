1294:BVT: Successfully open media session
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_NDTMGR_ASF_Close()


1295:BVT: Verify DRM status - license available
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_CheckASFFlags(NDTMGR_ASF_WMDRMPROTECTED, 1)
Test_CheckASFFlags(NDTMGR_ASF_LICENSE_PLAYAVAILABLE, 1)
Test_NDTMGR_ASF_Close()


1296:BVT: Call NDT_ASF_GetHeader sucessfully
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, SAMPLES, PRCocktailJazz_output.wma)
Test_NDTMGR_ASF_GetHeader(PRCocktailJazz.wma)
Test_NDTMGR_ASF_Close()


1297:BVT: Transfer file - do not get license, just transfer
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_CheckASFFlags(NDTMGR_ASF_WMDRMPROTECTED, 1)
Test_CheckASFFlags(NDTMGR_ASF_LICENSE_PLAYAVAILABLE, 1)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(4096, PRCocktailJazz.wma)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()


1298:BVT: Get License Transfer file
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()


1299:BVT: Transfer data after session is closed
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_ReadData(4096)=0X8004CE04(DRM_E_ND_INVALID_SESSION)


1300:BVT: Transfer file and revalidate during the transfer
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()


1301:BVT: Read data without calling NDTMGR_ASF_InitTranscryption first
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()


999009:BVT: Call NDTMGR_ASF_ReadSample, seek forward, read sample, seek backward, and read sample
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, SAMPLES, PRCocktailJazz_output.wma)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(4500)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


1302: Set current time position to middle of file protected content
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_ReadData(131070)
Test_NDTMGR_ASF_Close()


-------------------BVTs end here--------------------------


1303:FUNC: Open media session should fail when revalidation time has expired
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_ChangeTimeMilliseconds(VALIDATION_TIMEOUT)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0x8004CE00(DRM_E_ND_MUST_REVALIDATE)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)


1304:FUNC: License request with bad serial number should fail
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0x8004a000(DRM_E_DEVICE_NOT_REGISTERED)
Test_NDTMGR_ASF_Close()


1305:FUNC: License request should fail when revalidation time has expired
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_ChangeTimeMilliseconds(VALIDATION_TIMEOUT)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0x8004CE00(DRM_E_ND_MUST_REVALIDATE)
Test_NDTMGR_ASF_Close()


999014:FUNC: Call NDT_ASF_GetHeader with NULL context
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ASF_GetHeader=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()=-2147024809(DRM_E_INVALIDARG)


999015:FUNC: Transfer file, let validation time out, revalidate, resume transfer
TestManagerSetRights( Play )
TestManagerSetHeader( NORMAL, PRCocktailJazz.dat, BINARY)
TestManagerAddXMRLicense( u796ftxBWEmB7zetNdOetg== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL , Acl2BY3ITE0qe11DalmK0D== , NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, COCKTAIL )
TestManagerProcessResponse( Dump, Dump, 0, 0 )
TestManagerEncrypt(RC4 CipherType, 100 DataLengthToEncrypt, NULL  )
TestManagerAddXMRLicense( Acl2BY3ITE0qe11DalmK0D== , RANDOM , XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I , NULL, ROOT)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PRCocktailJazz.wma, MUXED, PRCocktailJazz_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_ChangeTimeMilliseconds(VALIDATION_TIMEOUT)
Test_NDTMGR_ASF_ReadData(4096)=0x8004CE00(DRM_E_ND_MUST_REVALIDATE)
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_ASF_ReadData(131070)
Test_NDTMGR_ASF_Close()
