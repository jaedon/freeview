-------------------BVT ends here--------------------------
'REVOCATION TESTS

30010: Add App revocation list to secure store, and retrieve it using Drm_Revocation_GetList and then call DRM_MGR_GetRevInfo
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(!3x8NSroVg4eXCzWqPU!BA==,{00000507-0000-0010-8000-00AA006D2EA4},64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<REVINFOVERSION>1</REVINFOVERSION><ONACTION type=\"Play\"><RESTRICTIONS><COMPRESSEDDIGITALVIDEO level='300'/></RESTRICTIONS><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",ERdtAxucAFKJnAWxuFQYuyVd3BAFR7N!PO8vPJWRPzxV0MaUNCXrSQ==,300RGKoeuuIsIX04ZRKnNVZVP3fFXjykdp0o2hRG)
TestManagerSetRevocationInfo(files\rlvi_1_app_16.b64.signed_wchar)
TestManagerSetRevocation({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_16.b64_wchar)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
TestManagerGetRevocationList({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_16.b64_wchar)
TestManagerGetRevocationList(DRM_REVOCATION_TYPE_WMDRM_REVINFO, files\rlvi_1_app_16.b64.signed_wchar,TRUE)
TestManagerReinitialize( Reset, FALSE, FALSE )


30040: Process a different license response containing the same App revocation list
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(!3x8NSroVg4eXCzWqPU!BA==,{00000507-0000-0010-8000-00AA006D2EA4},64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<REVINFOVERSION>1</REVINFOVERSION><ONACTION type=\"Play\"><RESTRICTIONS><COMPRESSEDDIGITALVIDEO level='300'/></RESTRICTIONS><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",ERdtAxucAFKJnAWxuFQYuyVd3BAFR7N!PO8vPJWRPzxV0MaUNCXrSQ==,300RGKoeuuIsIX04ZRKnNVZVP3fFXjykdp0o2hRG)
TestManagerSetRevocationInfo(files\rlvi_1_app_16.b64.signed_wchar)
TestManagerSetRevocation({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_16.b64_wchar)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
TestManagerGetRevocationList({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_16.b64_wchar)
TestManagerGetRevocationList(DRM_REVOCATION_TYPE_WMDRM_REVINFO, files\rlvi_1_app_16.b64.signed_wchar,TRUE)
TestManagerInitResponse
TestManagerAddLicenseToResponse(Ygiiuk82iokl11==,{00000504-0000-0010-8000-00AA006D2EA4},0,NULL,ERdtAxucAFKJnAWxuFQYuyVd3BAFR7N!PO8vPJWRPzxV0MaUNCXrSQ==,300RGKoeuuIsIX04ZRKnNVZVP3fFXjykdp0o2hRG)
TestManagerSetRevocationInfo(files\rlvi_1_app_16.b64.signed_wchar)
TestManagerSetRevocation({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_16.b64_wchar)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
TestManagerGetRevocationList({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_16.b64_wchar)
TestManagerGetRevocationList(DRM_REVOCATION_TYPE_WMDRM_REVINFO, files\rlvi_1_app_16.b64.signed_wchar,TRUE)
TestManagerReinitialize( Reset, FALSE, FALSE )


30100: Process a license response containing App revocation list with higher index
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(!3x8NSroVg4eXCzWqPU!BA==,{00000507-0000-0010-8000-00AA006D2EA4},64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<REVINFOVERSION>1</REVINFOVERSION><ONACTION type=\"Play\"><RESTRICTIONS><COMPRESSEDDIGITALVIDEO level='300'/></RESTRICTIONS><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",ERdtAxucAFKJnAWxuFQYuyVd3BAFR7N!PO8vPJWRPzxV0MaUNCXrSQ==,300RGKoeuuIsIX04ZRKnNVZVP3fFXjykdp0o2hRG)
TestManagerSetRevocationInfo(files\rlvi_1_app_16.b64.signed_wchar)
TestManagerSetRevocation({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_16.b64_wchar)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
TestManagerGetRevocationList({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_16.b64_wchar)
TestManagerGetRevocationList(DRM_REVOCATION_TYPE_WMDRM_REVINFO, files\rlvi_1_app_16.b64.signed_wchar,TRUE)
TestManagerInitResponse
TestManagerAddLicenseToResponse(Ygiiuk82iokl11==,{00000504-0000-0010-8000-00AA006D2EA4},0,NULL,ERdtAxucAFKJnAWxuFQYuyVd3BAFR7N!PO8vPJWRPzxV0MaUNCXrSQ==,300RGKoeuuIsIX04ZRKnNVZVP3fFXjykdp0o2hRG)
TestManagerSetRevocationInfo(files\rlvi_4_app_22.b64.signed_wchar)
TestManagerSetRevocation({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_22.b64_wchar)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
TestManagerGetRevocationList({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_22.b64_wchar)
TestManagerGetRevocationList(DRM_REVOCATION_TYPE_WMDRM_REVINFO, files\rlvi_4_app_22.b64.signed_wchar,TRUE)
TestManagerReinitialize( Reset, FALSE, FALSE )


30110: Process a license response containing App revocation list with lower index
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(!3x8NSroVg4eXCzWqPU!BA==,{00000507-0000-0010-8000-00AA006D2EA4},64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<REVINFOVERSION>1</REVINFOVERSION><ONACTION type=\"Play\"><RESTRICTIONS><COMPRESSEDDIGITALVIDEO level='300'/></RESTRICTIONS><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",ERdtAxucAFKJnAWxuFQYuyVd3BAFR7N!PO8vPJWRPzxV0MaUNCXrSQ==,300RGKoeuuIsIX04ZRKnNVZVP3fFXjykdp0o2hRG)
TestManagerSetRevocationInfo(files\rlvi_1_app_22.b64.signed_wchar)
TestManagerSetRevocation({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_22.b64_wchar)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
TestManagerGetRevocationList({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_22.b64_wchar)
TestManagerGetRevocationList(DRM_REVOCATION_TYPE_WMDRM_REVINFO, files\rlvi_1_app_22.b64.signed_wchar,TRUE)
TestManagerInitResponse
TestManagerAddLicenseToResponse(Ygiiuk82iokl11==,{00000504-0000-0010-8000-00AA006D2EA4},0,NULL,ERdtAxucAFKJnAWxuFQYuyVd3BAFR7N!PO8vPJWRPzxV0MaUNCXrSQ==,300RGKoeuuIsIX04ZRKnNVZVP3fFXjykdp0o2hRG)
TestManagerSetRevocationInfo(files\rlvi_5_app_16.b64.signed_wchar)
TestManagerSetRevocation({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_16.b64_wchar)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
TestManagerGetRevocationList({90A37313-0ECF-4CAA-A906-B188F6129300}, files\crl_app_22.b64_wchar)
TestManagerGetRevocationList(DRM_REVOCATION_TYPE_WMDRM_REVINFO, files\rlvi_5_app_16.b64.signed_wchar,TRUE)
TestManagerReinitialize( Reset, FALSE, FALSE )


30180: Process a license response containing invalid App revocation list, it should fail 
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(!3x8NSroVg4eXCzWqPU!BA==,{00000507-0000-0010-8000-00AA006D2EA4},64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<REVINFOVERSION>1</REVINFOVERSION><ONACTION type=\"Play\"><RESTRICTIONS><COMPRESSEDDIGITALVIDEO level='300'/></RESTRICTIONS><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",ERdtAxucAFKJnAWxuFQYuyVd3BAFR7N!PO8vPJWRPzxV0MaUNCXrSQ==,300RGKoeuuIsIX04ZRKnNVZVP3fFXjykdp0o2hRG)
TestManagerSetRevocationInfo(files\rlvi_1_app_16.b64.signed_wchar)
TestManagerSetRevocation({90A37313-0ECF-4CAA-A906-B188F6129300}, files\invalid_crl_app_16.b64_wchar)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)=0X8004A018 ( DRM_E_INVALID_REVOCATION_LIST )
TestManagerReinitialize( Reset, FALSE, FALSE )

