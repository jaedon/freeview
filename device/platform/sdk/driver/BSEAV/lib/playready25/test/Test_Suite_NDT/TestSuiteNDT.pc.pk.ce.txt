1019:BVT: Successful initialization
Test_DRM_NDT_Initialize

1049:BVT: Sucessful initialization and uninitialization
Test_DRM_NDT_Initialize
Test_DRM_NDT_Uninitialize()

1548:BVT: Successful registration request/response
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()

1675:BVT: Registration, not revoked
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_5.b64)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()

1678:BVT: Registration, leaf-license revoked
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_8.b64)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()=0X8004C053(DRM_E_CERTIFICATE_REVOKED)

1681:BVT: Registration, Newer revocation list replaces old one
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_5.b64)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_8.b64)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()=0X8004C053(DRM_E_CERTIFICATE_REVOKED)

1684:BVT: Registration, non leaf-license revoked
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_6.b64)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()=0X8004C053(DRM_E_CERTIFICATE_REVOKED)

1481:BVT: Successful proximity
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)

1135:BVT: Successful open media session
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_Close()


1139:BVT: Verify DRM status - license available
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_CheckASFFlags(NDTMGR_ASF_WMDRMPROTECTED, 1)
Test_CheckASFFlags(NDTMGR_ASF_LICENSE_PLAYAVAILABLE, 1)
Test_NDTMGR_ASF_Close()


1145:BVT: Read to end
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_CheckASFFlags(NDTMGR_ASF_WMDRMPROTECTED, 1)
Test_CheckASFFlags(NDTMGR_ASF_LICENSE_PLAYAVAILABLE, 1)
Test_NDTMGR_ASF_ReadAllData(4096)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()
' Check that jazz1_output.wma matches jazz1.wma as is without any encryption or decryption.


1158:BVT: Open media session without registering
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_Close()


1224:BVT: Verify DRM status - unprotected content, no license available
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_CheckASFFlags(NDTMGR_ASF_WMDRMPROTECTED, 0)
Test_CheckASFFlags(NDTMGR_ASF_LICENSE_PLAYAVAILABLE, 0)
Test_NDTMGR_ASF_Close()

1229:BVT: Open media session protected content when another session is already open
SkipTestIf(!WMDRMSupported)
'Adding license for jazz1.wma
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
'Add license for jazz2.wma
TestManagerAddLicenseToResponse(7VUynQnO1kSIh5PA7asPfA==,{1CB8F9A7-AEA1-4B10-9A5C-BEB1B3D3F8D1},64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (machine.datetime > #20141125Z#)?(secstate.deleted=1;deletelicense();0):(!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)) && (machine.datetime <= #20141125Z#?1:(secstate.drmreason=1;0)))  ]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_Init(jazz2.wma, MUXED, jazz2_output.wma)
Test_NDTMGR_ASF_Close()


1686:BVT: Get License
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_Close()


1692:BVT: Get license for unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0x8004c013(DRM_E_LICENSE_NOT_FOUND)
Test_NDTMGR_ASF_Close()

1724:BVT: Get License for content with high minimum security level
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 2000?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0x8004c013(DRM_E_LICENSE_NOT_FOUND)
Test_NDTMGR_ASF_Close()


1733:BVT: Verify Device Key
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_Close()
Test_CheckDeviceKey(files\DeviceRSAPubKey1.bin)


1735:BVT: Verify SettingsObject
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_Close()
Test_CheckSettingsObject(1)


5026:BVT: Verify failure of NDTMGR_ASF_InitTranscryption called without registering device first
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0X8004CE04(DRM_E_ND_INVALID_SESSION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)


1739:BVT: Verify Source ID
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS,"<INCLUSIONLIST><GUID>{00000507-0009-0010-8000-00AA006D2EA4}</GUID><GUID>{00000508-0009-0010-8000-00AA006D2EA5}</GUID></INCLUSIONLIST><SOURCEID>3</SOURCEID><ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_Close()
Test_CheckSourceID(3)


1742:BVT: Verify Inclusion List
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS,"<INCLUSIONLIST><GUID>{00000507-0009-0010-8000-00AA006D2EA4}</GUID><GUID>{00000508-0009-0010-8000-00AA006D2EA5}</GUID></INCLUSIONLIST><SOURCEID>3</SOURCEID><ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_Close()
Test_CheckInclusionList({00000507-0009-0010-8000-00AA006D2EA4},{00000508-0009-0010-8000-00AA006D2EA5})


1988:BVT: Verify Source ID in SAMPLES mode
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS,"<INCLUSIONLIST><GUID>{00000507-0009-0010-8000-00AA006D2EA4}</GUID><GUID>{00000508-0009-0010-8000-00AA006D2EA5}</GUID></INCLUSIONLIST><SOURCEID>3</SOURCEID><ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_CheckSourceID(3)
Test_NDTMGR_ASF_Close()


1989:BVT: Verify Inclusion List in Samples Mode
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS,"<INCLUSIONLIST><GUID>{00000507-0009-0010-8000-00AA006D2EA4}</GUID><GUID>{00000508-0009-0010-8000-00AA006D2EA5}</GUID></INCLUSIONLIST><SOURCEID>3</SOURCEID><ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_CheckInclusionList({00000507-0009-0010-8000-00AA006D2EA4},{00000508-0009-0010-8000-00AA006D2EA5})
Test_NDTMGR_ASF_Close()


1990:BVT: Call NDT_ASF_GetHeader sucessfully
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_GetHeader(jazz1.wma)
Test_NDTMGR_ASF_Close()


5208:BVT: NDT_ASF_GetHeader called without calling NDTMGR_ASF_InitTranscryption first (Not a failure)
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_Close()


1996:BVT: Call NDT_ASF_GetLeafLicenseResponse sucessfully
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_Close()


1558:BVT: Transfer file - do not get license, just transfer
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_CheckASFFlags(NDTMGR_ASF_WMDRMPROTECTED, 1)
Test_CheckASFFlags(NDTMGR_ASF_LICENSE_PLAYAVAILABLE, 1)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(4096, jazz1.wma)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()


1563:BVT: Get License Transfer file
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()


1573:BVT: Transfer file - clear content, no registration required
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_ReadAllData(4096)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()

1578:BVT: Transfer data after session is closed
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_ReadData(4096)=0X8004CE04(DRM_E_ND_INVALID_SESSION)


1583:BVT: Transfer file protected content (play forever license)
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(4096, jazz_clear.wma)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()


1588:BVT: Transfer file protected content (play count license)
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[ secstate.PlayCount > 0  ]]></CONDITION><ACTION><![CDATA[ secstate.PlayCount--;(secstate.PlayCount <= 0)?(secstate.deleted=1;deletelicense();0):0  ]]></ACTION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT><ONSTORE><ACTION><![CDATA[ !exists(secstate.PlayCount)?secstate.PlayCount=5:0;!exists(secstate.BeginPlayCount)?secstate.BeginPlayCount=5:0;!exists(secstate.MinAppSecLevel)?secstate.MinAppSecLevel=150:0  ]]></ACTION></ONSTORE>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadAllData(4096)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()


1593:BVT: Transfer file protected content (metered license)
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<MID>pIKx8Wsy5aYRQN8LLIIcTQ==</MID><ONACTION type=\"Play\"><CONDITION><![CDATA[ secstate.PlayCount > 0  ]]></CONDITION><ACTION><![CDATA[ secstate.PlayCount--;(secstate.PlayCount <= 0)?(secstate.deleted=1;deletelicense();0):0  ]]></ACTION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT><ONSTORE><ACTION><![CDATA[ !exists(secstate.PlayCount)?secstate.PlayCount=5:0;!exists(secstate.BeginPlayCount)?secstate.BeginPlayCount=5:0;!exists(secstate.MinAppSecLevel)?secstate.MinAppSecLevel=150:0  ]]></ACTION></ONSTORE>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadAllData(4096)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()


1598:BVT: Transfer file protected content (OPL license)
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><RESTRICTIONS><ANALOGVIDEO level=\"200\"/></RESTRICTIONS><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>",7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadAllData(4096)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()


1745:BVT: Transfer file and revalidate during the transfer
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()


1603:BVT: Transfer file clear content and verify not transcrypted
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(4096, jazz_clear.wma)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()

1608:BVT: Transfer file protected content and verify not transcrypted
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header2.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(7VUynQnO1kSIh5PA7asPfA==,{1CB8F9A7-AEA1-4B10-9A5C-BEB1B3D3F8D1}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (machine.datetime > #20141125Z#)?(secstate.deleted=1;deletelicense();0):(!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>",7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz2.wma, MUXED, jazz2_output.wma)
Test_NDTMGR_ASF_ReadAllData(4096)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()
' Check that jazz2_output.wma matches jazz2.wma as is without any encryption or decryption.


1751:BVT: Transfer file and reregister during the transfer
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_ASF_ReadData(131070)
Test_NDTMGR_ASF_Close()
' A decrypted Jazz1_output.wma should match jazz_clear.wma at this point.


1764:BVT: Transfer file and reregister with different certificate during the transfer
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert2.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey2.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_ASF_ReadData(131070)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadAllData(4096)
Test_NDTMGR_ASF_Close()
' A decrypted Jazz1_output.wma should match jazz_clear.wma at this point.


1773:BVT: Transfer file unprotected content and reregister during the transfer
Test_DRM_NDT_Initialize
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_ReadData(4096)
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_ReadData(131070)
Test_NDTMGR_ASF_Close()
' Check that jazz_clear_output.wma matches jazz_clear.wma as is without any encryption or decryption.

1777:BVT: Register with one certificate then register with another
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert2.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey2.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(4096,jazz_clear_wma.asf,31)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()
' A decrypted Jazz1_output.wma should match jazz_clear.wma at this point.


6034:BVT: Read data without calling NDTMGR_ASF_InitTranscryption first
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()


1870:BVT: License with revocation check, not revoked
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_5.b64)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Close()


1872:BVT: License with revocation check, leaf-license revoked
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_8.b64)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0X8004C053(DRM_E_CERTIFICATE_REVOKED)
Test_NDTMGR_ASF_Close()


1874:BVT: Newer revocation list replaces old one
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_5.b64)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_8.b64)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0X8004C053(DRM_E_CERTIFICATE_REVOKED)
Test_NDTMGR_ASF_Close()


6200:BVT: Call NDTMGR_ASF_ReadSample successfully
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)
Test_NDTMGR_ASF_Close()


6201:BVT: Call NDTMGR_ASF_ReadSample and read to end successfully
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadAllSamples(8192)
Test_NDTMGR_ASF_Close()


6202:BVT: Call NDTMGR_ASF_ReadSample, seek forward, read sample, seek backward, and read sample
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(4500)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6203:BVT: Call NDTMGR_ASF_ReadSample after seeking immediately
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_Seek(4500)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6312:BVT: Seek command immediately after license acquisition protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6320:BVT: Set current time position to middle of file unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, SAMPLES, jazz_clear_output.wma)
Test_NDTMGR_ASF_GetHeader(jazz_clear.wma)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_ReadSample(131070)
Test_NDTMGR_ASF_Close()

6321:BVT: Set current time position to middle of file protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader(jazz1.wma)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_ReadSample(131070)
Test_NDTMGR_ASF_Close()


6330:BVT: Set current time position to start of file protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader(jazz1.wma)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6331:BVT: Set current time position to start of file unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, SAMPLES, jazz_clear_output.wma)
Test_NDTMGR_ASF_GetHeader(jazz_clear.wma)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6361:BVT: Jump current time position around a bit unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, SAMPLES, jazz_clear_output.wma)
Test_NDTMGR_ASF_GetHeader(jazz_clear.wma)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()


1800:BVT: Set current time position to middle of file unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_ReadData(131070)
Test_NDTMGR_ASF_Close()


1802:BVT: Set current time position to middle of file protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_ReadData(131070)
Test_NDTMGR_ASF_Close()


1804:BVT: Set current time position to start of file protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


1806:BVT: Set current time position to start of file unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()

1816:BVT: Jump current time position around a bit protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_ReadData(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadData(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadData(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()


1818:BVT: Jump current time position around a bit unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_ReadData(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadData(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadData(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()

1820:BVT: Jump current time position around a bit protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadData(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()


1822:BVT: Jump current time position around a bit unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadData(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()

1950:BVT: Call NDTMGR_ProcessLicenseChallenge successfully with SIMPLE license mode
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1951:BVT: Call NDTMGR_ProcessLicenseChallenge successfully with CHAINED license mode
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_CloseSession(CONTENT)

2065:BVT: Verify failure of NDTMGR_ProcessLicenseChallenge called without registering device first
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=0X8004CE04(DRM_E_ND_INVALID_SESSION)

2066:BVT: Verify failure of NDTMGR_ProcessLicenseChallenge called without initiate session
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=0X8004CE04(DRM_E_ND_INVALID_SESSION)

2029:BVT: Call NDTMGR_GetLeafLicenseResponse successfully
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

8401:BVT: test asf encrypt with null pointer input
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_SetCryptoDataNULL()
Test_NDTMGR_Encrypt_ASF( DeviceTestCert.crt, 0263516363427762, 0 )=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_CloseSession(CONTENT)

8600:BVT: Verify failure when ASF content has higher app security level than global min app security level
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 1000, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=0x8004a004(DRM_E_DEVICE_SECURITY_LEVEL_TOO_LOW)
Test_NDTMGR_ASF_Close()


8601:BVT: Verify failure when a higher app security level is set in Test_NDTMGR_GetLeafLicenseResponse  than global min ap security level set in NDTMGR_ProcessLicenseChallenge
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 150, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 1000, 0, 0)
Test_NDTMGR_GetLeafLicenseResponse()=0x8004a004(DRM_E_DEVICE_SECURITY_LEVEL_TOO_LOW)
Test_NDTMGR_ASF_Close()


1470:BVT: Verify reading samples from multiple sessions
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)

TestManagerAddLicenseToResponse(Cab3lNlCjE+C+sjhTqC5ZA==,{E35DEAEA-CD39-4f9f-8B27-0B2E62906D8C}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",GwaZ58UTSek9yUUsriK8*pproW*bgn6bb9QS!2I52A62iJZiTUngWA==,C9kAEfarjbkdVR26QNN0H8M1D2dV1YKvzJboDis9)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, SAMPLES, jazz_clear_output.wma)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)
'
Test_SwitchMediaSession(1)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
'
Test_SwitchMediaSession(2)
Test_NDTMGR_ASF_Init(DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, SAMPLES, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps_output.wmv)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
'
Test_SwitchMediaSession(3)
Test_NDTMGR_ASF_Init(9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, SAMPLES, 9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps_output.wmv)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
'
Test_SwitchMediaSession(1)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)
Test_NDTMGR_ASF_Seek(4500)
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)
Test_NDTMGR_ASF_Seek(0)
'
Test_SwitchMediaSession(0)
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)
'
Test_SwitchMediaSession(1)
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)
'
Test_SwitchMediaSession(2)
Test_NDTMGR_ASF_ReadSample(8192, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(8192, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(8192, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
'
Test_SwitchMediaSession(3)
Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
'Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
'
Test_SwitchMediaSession(0)
Test_NDTMGR_ASF_Close()
'
Test_SwitchMediaSession(1)
Test_NDTMGR_ASF_Close()
'
Test_SwitchMediaSession(2)
Test_NDTMGR_ASF_Close()
'
Test_SwitchMediaSession(3)
Test_NDTMGR_ASF_Close()


'''''''''''''''''''''''''''''''
'PMF file streaming test cases

'Non-WMA/WMV cases disabled as they are not supported
'9261:BVT: Transfer file protected V4 AAC PMF content
'Test_DRM_NDT_Initialize
'Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
'Test_SetCertificate(files\DeviceTestCert1.crt)
'Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
'Test_NDTMGR_CreateSession(REGISTRATION)
'Test_NDTMGR_ProcessRegistrationRequest()
'Test_Proximity(0)
'Test_NDTMGR_CloseSession(REGISTRATION)
'TestManagerAddXMRLicense(OWjhtr3u9k+rdo1ILY0rag==,RANDOM,XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I)
'TestManagerProcessResponse( Dump, Dump, 0, 0 )
'Test_NDTMGR_ASF_Init(jazz_aes_V4_aac.asf, MUXED, jazz_aes_V4_aac_output.asf)
'Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
'Test_GetHeaders()
'Test_NDTMGR_ASF_ReadAllData(4096)
'Test_CheckLastDataBlock()
'Test_NDTMGR_ASF_Close()

'9262:BVT: Transfer file protected V4 AAC Plus
'Test_DRM_NDT_Initialize
'Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
'Test_SetCertificate(files\DeviceTestCert1.crt)
'Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
'Test_NDTMGR_CreateSession(REGISTRATION)
'Test_NDTMGR_ProcessRegistrationRequest()
'Test_Proximity(0)
'Test_NDTMGR_CloseSession(REGISTRATION)
'TestManagerAddXMRLicense(OWjhtr3u9k+rdo1ILY0rag==,RANDOM,XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I)
'TestManagerProcessResponse( Dump, Dump, 0, 0 )
'Test_NDTMGR_ASF_Init(jazz_aes_V4_aacPlus.asf, MUXED, jazz_aes_V4_aacPlus_output.asf)
'Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
'Test_GetHeaders()
'Test_NDTMGR_ASF_ReadAllData(4096)
'Test_CheckLastDataBlock()
'Test_NDTMGR_ASF_Close()

'9263:BVT: Transfer file protected V4 H264 PMF content
'Test_DRM_NDT_Initialize
'Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
'Test_SetCertificate(files\DeviceTestCert1.crt)
'Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
'Test_NDTMGR_CreateSession(REGISTRATION)
'Test_NDTMGR_ProcessRegistrationRequest()
'Test_Proximity(0)
'Test_NDTMGR_CloseSession(REGISTRATION)
'TestManagerAddXMRLicense(OWjhtr3u9k+rdo1ILY0rag==,RANDOM,XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I)
'TestManagerProcessResponse( Dump, Dump, 0, 0 )
'Test_NDTMGR_ASF_Init(MD220x176_96_384s_aes_V4_h264.asf, MUXED, MD220x176_96_384s_aes_V4_h264_output.asf)
'Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
'Test_GetHeaders()
'Test_NDTMGR_ASF_ReadAllData(4096)
'Test_CheckLastDataBlock()
'Test_NDTMGR_ASF_Close()

1473:BVT: Transfer file protected V4 WMA PMF content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
TestManagerAddXMRLicense(OWjhtr3u9k+rdo1ILY0rag==,RANDOM,XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_NDTMGR_ASF_Init(jazz_aes_V4_wma.pya, MUXED, jazz_aes_V4_wma_output.asf)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(4096,jazz_clear_wma.asf,31)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()

1468:BVT: Transfer file protected V4 WMA PMF content where the PlayReady object is in the EHO
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
TestManagerAddXMRLicense(OWjhtr3u9k+rdo1ILY0rag==,RANDOM,XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_NDTMGR_ASF_Init(jazz_aes_V4_wma_proineho.pya, MUXED, jazz_aes_V4_wma_proineho_output.asf)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(4096,jazz_clear_wma.asf,31)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()

1399:BVT: Transfer file protected V4 WMV PMF content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
TestManagerAddXMRLicense(OWjhtr3u9k+rdo1ILY0rag==,RANDOM,XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_NDTMGR_ASF_Init(MD220x176_96_384s_aes_V4_wmv.pyv, MUXED, MD220x176_96_384s_aes_V4_wmv_output.asf)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(4096,MD220x176_96_384s_clear_wmv.asf,594)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()

1469:BVT: Transfer file protected V4 WMA PMF content - Sample mode
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
TestManagerAddXMRLicense(OWjhtr3u9k+rdo1ILY0rag==,RANDOM,XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_NDTMGR_ASF_Init(jazz_aes_V4_wma.pya, SAMPLES, jazz_aes_V4_wma_output.asf)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadAllSamples(131070,jazz_clear_wma.asf,31)
Test_NDTMGR_ASF_Close()

1462:BVT: Transfer file protected V4 WMV PMF content - Sample mode
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
TestManagerAddXMRLicense(OWjhtr3u9k+rdo1ILY0rag==,RANDOM,XVBovsmzhP9gRIZxWfFta3VVRPzVEWmJsazEJ46I)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_NDTMGR_ASF_Init(MD220x176_96_384s_aes_V4_wmv.pyv, SAMPLES, MD220x176_96_384s_aes_V4_wmv_output.asf)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadAllSamples(131070,MD220x176_96_384s_clear_wmv.asf,594)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()

7050:BVT: Transfer file protected V4 WMA PMF content, SIMPLE license with only RemovalDate, expect success
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
TestManagerCreateXMRLicenseFromPool(SIMPLE, files\licenses.xml, "Simple license with 30s RemovalDate")
TestManagerGenerateXMRResponse(SIMPLE)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_NDTMGR_ASF_Init(jazz_aes_V4_wma.pya, MUXED, jazz_aes_V4_wma_output.asf)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(4096,jazz_clear_wma.asf,31)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()

7051:BVT: Transfer file protected V4 WMA PMF content, CHAINED scalable license, expect failure
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
TestManagerCreateXMRLicenseFromPool(ROOT, files\licenses.xml, "PAIR A - Root with 1 location and 30s RemovalDate")
TestManagerCreateXMRLicenseFromPool(LEAF, files\licenses.xml, "PAIR A - Permanent Leaf 0")
TestManagerGenerateXMRResponse(ROOT, LEAF)
TestManagerProcessResponse( Dump, Dump, 0, 0 )
Test_NDTMGR_ASF_Init(jazz_aes_V4_wma.pya, MUXED, jazz_aes_V4_wma_output.asf)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=DRM_E_LICENSE_NOT_FOUND

1067:FUNC: Uninitialization with NULL context
'Test_DRM_NDT_Initialize
Test_SetpNdtDrmContext(0)
Test_DRM_NDT_Uninitialize()

1352:FUNC: initialize with NULL context
Test_SetpNdtDrmContext(0)
Test_DRM_NDT_Initialize=-2147024809(DRM_E_INVALIDARG)

1082:FUNC: initialize with NULL device store name
Test_DRM_NDT_Initialize(NULL)=-2147024809(DRM_E_INVALIDARG)

1953:FUNC: Successful Registration Session Creation
Test_DRM_NDT_Initialize
Test_NDTMGR_CreateSession(REGISTRATION)

1546:FUNC: Successful Content Session Creation
Test_DRM_NDT_Initialize
Test_NDTMGR_CreateSession(CONTENT)

1102:FUNC: Successful Registration Session Creation and Closing
Test_DRM_NDT_Initialize
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_CloseSession(REGISTRATION)

1103:FUNC: Successful Content Session Creation and Closing
Test_DRM_NDT_Initialize
Test_NDTMGR_CreateSession(CONTENT)
Test_NDTMGR_CloseSession(CONTENT)

1097:FUNC: Close Session with NULL context
Test_DRM_NDT_Initialize
Test_NDTMGR_CreateSession(CONTENT)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_CloseSession(CONTENT)=-2147024809(DRM_E_INVALIDARG)


'''''''''''''''''''''''


1098:FUNC: Registration request/response with NULL context
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ProcessRegistrationRequest()=-2147024809(DRM_E_INVALIDARG)

1114:FUNC: Registration request/response with invalid certificate
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(invalid_cert.crt)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004c035(DRM_E_INVALID_DEVICE_CERTIFICATE)

1120:FUNC: Registration request/response with invalid request blob
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetpbRegistrationRequestMsgNULL
Test_NDTMGR_ProcessRegistrationRequest()=-2147024809(DRM_E_INVALIDARG)

1126:FUNC: Registration request/response with bad private key
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(invalid_ansi_rsa_key.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004c3f0(DRM_E_RSA_DECRYPTION_ERROR)

1131:FUNC: Registration response with small buffer
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetcbRegistrationResponseMsg(1)
Test_NDTMGR_ProcessRegistrationRequest()=-2147024774(DRM_E_BUFFERTOOSMALL)

1651:FUNC: Re-Registration
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_NDTMGR_ProcessRegistrationRequest()=0x8004c3ec(DRM_E_DEVICE_ALREADY_REGISTERED)

1653:FUNC: NULL pointer for pbRegistrationResponseMsg
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetpbRegistrationResponseMsgNULL()
Test_NDTMGR_ProcessRegistrationRequest()=-2147024809(DRM_E_INVALIDARG)

1655:FUNC: WmdrmNetValidateMessage with un-unpackable message type
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetcbRegistrationRequestMsg(1)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)

1657:FUNC: WmdrmNetValidateMessage with un-unpackable serial number
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetcbRegistrationRequestMsg(3)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)

1659:FUNC: WmdrmNetValidateMessage with un-unpackable certificate size
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetcbRegistrationRequestMsg(19)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)

1661:FUNC: WmdrmNetValidateMessage with un-unpackable certificate
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetcbRegistrationRequestMsg(23)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)

1663:FUNC: WmdrmNetValidateMessage with incorrect protocol version
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetMessageProtocolVersion(1)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)

1665:FUNC: WmdrmNetValidateMessage with incorrect message type
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetMessageType(99)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)

1667:FUNC: Registration with alternate certificate
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert2.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey2.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()

1669:FUNC: Registration with mismatch certificate/private key 1
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey2.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004c3f0(DRM_E_RSA_DECRYPTION_ERROR)

1671:FUNC: Registration with mismatch certificate/private key 2
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert2.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004c3f0(DRM_E_RSA_DECRYPTION_ERROR)

1673:FUNC: Registration with zero length certificate
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_SetcbCertificate(1)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()=0x8004c035(DRM_E_INVALID_DEVICE_CERTIFICATE)


'''''''''''''''''''''''


1234:FUNC: Proximity challenge with null context
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ProcessProximityStartMsg()=-2147024809(DRM_E_INVALIDARG)

1239:FUNC: Proximity challenge with bad registration session id
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_SetRegistrationSessionID(00000000000000000000000000000000)
Test_NDTMGR_ProcessProximityStartMsg()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

1244:FUNC: Proximity challenge in improper sequence
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessProximityStartMsg()=0x8004a000(DRM_E_DEVICE_NOT_REGISTERED)

1251:FUNC: Proximity fails because it took too long
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(100)=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)

1256:FUNC: Proximity with bad nonce
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_SetChallengeID(0, 1, 2, 3)
Test_Proximity(0)=0x8004CE07(DRM_E_ND_INVALID_PROXIMITY_RESPONSE)
Test_Proximity(0)=0x8004CE07(DRM_E_ND_INVALID_PROXIMITY_RESPONSE)
Test_Proximity(0)=0x8004CE07(DRM_E_ND_INVALID_PROXIMITY_RESPONSE)

1515:FUNC: Proximity Response with NULL context
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_NDTMGR_ProcessProximityStartMsg()
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ProcessProximityResponseMsg()=-2147024809(DRM_E_INVALIDARG)

1519:FUNC: Proximity Response with bad registration session id
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_NDTMGR_ProcessProximityStartMsg()
Test_SetRegistrationSessionID(00000000000000000000000000000000)
Test_NDTMGR_ProcessProximityResponseMsg()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

1523:FUNC: Proximity Response in improper sequence
Test_DRM_NDT_Initialize
Test_NDTMGR_ProcessProximityResponseMsg()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

1485:FUNC: Too much time between registration and proximity challenge
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_ChangeTimeMilliseconds(REGISTRATION_TIMEOUT)
Test_NDTMGR_ProcessProximityStartMsg()=0x8004a000(DRM_E_DEVICE_NOT_REGISTERED)

1493:FUNC: Successful proximity challenge after ten initial failures
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_Proximity(0)

1498:FUNC: Successful proximity challenge after a few "dropped messages"
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_NDTMGR_ProcessProximityStartMsg()
Test_NDTMGR_ProcessProximityStartMsg()
Test_NDTMGR_ProcessProximityStartMsg()
Test_NDTMGR_ProcessProximityStartMsg()
Test_Proximity(0)

1509:FUNC: Proximity challenge just above cutoff threshold
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(PROXIMITY_TIMEOUT)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)

3017:FUNC: NDTMGR_ProcessProximityStartMsg will small challenge buffer
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_SetTestProximityBUFFERTOOSMALL
Test_NDTMGR_ProcessProximityStartMsg()=-2147024774(DRM_E_BUFFERTOOSMALL)

3018:FUNC: NDTMGR_ProcessProximityResponseMsg with small result message buffer
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_NDTMGR_ProcessProximityStartMsg()
Test_SetTestProximityBUFFERTOOSMALL
Test_NDTMGR_ProcessProximityResponseMsg()=-2147024774(DRM_E_BUFFERTOOSMALL)

3019:FUNC: NDTMGR_ProcessProximityStartMsg with invalid proximity start message
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_SetProximityStartMsgNULL
Test_NDTMGR_ProcessProximityStartMsg()=-2147024809(DRM_E_INVALIDARG)

3020:FUNC: NDTMGR_ProcessProximityResponseMsg with invalid proximity response message
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_NDTMGR_ProcessProximityStartMsg()
Test_SetProximityResponseMsgNULL
Test_NDTMGR_ProcessProximityResponseMsg()=-2147024809(DRM_E_INVALIDARG)

3021:FUNC: Proximity with IPv4 address
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(192.168.100.1)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)

3022:FUNC: Proximity with IPv6 address
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(2001:0DB8:0000:0000:0000:0000:1428:57ab/64)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)

3023:FUNC: Proximity with short address
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(a)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)

3024:FUNC: Proximity with long (128 byte) address
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(0123456789abcdef01234567890abcdef0123456789abcdef01234567890abcdef0123456789abcdef01234567890abcdef0123456789abcdef01234567890abcdef)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)

3025:FUNC: Proximity with hostname address
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(www.microsoft.com)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)

3026:FUNC: Proximity with MTP address
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)

3027:FUNC: Registration with numbers of different devices (up to 20 devices)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(00000000000000000000000000000001)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000002)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000003)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000004)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000005)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000006)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000007)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000008)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000009)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000010)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000011)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000012)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000013)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000014)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000015)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000016)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000017)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000018)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000019)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetSerialNumber(00000000000000000000000000000020)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_SetProximityDetectionAddress(MTP)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)

3028:FUNC: Multiple proximities with the same registration Session
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_Proximity(0)
Test_Proximity(0)

3029:FUNC: Verify failure of NDTMGR_ProcessProximityResponseMsg when called in an invalid state
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_Proximity(0)
Test_Proximity(0)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004a000(DRM_E_DEVICE_NOT_REGISTERED)


'''''''''''''''''''''''


1152:FUNC: Open media session with NULL context
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header2.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(7VUynQnO1kSIh5PA7asPfA==,{1CB8F9A7-AEA1-4B10-9A5C-BEB1B3D3F8D1}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (machine.datetime > #20141125Z#)?(secstate.deleted=1;deletelicense();0):(!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>",7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ASF_Init(jazz2.wma, MUXED, jazz2_output.wma)=-2147024809(DRM_E_INVALIDARG)


1165:FUNC: Open media session with invalid delivery mode
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header2.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(7VUynQnO1kSIh5PA7asPfA==,{1CB8F9A7-AEA1-4B10-9A5C-BEB1B3D3F8D1}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (machine.datetime > #20141125Z#)?(secstate.deleted=1;deletelicense();0):(!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>",7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz2.wma, INVALID_MODE, jazz2_output.wma)=-2147024809(DRM_E_INVALIDARG)


1173:FUNC: Open media session when another session is already open
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)


1180:FUNC: Open media session with non-existent file
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(file_does_not_exist.wma, MUXED, file_does_not_exist_output.wma)=0x8003006E(DRM_E_FILEOPEN)

1187:FUNC: Open media session when revalidation time has expired
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_ChangeTimeMilliseconds(VALIDATION_TIMEOUT)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0x8004CE00(DRM_E_ND_MUST_REVALIDATE)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)


1192:FUNC: Close media session with NULL context
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ASF_Close()=-2147024809(DRM_E_INVALIDARG)


1197:FUNC: Close media session with invalid media session id
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetMediaSessionID(000102030405060708090a0b0c0d0e0f)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)


1211:FUNC: Open media session with NULL media session id
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetMediaSessionIDNULL
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)=-2147024809(DRM_E_INVALIDARG)


1212:FUNC: Open media session with NULL ASF Flags
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetASFFlagsNULL
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)=-2147024809(DRM_E_INVALIDARG)


1215:FUNC: Close media session without calling NDTMGR_ASF_Init first
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

1218:FUNC: ASF init with non-null EMPTY string for the ASF file (first parameter)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(EMPTY, MUXED, null_output.wma)=DRM_E_INVALIDARG

1221:FUNC: ASF init with bad asf file
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(DeviceTestCert.crt, MUXED, bad_output.wma)=0x8004CF00(DRM_E_ASF_BAD_ASF_HEADER)


'''''''''''''''''''''''


1689:FUNC: Process license request with NULL context
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()=-2147024809(DRM_E_INVALIDARG)


1695:FUNC: License request with improper message
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetcbLicenseChallengeMsg(1)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0x8004CE09(DRM_E_ND_BAD_REQUEST)
Test_NDTMGR_ASF_Close()


1698:FUNC: License request with bad media session id
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetMediaSessionID(000102030405060708090a0b0c0d0e0f)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0X8004CE04(DRM_E_ND_INVALID_SESSION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)


1701:FUNC: License request with bad serial number
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0x8004a000(DRM_E_DEVICE_NOT_REGISTERED)
Test_NDTMGR_ASF_Close()


1704:FUNC: License request with non matching certificate
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetCertificate(invalid_cert.crt)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0x8004a000(DRM_E_DEVICE_NOT_REGISTERED)
Test_NDTMGR_ASF_Close()


1707:FUNC: License request with case-sensitive action
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, PlAy)
Test_NDTMGR_ASF_Close()


1711:FUNC: License request with invalid action
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, NOTAREALACTION)=0x8004CE09(DRM_E_ND_BAD_REQUEST)
Test_NDTMGR_ASF_Close()


1553:FUNC: License response with small buffer
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetcbLicenseResponseMsg(1)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=-2147024774(DRM_E_BUFFERTOOSMALL)
Test_NDTMGR_ASF_Close()


1718:FUNC: License request when revalidation time has expired
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_ChangeTimeMilliseconds(VALIDATION_TIMEOUT)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0x8004CE00(DRM_E_ND_MUST_REVALIDATE)
Test_NDTMGR_ASF_Close()


1721:FUNC: NULL pointer for pbLicenseResponseMsg
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetpbLicenseResponseMsgNULL()
Test_SetcbLicenseResponseMsg(0)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=-2147024774(DRM_E_BUFFERTOOSMALL)
Test_NDTMGR_ASF_Close()


1727:FUNC: Get License for content with OPL > 100
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><RESTRICTIONS><UNCOMPRESSEDDIGITALVIDEO level=\"125\"/><UNCOMPRESSEDDIGITALAUDIO level=\"125\"/></RESTRICTIONS><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>",7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Close()


1730:FUNC: Get License for content with analog audio/video > 100
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><RESTRICTIONS><ANALOGVIDEO level=\"125\"/></RESTRICTIONS><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>",7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Close()


1737:FUNC: Verify failure of NDTMGR_ASF_InitTranscryption with NULL p and cb != 0
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetpbLicenseResponseMsgNULL()
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


5025:FUNC: Verify failure of NDTMGR_ASF_InitTranscryption with NULL cb
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetcbLicenseResponseMsgNULL()
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


5027:FUNC: Verify failure of NDTMGR_ASF_InitTranscryption called without initiate session
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0X8004CE04(DRM_E_ND_INVALID_SESSION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

5028:FUNC: Verify failure of NDTMGR_ASF_InitTranscryption called without calling NDTMGR_ASF_Init first
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0X8004CE04(DRM_E_ND_INVALID_SESSION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)


5029:FUNC: Verify failure of NDTMGR_ASF_InitTranscryption called when Session ID is invalid
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_SetMediaSessionID(000102030405060708090a0b0c0d0e0f)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)=0X8004CE04(DRM_E_ND_INVALID_SESSION)


1991:FUNC: Call NDT_ASF_GetHeader with NULL context
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ASF_GetHeader=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()=-2147024809(DRM_E_INVALIDARG)


1992:FUNC: Call NDT_ASF_GetHeader with NULL pbHeader
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetpbHeaderNULL
Test_NDTMGR_ASF_GetHeader=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


1993:FUNC: Call NDT_ASF_GetHeader with NULL pcbHeader
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetpcbHeaderNULL
Test_NDTMGR_ASF_GetHeader=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


1994:FUNC: Call NDT_ASF_GetHeader with invalid session id
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetMediaSessionID(000102030405060708090a0b0c0d0e0f)
Test_NDTMGR_ASF_GetHeader=0X8004CE04(DRM_E_ND_INVALID_SESSION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)


1995:FUNC: Call NDT_ASF_GetHeader with small output buffer
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetcbHeader(1)
Test_NDTMGR_ASF_GetHeader=-2147024774(DRM_E_BUFFERTOOSMALL)
Test_NDTMGR_ASF_Close()


5206:FUNC: Verify failure of NDT_ASF_GetHeader called without initiate session
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_ASF_GetHeader=0X8004CE04(DRM_E_ND_INVALID_SESSION)

5207:FUNC: Verify failure of NDT_ASF_GetHeader called without calling NDTMGR_ASF_Init first
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_GetHeader=0X8004CE04(DRM_E_ND_INVALID_SESSION)

5209:FUNC: Call NDT_ASF_GetHeader in muxed mode
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_GetHeader(jazz1.wma)=-2147467259(DRM_E_FAIL)


5210:FUNC: Call NDT_ASF_GetHeader without leaf
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_GetHeader(jazz1.wma)=-2147467259(DRM_E_FAIL)


5211:FUNC: Call NDT_ASF_GetHeader after timeout
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_ChangeTimeMilliseconds(VALIDATION_TIMEOUT)
Test_NDTMGR_ASF_GetHeader(jazz1.wma)=0x8004CE00(DRM_E_ND_MUST_REVALIDATE)


1997:FUNC: Call NDT_ASF_GetLeafLicenseResponse with NULL context
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ASF_GetLeafLicenseResponse()=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()=-2147024809(DRM_E_INVALIDARG)


1999:FUNC: Call NDT_ASF_GetLeafLicenseResponse with NULL pbLeafLicenseResponse
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_SetpbLeafLicenseResponseNULL
Test_NDTMGR_ASF_GetLeafLicenseResponse()=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


5304:FUNC: Call NDT_ASF_GetLeafLicenseResponse with NULL pcbLeafLicenseResponse
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetpcbLeafLicenseResponseNULL
Test_NDTMGR_ASF_GetLeafLicenseResponse()=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


5305:FUNC: Call NDT_ASF_GetLeafLicenseResponse with invalid session id
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetMediaSessionID(000102030405060708090a0b0c0d0e0f)
Test_NDTMGR_ASF_GetLeafLicenseResponse()=0X8004CE04(DRM_E_ND_INVALID_SESSION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)


5306:FUNC: Call NDT_ASF_GetLeafLicenseResponse with small output buffer
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_SetcbLeafLicenseResponse(1)
Test_NDTMGR_ASF_GetLeafLicenseResponse()=-2147024774(DRM_E_BUFFERTOOSMALL)
Test_NDTMGR_ASF_Close()


5307:FUNC: Verify failure of NDT_ASF_GetLeafLicenseResponse called without registering device first
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ASF_GetLeafLicenseResponse()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

5308:FUNC: Verify failure of NDT_ASF_GetLeafLicenseResponse called without initiate session
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_ASF_GetLeafLicenseResponse()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

5309:FUNC: Verify failure of NDT_ASF_GetLeafLicenseResponse called without calling NDTMGR_ASF_Init first
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_GetLeafLicenseResponse()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

5310:FUNC: Verify failure of NDT_ASF_GetLeafLicenseResponse called without calling NDTMGR_ASF_InitTranscryption first
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_GetLeafLicenseResponse()=0x8004a000(DRM_E_DEVICE_NOT_REGISTERED)
Test_NDTMGR_ASF_Close()


5311:FUNC: Call NDT_ASF_GetLeafLicenseResponse with MUXED mode specified in NDTMGR_ASF_Init
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()


1568:FUNC: Read data with bad media session id
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_SetMediaSessionID(000102030405060708090a0b0c0d0e0f)
Test_NDTMGR_ASF_ReadData(4096)=0X8004CE04(DRM_E_ND_INVALID_SESSION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)


1613:FUNC: Transfer file protected content with tiny block size
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(256, jazz_clear.wma, 31)
Test_NDTMGR_ASF_Close()


1618:FUNC: Transfer file clear content with tiny block size
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(256, jazz_clear.wma)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()


1748:FUNC: Transfer file, let validation time out, revalidate, resume transfer
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_ChangeTimeMilliseconds(VALIDATION_TIMEOUT)
Test_NDTMGR_ASF_ReadData(4096)=0x8004CE00(DRM_E_ND_MUST_REVALIDATE)
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_ASF_ReadData(131070)
Test_NDTMGR_ASF_Close()


1754:FUNC: Transfer file transcrypted content with large block size
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(131070)
Test_NDTMGR_ASF_ReadData(131070)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()
' A decrypted Jazz1_output.wma should match jazz_clear.wma at this point.


1623:FUNC: Transfer file protected but not transcrypted content with large block size
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header2.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(7VUynQnO1kSIh5PA7asPfA==,{1CB8F9A7-AEA1-4B10-9A5C-BEB1B3D3F8D1}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (machine.datetime > #20141125Z#)?(secstate.deleted=1;deletelicense();0):(!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>",7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz2.wma, MUXED, jazz2_output.wma)
Test_NDTMGR_ASF_ReadAllData(131070)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()
' Check that jazz2_output.wma matches jazz2.wma as is without any encryption or decryption.


1628:FUNC: Transfer file clear content with large block size
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_ReadAllData(131070)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()
' Check that jazz_clear_output.wma matches jazz_clear.wma as is without any encryption or decryption.


1632:FUNC: Transfer file protected but not transcrypted content with tiny block size
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header2.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(7VUynQnO1kSIh5PA7asPfA==,{1CB8F9A7-AEA1-4B10-9A5C-BEB1B3D3F8D1}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (machine.datetime > #20141125Z#)?(secstate.deleted=1;deletelicense();0):(!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>",7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz2.wma, MUXED, jazz2_output.wma)
Test_NDTMGR_ASF_ReadAllData(256)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()
' Check that jazz2_output.wma matches jazz2.wma as is without any encryption or decryption.


1757:FUNC: Play count license fails after play count runs out
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[ secstate.PlayCount > 0  ]]></CONDITION><ACTION><![CDATA[ secstate.PlayCount--;(secstate.PlayCount <= 0)?(secstate.deleted=1;deletelicense();0):0  ]]></ACTION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT><ONSTORE><ACTION><![CDATA[ !exists(secstate.PlayCount)?secstate.PlayCount=5:0;!exists(secstate.BeginPlayCount)?secstate.BeginPlayCount=5:0;!exists(secstate.MinAppSecLevel)?secstate.MinAppSecLevel=150:0  ]]></ACTION></ONSTORE>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)

Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)

Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()

Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()

Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()

Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()

Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()

Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0x8004c013(DRM_E_LICENSE_NOT_FOUND)
Test_NDTMGR_ASF_ReadData(4096)=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()


1760:FUNC: Play count does not decrement when content is not played
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[ secstate.PlayCount > 0  ]]></CONDITION><ACTION><![CDATA[ secstate.PlayCount--;(secstate.PlayCount <= 0)?(secstate.deleted=1;deletelicense();0):0  ]]></ACTION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT><ONSTORE><ACTION><![CDATA[ !exists(secstate.PlayCount)?secstate.PlayCount=5:0;!exists(secstate.BeginPlayCount)?secstate.BeginPlayCount=5:0;!exists(secstate.MinAppSecLevel)?secstate.MinAppSecLevel=150:0  ]]></ACTION></ONSTORE>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Close()


1771:FUNC: Attempt transfer after failed license
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header2.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(7VUynQnO1kSIh5PA7asPfA==,{1CB8F9A7-AEA1-4B10-9A5C-BEB1B3D3F8D1}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (machine.datetime > #20041125Z#)?(secstate.deleted=1;deletelicense();0):(!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>",7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz2.wma, MUXED, jazz2_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0x8004c013(DRM_E_LICENSE_NOT_FOUND)
Test_NDTMGR_ASF_ReadData(4096)=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()


1775:FUNC: Transfer a different file after a failed license
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[ secstate.PlayCount > 0  ]]></CONDITION><ACTION><![CDATA[ secstate.PlayCount--;(secstate.PlayCount <= 0)?(secstate.deleted=1;deletelicense();0):0  ]]></ACTION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT><ONSTORE><ACTION><![CDATA[ !exists(secstate.PlayCount)?secstate.PlayCount=5:0;!exists(secstate.BeginPlayCount)?secstate.BeginPlayCount=5:0;!exists(secstate.MinAppSecLevel)?secstate.MinAppSecLevel=150:0  ]]></ACTION></ONSTORE>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz2.wma, MUXED, jazz2_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0x8004c013(DRM_E_LICENSE_NOT_FOUND)
Test_NDTMGR_ASF_ReadData(4096)=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(4096, jazz_clear.wma)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()
' A decrypted Jazz1_output.wma should match jazz_clear.wma at this point.


' Following test requires that jazz1.wma be used for this. A different file may produce incorrect result.
1636:FUNC: Transfer file protected content with block size == exact file size
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadData(65536)
Test_NDTMGR_ASF_ReadData(65536)
Test_NDTMGR_ASF_ReadData(57897)
Test_CheckLastDataBlock()
Test_NDTMGR_ASF_Close()


1946:FUNC: Read data with NULL context
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ASF_ReadData(4096)=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()=-2147024809(DRM_E_INVALIDARG)


1947:FUNC: Read data with NULL pbData argument
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_SetpbDataNULL
Test_NDTMGR_ASF_ReadData(0)=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


1948:FUNC: Read data with NULL pcbData argument
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_SetpcbDataNULL
Test_NDTMGR_ASF_ReadData(4096)=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


1949:FUNC: Read data without calling NDTMGR_ASF_Init first
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_ReadData(4096)=0X8004CE04(DRM_E_ND_INVALID_SESSION)

6035:FUNC: Read data with SAMPLES delivery mode specified
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)=-2147467259(DRM_E_FAIL)


6080:FUNC: Transfer file protected content (OPL license, sample)
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><RESTRICTIONS><ANALOGVIDEO level=\"200\"/></RESTRICTIONS><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>",7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader(jazz1.wma)
Test_NDTMGR_ASF_Close()


6081:FUNC: Read data after close
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(4096)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_ReadData(4096)=0X8004CE04(DRM_E_ND_INVALID_SESSION)


2069:FUNC: License with revocation check, not revoked SAMPLE MODE
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_5.b64)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader(jazz1.wma)
Test_NDTMGR_ASF_Close()


2070:FUNC: License with revocation check, leaf-license revoked SAMPLE MODE
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_8.b64)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0X8004C053(DRM_E_CERTIFICATE_REVOKED)
Test_NDTMGR_ASF_Close()


2071:FUNC: Newer revocation list replaces old one SAMPLE MODE
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_5.b64)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_8.b64)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0X8004C053(DRM_E_CERTIFICATE_REVOKED)
Test_NDTMGR_ASF_Close()


2072:FUNC: License with revocation check, non leaf-license revoked SAMPLE MODE
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_6.b64)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)=0X8004C053(DRM_E_CERTIFICATE_REVOKED)
Test_NDTMGR_ASF_Close()


6204:FUNC: Call NDTMGR_ASF_ReadSample, seek forward or reverse 10 times, and read sample
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_Seek(1000)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_Seek(3000)
Test_NDTMGR_ASF_Seek(4000)
Test_NDTMGR_ASF_Seek(6000)
Test_NDTMGR_ASF_Seek(7000)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_Seek(9000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6205:FUNC: Call NDTMGR_ASF_ReadSample, mixed read and seek 20 times
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_Seek(1000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(3000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(4000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(6000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(7000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(9000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_Seek(1000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(3000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(4000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(6000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(7000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(9000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6210:FUNC: Call NDT_ASF_ReadSample with NULL context
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ASF_ReadSample()=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()=-2147024809(DRM_E_INVALIDARG)


6211:FUNC: Call NDT_ASF_ReadSample with NULL pSampleInfo
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetpSampleInfoNULL
Test_NDTMGR_ASF_ReadSample()=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


6212:FUNC: Call NDT_ASF_ReadSample with NULL pbSampleData
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetpbSampleDataNULL
Test_SetpcbSampleDataNULL
Test_NDTMGR_ASF_ReadSample()=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


6213:FUNC: Call NDT_ASF_ReadSample with NULL pcbSampleData
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetpcbSampleDataNULL
Test_NDTMGR_ASF_ReadSample()=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()


6214:FUNC: Call NDT_ASF_ReadSample with invalid session id
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_SetMediaSessionID(000102030405060708090a0b0c0d0e0f)
Test_NDTMGR_ASF_ReadSample()=0X8004CE04(DRM_E_ND_INVALID_SESSION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)


6215:FUNC: Call NDT_ASF_ReadSample with small output buffer
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader
Test_SetcbSampleData(1)
Test_NDTMGR_ASF_ReadSample()=-2147024774(DRM_E_BUFFERTOOSMALL)
Test_NDTMGR_ASF_Close()


6216:FUNC: Verify failure of NDT_ASF_ReadSample called without calling NDTMGR_ASF_Init first
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_ReadSample()=0X8004CE04(DRM_E_ND_INVALID_SESSION)


6217:FUNC: Call NDT_ASF_ReadSample without calling NDTMGR_ASF_InitTranscryption first (not a failure)
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6218:FUNC: Call NDT_ASF_ReadSample with MUXED mode specified in NDTMGR_ASF_Init
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_ReadSample()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()


6219:FUNC: attempt seek for video
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,headerVideo.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(Cab3lNlCjE+C+sjhTqC5ZA==,{E35DEAEA-CD39-4f9f-8B27-0B2E62906D8C}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",GwaZ58UTSek9yUUsriK8*pproW*bgn6bb9QS!2I52A62iJZiTUngWA==,C9kAEfarjbkdVR26QNN0H8M1D2dV1YKvzJboDis9)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, SAMPLES, 9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps_output.wmv)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(4500)=-2147467263


6220:FUNC: Call NDTMGR_ASF_ReadSample after validation timeout
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)
Test_ChangeTimeMilliseconds(VALIDATION_TIMEOUT)
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)=0x8004CE00(DRM_E_ND_MUST_REVALIDATE)
Test_NDTMGR_ASF_Close()


6221:FUNC: Call NDTMGR_ASF_ReadSample before leaf
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadSample(8192, jazz_clear.wma)=-2147467259(DRM_E_FAIL)


6340:FUNC: Set current time position 1 second protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader(jazz1.wma)
Test_NDTMGR_ASF_Seek(1000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6341:FUNC: Set current time position 1 second unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, SAMPLES, jazz_clear_output.wma)
Test_NDTMGR_ASF_GetHeader(jazz_clear.wma)
Test_NDTMGR_ASF_Seek(1000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6350:FUNC: Set current time position 1 second from end of file protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader(jazz1.wma)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(10000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6351:FUNC: Set current time position 1 second from end of file unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, SAMPLES, jazz_clear_output.wma)
Test_NDTMGR_ASF_GetHeader(jazz_clear.wma)
Test_NDTMGR_ASF_Seek(10000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Close()


6360:FUNC: Jump current time position around a bit protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader(jazz1.wma)
Test_NDTMGR_ASF_ReadSample(8192)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadSample(8192)
Test_CheckLastDataBlock()=-2147467259(DRM_E_FAIL)
Test_NDTMGR_ASF_Close()


1779:FUNC: Check Decryption of a single packet
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadData(12000, jazz_clear.wma)
Test_NDTMGR_ASF_Close()


1780:FUNC: Check Decryption of all packets
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(5986, jazz_clear.wma, 31)
Test_NDTMGR_ASF_Close()


'NOTE: jazz1.wma must be used for the seeking tests
1781:FUNC: Set current time position protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(4500)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


1784:FUNC: Set current time position with NULL context
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ASF_Seek(2000)=-2147024809(DRM_E_INVALIDARG)
Test_NDTMGR_ASF_Close()=-2147024809(DRM_E_INVALIDARG)


1786:FUNC: Set current time position with invalid media session id
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_SetMediaSessionID(000102030405060708090a0b0c0d0e0f)
Test_NDTMGR_ASF_Seek(2000)=0X8004CE04(DRM_E_ND_INVALID_SESSION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)


1788:FUNC: Set current time position before session is open
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Seek(200000)=0X8004CE04(DRM_E_ND_INVALID_SESSION)
Test_NDTMGR_ASF_Close()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

1790:FUNC: Set current time position after session is closed
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()
Test_NDTMGR_ASF_Seek(200000)=0X8004CE04(DRM_E_ND_INVALID_SESSION)

1952:FUNC: Set current time position without calling NDTMGR_ASF_InitTranscryption first
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_Seek(4500)
Test_NDTMGR_ASF_Close()


1792:FUNC: Seek command immediately after open media session unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


1794:FUNC: Seek command immediately after open media session protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


1796:FUNC: Seek command immediately after license acquisition protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


1798:FUNC: Seek command before license acquisition and then acquire license
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


1808:FUNC: Set current time position 1 second protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Seek(1000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


1810:FUNC: Set current time position 1 second unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_Seek(1000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()

1812:FUNC: Set current time position 1 second from end of file protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(10000)
Test_NDTMGR_ASF_ReadData(2048)
Test_NDTMGR_ASF_Close()


1814:FUNC: Set current time position 1 second from end of file unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_Seek(10000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


1824:FUNC: Set current time position past end of file protected content
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(200000)=0x8004CE0A(DRM_E_ND_FAILED_SEEK)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


1826:FUNC: Set current time position past end of file unprotected content
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(200000)=0x8004CE0A(DRM_E_ND_FAILED_SEEK)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()

1828:FUNC: Set current time position to an arbitrarily large value
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(4000000000)=0x8004CE0A(DRM_E_ND_FAILED_SEEK)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


1829:FUNC: Set current time position to exact end of file
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(10415)
Test_NDTMGR_ASF_ReadData(8196)
Test_NDTMGR_ASF_Close()


7110:FUNC: Call NDTMGR_ASF_ReadData, seek forward or reverse 10 times, and read sample
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_Seek(1000)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_Seek(3000)
Test_NDTMGR_ASF_Seek(4000)
Test_NDTMGR_ASF_Seek(6000)
Test_NDTMGR_ASF_Seek(7000)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_Seek(9000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


7111:FUNC: Call NDTMGR_ASF_ReadData, mixed read and seek 20 times
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_Seek(1000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(3000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(4000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(6000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(7000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(9000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(0)
Test_NDTMGR_ASF_Seek(1000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(8000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(5000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(3000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(4000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(6000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(7000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(2000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Seek(9000)
Test_NDTMGR_ASF_ReadData(8192)
Test_NDTMGR_ASF_Close()


2026:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum security level of 150
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 150, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)


2045:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum app revocation list version of 1
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 1, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

2046:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum app revocation list version of 2
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 2, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

2047:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum app revocation list version of 5
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 5, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1955:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum app revocation list version of 8
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 8, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1956:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum app revocation list version of 10
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 10, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1957:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum device revocation list version of 1
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 1)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1958:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum device revocation list version of 2
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 2)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1959:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum device revocation list version of 5
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 5)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1960:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum device revocation list version of 8
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 8)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1961:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with minimum device revocation list version of 10
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 10)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1962:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with long license challenge message
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1963:FUNC: Call NDTMGR_ProcessLicenseChallenge successfully with short license challenge message
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_CloseSession(CONTENT)

1964:FUNC: Call NDTMGR_ProcessLicenseChallenge unsuccessfully because of time out
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 150, 0, 0)
Test_ChangeTimeMilliseconds(VALIDATION_TIMEOUT)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=0x8004CE00(DRM_E_ND_MUST_REVALIDATE)
Test_NDTMGR_CloseSession(CONTENT)

1965:FUNC: Call NDTMGR_ProcessLicenseChallenge with non matching certificate
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 150, 0, 0)
Test_SetCertificate(invalid_cert.crt)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=0x8004a000(DRM_E_DEVICE_NOT_REGISTERED)
Test_NDTMGR_CloseSession(CONTENT)

1966:FUNC: Call NDTMGR_GetLeafLicenseResponse unsuccessfully because of time out
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, SAMPLES, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_ChangeTimeMilliseconds(VALIDATION_TIMEOUT)
Test_NDTMGR_ASF_GetLeafLicenseResponse()=0x8004CE00(DRM_E_ND_MUST_REVALIDATE)
Test_NDTMGR_ASF_Close()


2027:FUNC: Verify failure of NDTMGR_ProcessLicenseChallenge called with NULL context
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetpNdtDrmContext(0)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=-2147024809(DRM_E_INVALIDARG)

2028:FUNC: Verify failure of NDTMGR_ProcessLicenseChallenge called with NULL pPolicy
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=-2147024809(DRM_E_INVALIDARG)

2059:FUNC: Verify failure of NDTMGR_ProcessLicenseChallenge called with NULL pKID
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetpKIDNULL()
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=-2147024809(DRM_E_INVALIDARG)

2060:FUNC: Verify failure of NDTMGR_ProcessLicenseChallenge called with NULL pbLicenseResponseMsg
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetpbLicenseResponseMsgNULL()
Test_SetcbLicenseResponseMsgNULL()
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=-2147024809(DRM_E_INVALIDARG)

2061:FUNC: Verify failure of NDTMGR_ProcessLicenseChallenge called with NULL pcbLicenseResponseMsg
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetcbLicenseResponseMsgNULL()
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=-2147024809(DRM_E_INVALIDARG)

2062:FUNC: Verify failure of NDTMGR_ProcessLicenseChallenge called with invalid license challenge message
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetcbLicenseChallengeMsg(1)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=0x8004CE09(DRM_E_ND_BAD_REQUEST)

2063:FUNC: Verify failure of NDTMGR_ProcessLicenseChallenge called with invalid license mode
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, INVALID_MODE)=-2147024809(DRM_E_INVALIDARG)

81070:FUNC: Verify failure of NDTMGR_ProcessLicenseChallenge called with invalid policy
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_SetWMDRMNETPolicy(INVALID_TYPE, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=-2147024809(DRM_E_INVALIDARG)

2064:FUNC: Verify failure of NDTMGR_ProcessLicenseChallenge called with small buffer
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetcbLicenseResponseMsg(1)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)=-2147024774(DRM_E_BUFFERTOOSMALL)

2030:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum security level of 150
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 150, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

2031:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum app revocation list version of 1
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 1, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

2032:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum app revocation list version of 2
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 2, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

8207:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum app revocation list version of 5
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 5, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

8208:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum app revocation list version of 8
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 8, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

8209:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum app revocation list version of 10
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 10, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

8210:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum device revocation list version of 1
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 1)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

8211:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum device revocation list version of 2
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 2)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

8212:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum device revocation list version of 5
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 5)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

8213:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum device revocation list version of 8
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 8)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

8214:FUNC: Call NDTMGR_GetLeafLicenseResponse successfully with minimum device revocation list version of 10
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 10)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

8215:FUNC: Call NDTMGR_GetLeafLicenseResponse unsuccessfully with minimum security level of 1
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 1, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_NDTMGR_GetLeafLicenseResponse()
Test_NDTMGR_CloseSession(CONTENT)

2033:FUNC: Verify failure of NDTMGR_GetLeafLicenseResponse called with NULL context
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_GetLeafLicenseResponse()=-2147024809(DRM_E_INVALIDARG)

2034:FUNC: Verify failure of NDTMGR_GetLeafLicenseResponse called with NULL pPolicy
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_SetWMDRMNETPolicy
Test_NDTMGR_GetLeafLicenseResponse()=-2147024809(DRM_E_INVALIDARG)

2036:FUNC: Verify failure of NDTMGR_GetLeafLicenseResponse called with NULL pbLeafLicenseResponse
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_SetpbLeafLicenseResponseNULL()
Test_NDTMGR_GetLeafLicenseResponse()=-2147024809(DRM_E_INVALIDARG)

2037:FUNC: Verify failure of NDTMGR_GetLeafLicenseResponse called with NULL pcbLeafLicenseResponse
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_SetpcbLeafLicenseResponseNULL()
Test_NDTMGR_GetLeafLicenseResponse()=-2147024809(DRM_E_INVALIDARG)

2038:FUNC: Verify failure of NDTMGR_GetLeafLicenseResponse called with invalid session id
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_SetMediaSessionID(000102030405060708090a0b0c0d0e0f)
Test_NDTMGR_GetLeafLicenseResponse()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

2039:FUNC: Verify failure of NDTMGR_GetLeafLicenseResponse called with invalid policy
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_SetWMDRMNETPolicy(INVALID_TYPE, 100, 0, 0)
Test_NDTMGR_GetLeafLicenseResponse()=-2147024809(DRM_E_INVALIDARG)

8307:FUNC: Verify failure of NDTMGR_GetLeafLicenseResponse called with small buffer
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)
Test_SetcbLeafLicenseResponse(1)
Test_NDTMGR_GetLeafLicenseResponse()=-2147024774(DRM_E_BUFFERTOOSMALL)

8308:FUNC: Verify failure of NDTMGR_GetLeafLicenseResponse called without registering device first
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, CHAINED)=0x8004a000(DRM_E_DEVICE_NOT_REGISTERED)
Test_NDTMGR_GetLeafLicenseResponse()=0x8004a000(DRM_E_DEVICE_NOT_REGISTERED)

8309:FUNC: Verify failure of NDTMGR_GetLeafLicenseResponse called without initiate session
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_GetLeafLicenseResponse()=0X8004CE04(DRM_E_ND_INVALID_SESSION)

8310:FUNC: Verify failure of NDTMGR_GetLeafLicenseResponse called when in SIMPLE license mode
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_GetLeafLicenseResponse()=-2147467259(DRM_E_FAIL)

8400:FUNC: link encryption mp3
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_LinkEncryption(jazz_clear.mp3, jazz_encrypted.3le, 1024);
Test_NDTMGR_CloseSession(CONTENT)

8402:FUNC: test asf encrypt with null pointer input
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_SetpNdtDrmContext(0)
Test_NDTMGR_Encrypt_ASF( files\DeviceTestCert1.crt, 0263516363427762, 0 )=-2147024809(DRM_E_INVALIDARG)

8403:FUNC: test asf encrypt with invalid session id
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_SetMediaSessionID(000102030405060708090a0b0c0d0e0f)
Test_NDTMGR_Encrypt_ASF( files\DeviceTestCert1.crt, 0263516363427762, 0 )=0X8004CE04(DRM_E_ND_INVALID_SESSION)

8404:FUNC: test asf encrypt with invalid encryption mode
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_SetEncryptionMode(500)
Test_NDTMGR_Encrypt_ASF( files\DeviceTestCert1.crt, 0263516363427762, 0 )=-2147024809(DRM_E_INVALIDARG)

8405:FUNC: test asf encrypt with invalid session id
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(CONTENT)
Test_NDTMGR_Encrypt_ASF( files\DeviceTestCert1.crt, 0263516363427762, 0 )=0X8004CE04(DRM_E_ND_INVALID_SESSION)

8406:FUNC: test asf encryption
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_Encrypt_ASF( files\DeviceTestCert1.crt, 0263516363427762, 0 )
Test_NDTMGR_CloseSession(CONTENT)

8407:FUNC: link encryption mp3 with no block id
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_LinkEncryption(jazz_clear.mp3, jazz_encrypted.3le, 1024, 1);
Test_NDTMGR_CloseSession(CONTENT)

8408:FUNC: link encryption mp3 with no block id and no encryption
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_LinkEncryption(jazz_clear.mp3, jazz_encrypted.3le, 1024, 1, 1);
Test_NDTMGR_CloseSession(CONTENT)

8500:FUNC: test mpeg encryption
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_CreateSession(CONTENT)
Test_SetWMDRMNETPolicy(TRANSCRYPTPLAY, 100, 0, 0)
Test_NDTMGR_ProcessLicenseChallenge(08544947f9b8c4b47ad6aaca3d39e7c2, Play, SIMPLE)
Test_NDTMGR_Encrypt_MPEG( files\DeviceTestCert1.crt, 0263516363427762, 0 )
Test_NDTMGR_CloseSession(CONTENT)


''''''''''''''''''''''''''''''''


1876:FUNC: Verify MUXED Mode WMV, Clear
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, MUXED, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps_output.wmv)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadData(52000, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_Close()


2055:FUNC: Verify MUXED Mode WMV, DRM
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,headerVideo.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(Cab3lNlCjE+C+sjhTqC5ZA==,{E35DEAEA-CD39-4f9f-8B27-0B2E62906D8C}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",GwaZ58UTSek9yUUsriK8*pproW*bgn6bb9QS!2I52A62iJZiTUngWA==,C9kAEfarjbkdVR26QNN0H8M1D2dV1YKvzJboDis9)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, MUXED, 9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps_output.wmv)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadData(12000, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_Close()


2057:FUNC: Verify MUXED Mode WMV, VBR
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PD320x420_32kbps.wmv, MUXED, PD320x420_32kbps_output.wmv)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadData(12000, PD320x420_32kbps.wmv  )
Test_NDTMGR_ASF_Close()


9013:FUNC: Verify MUXED Mode WMV DRM, Read to end
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,headerVideo.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(Cab3lNlCjE+C+sjhTqC5ZA==,{E35DEAEA-CD39-4f9f-8B27-0B2E62906D8C}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",GwaZ58UTSek9yUUsriK8*pproW*bgn6bb9QS!2I52A62iJZiTUngWA==,C9kAEfarjbkdVR26QNN0H8M1D2dV1YKvzJboDis9)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, MUXED, 9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps_output.wmv)
Test_NDTMGR_ASF_InitTranscryption(08544947f9b8c4b47ad6aaca3d39e7c2, Play)
Test_GetHeaders()
Test_NDTMGR_ASF_ReadAllData(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, 4996)
Test_NDTMGR_ASF_Close()


9100:FUNC: Verify SAMPLES Mode WMV, Clear
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, SAMPLES, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps_output.wmv)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(8192, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(8192, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(8192, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(8192, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_Close()


9101:FUNC: Verify SAMPLES Mode WMV, DRM
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,headerVideo.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(Cab3lNlCjE+C+sjhTqC5ZA==,{E35DEAEA-CD39-4f9f-8B27-0B2E62906D8C}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",GwaZ58UTSek9yUUsriK8*pproW*bgn6bb9QS!2I52A62iJZiTUngWA==,C9kAEfarjbkdVR26QNN0H8M1D2dV1YKvzJboDis9)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, SAMPLES, 9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps_output.wmv)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
'Test_NDTMGR_ASF_ReadSample(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv)
Test_NDTMGR_ASF_Close()


1542:FUNC: Verify SAMPLES Mode WMV, VBR
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(PD320x420_32kbps.wmv, SAMPLES, PD320x420_32kbps_output.wmv)
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadSample(8192, PD320x420_32kbps.wmv)
Test_NDTMGR_ASF_ReadSample(8192, PD320x420_32kbps.wmv)
Test_NDTMGR_ASF_ReadSample(8192, PD320x420_32kbps.wmv)
Test_NDTMGR_ASF_ReadSample(8192, PD320x420_32kbps.wmv)
Test_NDTMGR_ASF_ReadSample(8192, PD320x420_32kbps.wmv)
Test_NDTMGR_ASF_Close()


1541:FUNC: Verify SAMPLES Mode WMV DRM, Read to End
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,headerVideo.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(Cab3lNlCjE+C+sjhTqC5ZA==,{E35DEAEA-CD39-4f9f-8B27-0B2E62906D8C}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION>",GwaZ58UTSek9yUUsriK8*pproW*bgn6bb9QS!2I52A62iJZiTUngWA==,C9kAEfarjbkdVR26QNN0H8M1D2dV1YKvzJboDis9)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, SAMPLES, 9TC1_523kbps_450kbpsVideo_64kbpsAudio_30fps_output.wmv)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_GetLeafLicenseResponse()
Test_NDTMGR_ASF_GetHeader
Test_NDTMGR_ASF_ReadAllSamples(131070, DotNetCommercial_523kbps_450kbpsVideo_64kbpsAudio_30fps.wmv, 4996)
Test_NDTMGR_ASF_Close()


9200:FUNC: Revocation list request with wmdrm revocation list
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_NDTMGR_ProcessRevocationListRequest()


1392:FUNC: Revocation list request with all types
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_WmdrmNetPackRevocationListRequestMessage({90a37313-0ecf-4caa-a906-b188f6129300},{3129e375-ceb0-47d5-9cca-9db74cfd4332},{cd75e604-543d-4a9c-9f09-fe6d24e8bf90},{ccde5a55-a688-4405-a88b-d13f90d5ba3e})
Test_NDTMGR_ProcessRevocationListRequest()


1385:FUNC: Revocation list request with no types
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_WmdrmNetPackRevocationListRequestMessage
Test_NDTMGR_ProcessRevocationListRequest


1386:FUNC: GetRevocationListRequest wmdrmnd type
Test_DRM_NDT_Initialize
Test_SwitchNdtContexts(1)
Test_DRM_NDT_Initialize(secondstore.hds)
Test_NDTMGR_GetRevocationListRequest(NET)
Test_SwitchNdtContexts(0)
Test_NDTMGR_ProcessRevocationListRequest()
Test_SwitchNdtContexts(1)
Test_NDTMGR_ProcessRevocationListResponse()


1388:FUNC: GetRevocationListRequest all types
Test_DRM_NDT_Initialize
Test_SwitchNdtContexts(1)
Test_DRM_NDT_Initialize(secondstore.hds)
Test_NDTMGR_GetRevocationListRequest(ALL)
Test_SwitchNdtContexts(0)
Test_NDTMGR_ProcessRevocationListRequest()
Test_SwitchNdtContexts(1)
Test_NDTMGR_ProcessRevocationListResponse()


1430:FUNC: ProcessRevocationListRequest with small buffer
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({90a37313-0ecf-4caa-a906-b188f6129300})
Test_SetNoHandleBufferTooSmall(1)
Test_NDTMGR_ProcessRevocationListRequest()=-2147024774(DRM_E_BUFFERTOOSMALL)
Test_CheckcbRevocationListResponse(22)


1390:FUNC: Revocation request for existing device CRL
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_5.b64)
Test_InitializeRevocationListResponse(1)
Test_AddRevocationListToResponse(2, files\crl_wmdrmnd_5.b64_wchar)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_DumpRevocationListResponse()
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_NDTMGR_ProcessRevocationListRequest()
Test_VerifyRevocationListResponse()


1471:FUNC: Request for a non-available CRL and match the response with the behavior
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(0)
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_NDTMGR_ProcessRevocationListRequest()
Test_VerifyRevocationListResponse()


1393:FUNC: improper crl request message
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_SetMessageProtocolVersion(1)
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_NDTMGR_ProcessRevocationListRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1432:FUNC: Update of revocation lists with non-revoked device and registration
Test_DRM_NDT_Initialize
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_5.b64)
Test_SwitchNdtContexts(1)
Test_DRM_NDT_Initialize(secondstore.hds)
Test_NDTMGR_GetRevocationListRequest(NET)
Test_SwitchNdtContexts(0)
Test_NDTMGR_ProcessRevocationListRequest()
Test_SwitchNdtContexts(1)
Test_NDTMGR_ProcessRevocationListResponse()
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()


1434:FUNC: RIV info of transmitter lesser than receiving transmitter
Test_DRM_NDT_Initialize
Test_SetRevocationList(WMDRMNET, files\crl_wmdrmnd_5.b64)
Test_SetRevocationList(RIV, files\rlvi_1_wmdrmnd_5.b64.signed_wchar)
Test_CheckRivSequenceNumber(1)
Test_SwitchNdtContexts(1)
Test_DRM_NDT_Initialize(secondstore.hds)
Test_SetRevocationList(WMDRMNET, files\crl_wmdrmnd_8.b64)
Test_SetRevocationList(RIV, files\rlvi_7_wmdrmnd_8.b64.signed_wchar)
Test_CheckRivSequenceNumber(7)
Test_NDTMGR_GetRevocationListRequest(RIV)
Test_SwitchNdtContexts(0)
Test_NDTMGR_ProcessRevocationListRequest()
Test_SwitchNdtContexts(1)
Test_NDTMGR_ProcessRevocationListResponse()
Test_CheckRivSequenceNumber(7)


9213:FUNC: Revocation list request with NULL context
Test_DRM_NDT_Initialize
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ProcessRevocationListRequest()=-2147024809(DRM_E_INVALIDARG)


1435:FUNC: Revocation list request with request blob
Test_DRM_NDT_Initialize
Test_NDTMGR_ProcessRevocationListRequest()=-2147024809(DRM_E_INVALIDARG)


1436:FUNC: Revocation list request with null response size address
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetpcbRevocationListResponse(0)
Test_NDTMGR_ProcessRevocationListRequest()=-2147024809(DRM_E_INVALIDARG)


1437:FUNC: Revocation list request with null response blob and non-zero response size
Test_DRM_NDT_Initialize
Test_SetcbRevocationListResponse(1024)
Test_NDTMGR_ProcessRevocationListRequest()=-2147024809(DRM_E_INVALIDARG)


1438:FUNC: Revocation list request unable to unpack message version
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetcbRevocationListRequest(0)
Test_NDTMGR_ProcessRevocationListRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1439:FUNC: Revocation list request unable to unpack message type
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetcbRevocationListRequest(1)
Test_NDTMGR_ProcessRevocationListRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1450:FUNC: Revocation list request message too small
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetcbRevocationListRequest(2)
Test_NDTMGR_ProcessRevocationListRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1452:FUNC: revocation list request invalid message version
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetMessageProtocolVersion(1)
Test_NDTMGR_ProcessRevocationListRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1458:FUNC: revocation list request invalid message type
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetMessageType(99)
Test_NDTMGR_ProcessRevocationListRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1396:FUNC: revocation list request unable to unpack guids
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetcbRevocationListRequest(11)
Test_NDTMGR_ProcessRevocationListRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1398:FUNC: revocation list request, response buffer too small
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetNoHandleBufferTooSmall(1)
Test_NDTMGR_ProcessRevocationListRequest()=-2147024774(DRM_E_BUFFERTOOSMALL)


1454:FUNC: Request with bad guid
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({abcdef01-543d-4a9c-9f09-fe6d24e8bf90})
Test_NDTMGR_ProcessRevocationListRequest()=-2147024809(DRM_E_INVALIDARG)


9226:FUNC: Get revocation list request with null context
Test_DRM_NDT_Initialize
Test_SetpNdtDrmContext(0)
Test_NDTMGR_GetRevocationListRequest(RIV)=-2147024809(DRM_E_INVALIDARG)


1403:FUNC: Get revocation list request buffer too small
Test_DRM_NDT_Initialize
Test_SetNoHandleBufferTooSmall(1)
Test_NDTMGR_GetRevocationListRequest(RIV)=-2147024774(DRM_E_BUFFERTOOSMALL)


1429:FUNC: get revocation list request null message size address
Test_DRM_NDT_Initialize
Test_SetpcbRevocationListRequest(0)
Test_NDTMGR_GetRevocationListRequest(RIV)=-2147024809(DRM_E_INVALIDARG)


1416:FUNC: get revocation list request null message blob and non-zero message size
Test_DRM_NDT_Initialize
Test_SetcbRevocationListRequest(1024)
Test_NDTMGR_GetRevocationListRequest(RIV)=-2147024809(DRM_E_INVALIDARG)


1455:FUNC: get revocation list request invalid enumerant
Test_DRM_NDT_Initialize
Test_NDTMGR_GetRevocationListRequest(500)=-2147024809(DRM_E_INVALIDARG)


1456:FUNC: process revocation list response with null context
Test_DRM_NDT_Initialize
Test_SetpNdtDrmContext(0)
Test_NDTMGR_ProcessRevocationListResponse()=-2147024809(DRM_E_INVALIDARG)


1457:FUNC: process revocation list response unable to unpack version
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(0)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_SetcbRevocationListResponse(0)
Test_NDTMGR_ProcessRevocationListResponse()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1431:FUNC: process revocation list response unable to unpack message type
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(0)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_SetcbRevocationListResponse(1)
Test_NDTMGR_ProcessRevocationListResponse()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1433:FUNC: process revocation list response invalid protocol version
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(0)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_SetMessageProtocolVersion(1)
Test_NDTMGR_ProcessRevocationListResponse()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1387:FUNC: process revocation list response invalid message type
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(0)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_SetMessageType(99)
Test_NDTMGR_ProcessRevocationListResponse()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1459:FUNC: process revocation list response unable to unpack guid
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(1)
Test_AddRevocationListToResponse(2, files\crl_wmdrmnd_5.b64_wchar)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_SetcbRevocationListResponse(10)
Test_NDTMGR_ProcessRevocationListResponse()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1460:FUNC: process revocation list response unable to unpack crl size
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(1)
Test_AddRevocationListToResponse(2, files\crl_wmdrmnd_5.b64_wchar)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_SetcbRevocationListResponse(20)
Test_NDTMGR_ProcessRevocationListResponse()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1389:FUNC: process revocation list response unable to unpack crl
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(1)
Test_AddRevocationListToResponse(2, files\crl_wmdrmnd_5.b64_wchar)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_SetcbRevocationListResponse(22)
Test_NDTMGR_ProcessRevocationListResponse()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1461:FUNC: Requesting the same revocation list guid multiple times
Test_DRM_NDT_Initialize
Test_SetRevocationList(WMDRMNET,files\crl_wmdrmnd_5.b64)
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90}, {cd75e604-543d-4a9c-9f09-fe6d24e8bf90}, {cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_NDTMGR_ProcessRevocationListRequest()
Test_DumpRevocationListResponse()


1464:FUNC: zero-length revocation lists
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(1)
Test_AddRevocationListToResponse(2,NULL)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_DumpRevocationListResponse()
Test_NDTMGR_ProcessRevocationListResponse()


1465:FUNC: response with bad guid
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(1)
Test_AddRevocationListToResponse({00000000-0000-0000-0000-000000000000}, files\rlvi_7_wmdrmnd_8.b64.signed_wchar)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_DumpRevocationListResponse()
Test_NDTMGR_ProcessRevocationListResponse()


1466:FUNC: truncated response
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(1)
Test_AddRevocationListToResponse(2, files\crl_wmdrmnd_5.b64_wchar)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_DumpRevocationListResponse()
Test_SetcbRevocationListResponse(256)
Test_NDTMGR_ProcessRevocationListResponse()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1467:FUNC: truncated request before guid
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetcbRevocationListRequest(3)
Test_NDTMGR_ProcessRevocationListRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1391:FUNC: truncated request in middle of guid
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetcbRevocationListRequest(10)
Test_NDTMGR_ProcessRevocationListRequest()=0x8004CE09(DRM_E_ND_BAD_REQUEST)


1451:FUNC: extra bytes in request at end
Test_DRM_NDT_Initialize
Test_WmdrmNetPackRevocationListRequestMessage({cd75e604-543d-4a9c-9f09-fe6d24e8bf90})
Test_SetcbRevocationListRequest(19)
Test_NDTMGR_ProcessRevocationListRequest()


1453:FUNC: Revocation list request with duplicate RIV
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(DeviceTestCert.crt)
Test_WmdrmNetPackRevocationListRequestMessage({90a37313-0ecf-4caa-a906-b188f6129300},{3129e375-ceb0-47d5-9cca-9db74cfd4332},{cd75e604-543d-4a9c-9f09-fe6d24e8bf90},{ccde5a55-a688-4405-a88b-d13f90d5ba3e},{ccde5a55-a688-4405-a88b-d13f90d5ba3e})
Test_NDTMGR_ProcessRevocationListRequest()


1395:FUNC: process revocation list response with no revocation lists
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(0)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_NDTMGR_ProcessRevocationListResponse()


1397:FUNC: process revocation list response with no revocation lists
Test_DRM_NDT_Initialize
Test_InitializeRevocationListResponse(1)
Test_AddRevocationListToResponse({ccde5a55-a688-4405-a88b-d13f90d5ba3e}, invalid_cert.crt)
Test_WmdrmNetPackRevocationListResponseMessage()
Test_NDTMGR_ProcessRevocationListResponse()=-2147024809(DRM_E_INVALIDARG)


9260:FUNC: RIV in license
SkipTestIf(!WMDRMSupported)
TestManagerSetRights(Play)
TestManagerSetHeader(NORMAL,header1.xml)
TestManagerInitResponse
TestManagerAddLicenseToResponse(vqvqngd40kuu9FnnqNrt7Q==,{E28E8B13-3E37-4DC6-8563-CC72CBCDDE91}, 64 OP_LICGEN_NO_DEFAULT_RIGHTS, "<REVINFOVERSION>1</REVINFOVERSION><ONACTION type=\"Play\"><CONDITION><![CDATA[1]]></CONDITION></ONACTION><ONSELECT><CONDITION><![CDATA[ (!exists(secstate.deleted) && (app.minseclevel >= 150?1:(secstate.drmreason=3;0)))]]></CONDITION></ONSELECT>", 7BZ*gTLq*LKyT3GcIWH8d5JkWiklMf7Aod!lhBgJpcTRu!chtojzMg==,zWVMVj8hZun5DyUU38zET5B1E4sl6QsmPIrqzkDP)
TestManagerGenerateResponse
TestManagerProcessResponse(Dump,Dump,0,0)
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert1.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey1.bin)
Test_SetRevocationList(WMDRMNET, files\crl_wmdrmnd_5.b64)
Test_SetRevocationList(RIV, files\rlvi_1_wmdrmnd_5.b64.signed_wchar)
Test_CheckRivSequenceNumber(1)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz1.wma, MUXED, jazz1_output.wma)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_CheckRivInLicense(1)


1489:FUNC: Proximity challenge which is just under cut off time
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert2.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey2.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)


1496:FUNC: ten proximity challenge failures due to >7ms delay between challenge and response
Test_DRM_NDT_Initialize
Test_SetSerialNumber(ABCDEF0123456789ABCDEF0123456789)
Test_SetCertificate(files\DeviceTestCert2.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey2.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)
Test_NDTMGR_ProcessProximityStartMsg()
Test_ChangeTimeMilliseconds(15)
Test_NDTMGR_ProcessProximityResponseMsg()=0x8004CE06(DRM_E_ND_UNABLE_TO_VERIFY_PROXIMITY)


1290:FUNC: unprotected content, encrypt it
Test_DRM_NDT_Initialize
Test_SetSerialNumber(edd00d00faced00d00faced00d00face)
Test_SetCertificate(files\DeviceTestCert2.crt)
Test_SetPrivateKeyDirectly(files\DeviceRSAPrivKey2.bin)
Test_NDTMGR_CreateSession(REGISTRATION)
Test_NDTMGR_ProcessRegistrationRequest()
Test_Proximity(0)
Test_NDTMGR_CloseSession(REGISTRATION)
Test_NDTMGR_ASF_Init(jazz_clear.wma, MUXED, jazz_clear_output.wma, TRUE)
Test_NDTMGR_ASF_InitTranscryption(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, Play)
Test_NDTMGR_ASF_ReadAllData(4096)
Test_NDTMGR_ASF_Close()

'Valid MAS prikey: lVvvpn!q4bMJi!BosMpAPZ9IERg=

1292:BVT:DRM_Manager_GenerateMeterChallenge and DRM_Manager_ProcessMeterResponse: with valid parameters should work
SkipTestIf(!WMDRMSupported)
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")


1287:BVT:MGR_MTR_GenerateMeteringChallenge returns no data.
SkipTestIf(!WMDRMSupported)
TestDRM_Manager_Initialize()
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=")


1288:BVT:MGR_MTR_GenerateMeteringChallenge returns proper MIDs metering data.
SkipTestIf(!WMDRMSupported)
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_AddMeteringData("EXchRPpxP2YvGZR1d1OKKA==", "37HRLgAfR0G4fVSEAeR2lw==", "Copy", "3")
TestDRM_Manager_GenerateMeterChallenge(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "EXchRPpxP2YvGZR1d1OKKA==", "37HRLgAfR0G4fVSEAeR2lw==", "Copy", "3")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")


1289:BVT:MGR_MTR_GenerateMeteringChallenge returns multiple actions
SkipTestIf(!WMDRMSupported)
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Copy", "3")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2", "27HRLgAfR0G4fVSEAeR2lw==", "Copy", "3")
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")


1286:BVT:MGR_MTR_ProcessMeteringResponse clears data
SkipTestIf(!WMDRMSupported)
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=")


11577:BVT:MGR_MTR_GenerateMeteringChallenge returns multiple KIDs
SkipTestIf(!WMDRMSupported)
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "37HRLgAfR0G4fVSEAeR2lw==", "Copy", "3")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2", "37HRLgAfR0G4fVSEAeR2lw==", "Copy", "3")
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")


1284:BVT:MGR_MTR_ProcessMeteringResponse clears proper KIDs data
SkipTestIf(!WMDRMSupported)
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "37HRLgAfR0G4fVSEAeR2lw==", "Copy", "3")
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "37HRLgAfR0G4fVSEAeR2lw==", "Copy", "3")


1285:BVT:MGR_MTR_ProcessMeteringResponse clears proper action data
SkipTestIf(!WMDRMSupported)
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Copy", "3")
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=")


12604:BVT:Partial metering 200KIDs with 16K buffer
SkipTestIf(!WMDRMSupported)
Test_SetRandomSeed( RANDOM )
TestDRM_Manager_Initialize()
TestDRM_Manager_AddManyMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", 200)
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", NULL, 16384)


12605:BVT:Partial metering intermixed 4 metercert each with 200 KIDs with 16K buffer
SkipTestIf(!WMDRMSupported)
Test_SetRandomSeed( RANDOM )
TestDRM_Manager_Initialize()
TestDRM_Manager_AddManyMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", 50)
TestDRM_Manager_AddManyMeteringData("EXchRPpxP2YvGZR1d1OKKA==", 50)
TestDRM_Manager_AddManyMeteringData("3IKx8Wsy5aYRQN8LLIIcTQ==", 50)
TestDRM_Manager_AddManyMeteringData("4IKx8Wsy5aYRQN8LLIIcTQ==", 50)

TestDRM_Manager_AddManyMeteringData("EXchRPpxP2YvGZR1d1OKKA==", 50)
TestDRM_Manager_AddManyMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", 50)
TestDRM_Manager_AddManyMeteringData("4IKx8Wsy5aYRQN8LLIIcTQ==", 50)
TestDRM_Manager_AddManyMeteringData("3IKx8Wsy5aYRQN8LLIIcTQ==", 50)

TestDRM_Manager_AddManyMeteringData("3IKx8Wsy5aYRQN8LLIIcTQ==", 50)
TestDRM_Manager_AddManyMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", 50)
TestDRM_Manager_AddManyMeteringData("EXchRPpxP2YvGZR1d1OKKA==", 50)
TestDRM_Manager_AddManyMeteringData("4IKx8Wsy5aYRQN8LLIIcTQ==", 50)

TestDRM_Manager_AddManyMeteringData("4IKx8Wsy5aYRQN8LLIIcTQ==", 50)
TestDRM_Manager_AddManyMeteringData("EXchRPpxP2YvGZR1d1OKKA==", 50)
TestDRM_Manager_AddManyMeteringData("3IKx8Wsy5aYRQN8LLIIcTQ==", 50)
TestDRM_Manager_AddManyMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", 50)

TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")

TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")

TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")

TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")

TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")

TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", 16384)
TestDRM_Manager_ProcessMeterResponse(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml")

TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=",  NULL, 16384)
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert2.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", NULL, 16384)
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert3.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", NULL, 16384)
TestDRM_Manager_GeneratePartialMeterChallenge(files\metercert4.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", NULL, 16384)


11855:BVT:DRM_Manager_ProcessMeterResponse - Response signed with wrong key
SkipTestIf(!WMDRMSupported)
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "dsml2vSSmIIkNScihY5niY95fSQ=", "files\response.xml") = 0X8004A013( DRM_E_INVALID_METERRESPONSE_SIGNATURE )


12609:BVT:Verify TID accuracy if meter challenge is interrupted before processing
SkipTestIf(!WMDRMSupported)
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response1.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_VerifyTID("files\response.xml", "files\response1.xml", TRUE)
TestDRM_Manager_ProcessMeterResponse(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response1.xml")
TestDRM_Manager_AddMeteringData("pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_GenerateMeterChallenge(files\metercert.xml, "lVvvpn!q4bMJi!BosMpAPZ9IERg=", "files\response2.xml", "pIKx8Wsy5aYRQN8LLIIcTQ==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_VerifyTID("files\response.xml", "files\response2.xml", FALSE)


30003:BVT:DRT:P0:TestDRM_MTR_GenerateMeterCertChallenge
TestDRM_Manager_Initialize()
TestDRM_MTR_GenerateMeterCertChallenge("pIKx8Wsy5aYRQN8LLIIcTQ==", "Hello World")

30005:BVT:TestDRM_MTR_GenerateMeterCertChallenge with null custom data
TestDRM_Manager_Initialize()
TestDRM_MTR_GenerateMeterCertChallenge("pIKx8Wsy5aYRQN8LLIIcTQ==", NULL)

30006:BVT:TestDRM_MRT_GenerateMeterCertChallenge with null MID
TestDRM_Manager_Initialize()
TestDRM_MTR_GenerateMeterCertChallenge(NULL, "Hello World") = 0x80070057 (DRM_E_INVALIDARG)

40100:BVT:TestDRM_Manager_GenerateMeterChallengeV3 NULL APP context
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("wi3CyaMTD0W24xGQrxEiFg==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_AddMeteringData("wi3CyaMTD0W24xGQrxEiFg==", "27HRLgAfR0G4FVSEAeR2lw==", "Play1", "4")
TestDRM_Manager_GenerateMeterChallengeV3(NULL, files\binmetercert1.dat, "Hello World", NORMAL, NORMAL, NORMAL) = 0x80070057

40101:BVT:TestDRM_Manager_GenerateMeterChallengeV3 NULL Meter Cert
TestDRM_Manager_Initialize()
TestDRM_Manager_AddMeteringData("wi3CyaMTD0W24xGQrxEiFg==", "27HRLgAfR0G4fVSEAeR2lw==", "Play", "2")
TestDRM_Manager_AddMeteringData("wi3CyaMTD0W24xGQrxEiFg==", "27HRLgAfR0G4FVSEAeR2lw==", "Play1", "4")
TestDRM_Manager_GenerateMeterChallengeV3(NORMAL, NULL, "Hello World", NORMAL, NORMAL, NORMAL) = 0x80070057


